{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-article-template-tsx","path":"/Implant-Roulette-Part-1:-Nimplant","result":{"data":{"allSite":{"edges":[{"node":{"siteMetadata":{"name":"SecBytes"}}}]}},"pageContext":{"article":{"id":"c2062405-0fab-5377-bab2-3b1ad4ddf015","slug":"/Implant-Roulette-Part-1:-Nimplant","secret":true,"title":"Implant Roulette Part 1: Nimplant","author":"NotoriousRebel","date":"November 19th, 2020","dateForSEO":"2020-11-19T00:00:00.000Z","timeToRead":7,"excerpt":"The first in a new series looking at what Nim brings to the table for red team tool development.","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Implant Roulette Part 1: Nimplant\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2020-11-19T00:00:00.000Z\",\n  \"hero\": \"./images/test.jpg\",\n  \"excerpt\": \"The first in a new series looking at what Nim brings to the table for red team tool development.\",\n  \"secret\": true\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"When creating an implant what language first comes to mind? Of course the answer is it depends;\\nhowever, typically it is one of the following languages: C, C++, C#, Rust, Go, maybe even Python.\\nWhile those languages are all dandy, they are not the only programming languages that exist.\\nThroughout this series I will be exploring different languages and seeing what\\nthey bring to the table for implant & offensive tool development.\\nThe first language that will be examined is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nim\"), \".\"), mdx(\"h3\", {\n    \"id\": \"what-is-nim\"\n  }, \"What is Nim\"), mdx(\"p\", null, \"If we visit \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/nim-lang/Nim\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nim\\u2019s Github page\"), \" there is a concise definition of what Nim is,\\n\\u201CNim is a statically typed compiled systems programming language. It combines successful concepts from mature languages like Python, Ada and Modula.\\u201D\\nSome of the \\u201Cbig\\u201D benefits of Nim are:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"* Cross-Platform: Generated executables support Windows, Linux, BSD, and macOS.\\n* Nim can compile to C, C++, Objective-C, and JavaScript.\\n* Nim binaries are small and the compiler toolchain allows for a lot of optimizations\\n* Nim can interface with other languages through Nim's foreign function interface (FFI) [1]\\n* Nim syntax is very quick to pick up and is reminiscent of Python.\\n\")), mdx(\"p\", null, \"[1]\", \": \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/backends.html#interfacing-nim-code-calling-the-backend\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://nim-lang.org/docs/backends.html#interfacing-nim-code-calling-the-backend\")), mdx(\"p\", null, \"Of course, these aren\\u2019t the only benefits of the language, more will reveal themself as time goes on.\"), mdx(\"h3\", {\n    \"id\": \"a-simple-injector\"\n  }, \"A Simple Injector\"), mdx(\"p\", null, \"Let\\u2019s get hands-on with Nim and see how to develop a simple injector.\\nBelow is an implementation of a typical CreateRemoteThread injector:\\nInstead of having to manually interop with the Windows API via the FFI there\\nare \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/nim-lang/nimble\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nimble\"), \" packages that contain some Windows API\\ndefinitions. The one I tend to use is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/khchen/winim\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Winim\"), \".\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"crt_injector.png\",\n    \"alt\": \"crt_injector\"\n  }))), mdx(\"p\", null, \"Let\\u2019s compile and run the program \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nim c --run crtinjection.nim\"), \"\\nand make sure everything works. By default when you compile Nim code it generates C code.\\nIn the latter section \\u201CIntegrating into Existing Tooling\\u201D verification shall ensue.\"), mdx(\"h3\", {\n    \"id\": \"peaking-under-the-hood\"\n  }, \"Peaking under the Hood\"), mdx(\"p\", null, \"What is going on under the hood is quite interesting. If we inspect the executable\\u2019s IAT we see\\nthere are no static imports for OpenProcess, VirualAllocEx, WriteProcessMemory, and CreateRemoteThread.\\nThat is because Nim is dynamically loading the required libraries with LoadLibraryA and GetProcAddress.\\nFurthermore, when compiled Nim will place the source code of the language you are targeting in a folder\\ncalled nimcache. You can also specify the nimcache path for generated files with the compiler flag\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--nimcache:PATH\"), \".\"), mdx(\"p\", null, \"Below is a snippet of generated code for inject.nim\\nTo make this easier to read I have compiled the program with an additional flag \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--embedsrc:on\"), \" this flag tells the Nim compiler\\nto embed the source code as comments in the generated output. For compilation: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nim c --run --hints:on --d:release --embedsrc:on inject.nim\")), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1081px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"76.87326549491212%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABJ0AAASdAHeZh94AAACBElEQVQ4y5VT6Y6bMBjMeyRggy98cqNWff/nmg5ONkpX2W37Y2Rjwfibg4uwA1JKOI4dx76g5IwYAiLP3ODQNA3atv1nXIRx6KxB3GZo7yCNrs9d1/8X0QvhAOUs7Dyh9wNaZyDdSShxvV5xu97qeqK5NU/cKm4V9ay549KS0JFw2RYkkua5wAYPR9lDGBBSQMoRMQf0pofUHVfC9lAPSC0helFxOT3URiFvCbZ4hNUj7vTwiHymv3vE+KsgTZHvcXLCcoDTX8+LT3SqQyvotWgfhLzVjfx4SfDFIcx8ceQH6dyTfA1QnO6U3zxkvuJDbpUsrIfhy4kkhVOWLWNYmTT3PnHipaCshdPpb8No2nsbqoeGqc77iOXYEOmjnjJUorcxwrE+Q6Qdxj7N/yB4V6mLcJzQahJlZEoOExOPPasjWSGBzknuudoOKvTVp1eiz6R3ySRMS8DEAJYfnPTnhHmbMNBDFQyMN1DDCV0JvyJ7ELKHDMWMGm5hejNTXAx01lBRQRdWIxOcWqWe5/dVdOI9Ycs/RWvWZh0xMYyBU9jBMlVC8xLutVU8M1VJnVD8ZULNlDOrcdYl7fTyKIhLZsEthBR/pvmsyFe/HkPRbL4plDhzqvUByrejq0F0XkAymM+dewcShio5MeXCEjuv+cvZKlG7nnvHUHiBo3xrIaX8to+/Ad0QqMNpxI88AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f871bb711a469344dbd19d321401823a/9de0b/snippet_inject.webp 1081w\"],\n    \"sizes\": \"(max-width: 1081px) 100vw, 1081px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f871bb711a469344dbd19d321401823a/9a8de/snippet_inject.png 1081w\"],\n    \"sizes\": \"(max-width: 1081px) 100vw, 1081px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/f871bb711a469344dbd19d321401823a/9a8de/snippet_inject.png\",\n    \"alt\": \"Inject_Snippet\",\n    \"title\": \"Inject_Snippet\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Here we can inspect what our function calls are doing under the hood, the\\nWindows API calls done by winim rely on the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/dynlib.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"dynlib module\"), \" to dynamically\\ninvoke calls. If we inspect that source code we can see\\nthe LoadLibraryA and GetProcAddress combination.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"863px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"38.006952491309384%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABKUlEQVQoz32SWXKDMBBEuYcRaEdCImKJHTv3v1dnRgaX7VTy8T6okXq6WzQxBHxsZ8yfF5Q5w3oPZTxiDETEOI6YpgmlFAxjhEoBMg4YhqHOEpFzRqYzzjk0Skq4dUO6fiEuC4xRkLInZEUIgdPpVGnbFmKn3Tlmx7xRSiHkGWVbUS5nlGVGoo3sgB1qre9CJPwXXdc9aLyzSDEjjhMGiilpQS8VCSnwMo7BWGuhSFwqXZfwtzHmkUKIXXDwDvl6Q7l+Uw8Zmi8qg0AOnffV5YFz3O9d3NMsUP8s/uyyRrZjRlhn5PNGlww6ctfRZrX3eHTVvvV3VMFCR/yGN8RUqLuFXnutLm1OUOSCo7KTvu9fenrn1SE5sNpC06/SS34A8esln138J8z8AFNT4Pt+ovvZAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/8c2d1836e5e394c3d66dd878af26a70f/754d3/dynlib_code.webp 863w\"],\n    \"sizes\": \"(max-width: 863px) 100vw, 863px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/8c2d1836e5e394c3d66dd878af26a70f/e3d9b/dynlib_code.png 863w\"],\n    \"sizes\": \"(max-width: 863px) 100vw, 863px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/8c2d1836e5e394c3d66dd878af26a70f/e3d9b/dynlib_code.png\",\n    \"alt\": \"dynlib_code\",\n    \"title\": \"dynlib_code\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"nim-and-donut\"\n  }, \"Nim and Donut\"), mdx(\"p\", null, \"Coming from C# one of my favorite tools for crafting payloads is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/theWover/Donut\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Donut\"), \".\\nOne of the great features with Donut is that it not work works with .NET assemblies but also with native DLLs\\nand executables. Since Nim can generate both C and C++ code and link it to a native executable or DLL\\nDonut is an amazing utility that can transform our output to shellcode.\\nSince shellcode is language-agnostic we can easily integrate it into other tooling.\"), mdx(\"h3\", {\n    \"id\": \"integrating-into-existing-tooling\"\n  }, \"Integrating into Existing Tooling\"), mdx(\"p\", null, \"With shellcode you can easily integrate it into your own custom injectors in the language of your choice.\\nOf course since these are native executables and DLL\\u2019s we can also perform manually mapping and load them into memory.\\nComing from C# my goto tools to perform the manual mapping are \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Dewera/Lunar\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Lunar\"), \"\\nand the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://thewover.github.io/Dynamic-Invoke/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"D/Invoke tooling in SharpSploit\"), \".\"), mdx(\"p\", null, \"Let\\u2019s compile the injector code as a DLL and export an inject function.\\nTo export the function we need to tell Nim to export it by adding the\\nfollowing pragmas: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"exportc, dynlib, and cdecl. or stdcall.\"), \"\\nThe resulting inject proc is as follows:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"proc inject(pid: int): bool {.stdcall, exportc, dynlib.} = \"), \"\\nLet\\u2019s compile the DLL as follows, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nim c --d:release --app:lib --opt:size --inject.nim\")), mdx(\"p\", null, \"With the DLL let\\u2019s manually map it SharpSploit\\u2019s D/Invoke tooling.\\nIf you just specifically want the D/Invoke part you can also use the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/TheWover/DInvoke\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"repository\"), \"\\nor \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.nuget.org/packages/DInvoke/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nuget package\"), \".\"), mdx(\"p\", null, \"SharpSploit D/Invoke Tooling:\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"./images/dinvoke_nimmanualmapcode.png\",\n    \"alt\": \"dinvokemanmapcode\"\n  }))), mdx(\"p\", null, \"Let\\u2019s run it and make sure our crt injector proc is executed properly.\"), mdx(\"h2\", {\n    \"id\": \"insert-screenshot\"\n  }, \"INSERT SCREENSHOT\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"./images/manmapdemo.png\",\n    \"alt\": \"manmepdemo\"\n  })), \"\\nExcellent!\"), mdx(\"h3\", {\n    \"id\": \"embedding-nimscript-with-nimscripter\"\n  }, \"Embedding NimScript with Nimscripter\"), mdx(\"p\", null, \"Within Nim there is an evolving scripting language known as NimScript.\\nIn the NimScript \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/nims.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"documentation\"), \" it is defined as,\\n\\u201Cthe subset of Nim that can be evaluated by Nim\\u2019s builtin virtual machine (VM).\\u201D\\nNimScript is typically used as a configuration language in a devops role for example to run tests and build projects.\\nHowever, one of the biggest caveats with NimScript as stated within the documentation,\\nNim\\u2019s \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/backends.html#interfacing-nim-code-calling-the-backend\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"FFI (foreign function interface)\"), \" is not available in NimScript.\\nThis means that any stdlib module which relies on importc cannot be used in the VM.\\u201D\\nNim\\u2019s FFI is how Nim can call other functions written in other programming languages, basically\\nNim\\u2019s cross-platform version \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/standard/native-interop/pinvoke\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"P/Invoke\"), \".\\nA possible solution is to write the FFI functionality in Nim and expose to NimScript.\"), mdx(\"p\", null, \"Does that mean NimScript is not viable? Absolutely not,\\nespecially with the slow shift in which especially for implant development\\nit\\u2019s not always ideal to statically embed everything. Instead leaning towards a lightweight\\nimplant that can dynamically resolve commands within memory so even if an analyst\\nobtains the binary, not everything is revealed.\"), mdx(\"p\", null, \"There are a couple open source projects: (\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/komerdoor/nim-embedded-nimscript\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/komerdoor/nim-embedded-nimscript\"), \"\\nand \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Serenitor/embeddedNimscript\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/Serenitor/embeddedNimscript\"), \") that show how to use\\nNimScript as an embedded scripting language.\"), mdx(\"p\", null, \"However, those repositories while noble do not easily allow the user to expose Nim code to NimScript and\\nmuch more simplistic.\\nLuckily, a new repository known as \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/beef331/nimscripter\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nimscripter\"), \" allows for easy interoperability between Nim and NimScript.\"), mdx(\"p\", null, \"Below is an example in which the FFI specific code to call \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MessageBoxA\"), \" is exposed to NimScript allowing\\nus to pass in a string of NimScript to invoke the Nim proc.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"nimscript_embeddedmessage.png\",\n    \"alt\": \"nimscript_embeddedmessage\"\n  }))), mdx(\"p\", null, \"In a nutshell what is happening under the hood is the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/beef331/nimscripter/blob/master/src/nimscripter.nim#L140\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"script is loaded\"), \" and the main body is evaluated which allows us to access symbols it exposes.\\nIf you would like to read more about embedding NimScript as well as just learn more about NimScript, I encourage you to check out this wonderful series:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\"), \".\"), mdx(\"h3\", {\n    \"id\": \"putting-the-pieces-together\"\n  }, \"Putting the Pieces Together\"), mdx(\"p\", null, \"While a simple injector is cool let\\u2019s see how hard it is to develop an implant\\nin Nim. The C2 I chose to develop the implant for is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/its-a-feature/Mythic\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Mythic\"), \", Mythic\\nis very sophisticated and well structured. Furthermore, implants are essentially plug and play as everything is\\ndockerized and your agent just needs to communicate back and forth via certain rest api endpoints.\"), mdx(\"p\", null, \"Sprouting a few weeks later \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/MythicAgents/Nimplant\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nimplant\"), \" is born.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"941px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"71.41339001062698%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACfElEQVQ4y2NgQAI/fvxgWLVSDcyWLpFheH3MiQkmN2WZHWPQCXcw+8D1JQzfv38HYxCA0RjAdhaEzl0qyBC9ihNs2OFF5oL/7/uLgdhLV3kz5SwxYdxyrYoxY4E/WO3cw/UMeMHMg9IM////B7P/Pw51+P8yoOTSFst64wgpYWR1cy8xMFx6AVF35OoR7IZ5LuBluDPBE8xOXCjZ2T1V6SqQ2appLHp34+Xg550bXHuBfLb///8IwPTc/PAft+uc5rMwgujoAwJS2lUMF2ObfDY394f8n7HO939GifP/tmVO/xed9T1ds8bmY8lq40KQ2qp1xkzR/dHYDZQt5QLTcYtNeBi4GGRvfpgw68f/7v97nnv/bF5n9nv5A8ufdauN/nMCQ6VgsdQBkFrfEgbm5CnJuF0pW80IDMMmsEu791gkbXnk8n/tPYc/8+4Y/J9xw+B/xnylfwHlov+bdximgdQUL1FhhoU5BlCqZQHTVp2SDG5dDOBYDp8qvbhkq/z/+r3qjwrWa7WU7DCwn3LN0R+mp/pAHG7XGZYbwdmpi5TBpucu0w8Lm6Daja4W5KjIGZB01rKqBbuBX758AZKiDCHTeMBelglh8E2fqb29YYPZUukgBh+YuqJNmiziDBBvpi+yZPj27RtuV4Ysg6cIxsxtolez90v+j1gq8T9xu8D/0hNSOwMWiYqDJGM3iYAtxWsYyIUhmzjACq0nc/OlHGU/nHiI/aH1TL60+AMcm+J2cR8JWyojCw7bNcKMMMNwGgrxMjCBLxSECCjwcTJ4Swqhq8vdoYfiOryuzDoDoa1nMcLF3JawMudcZWBKP83AFL8R7ECGoE0MWA0DABlO+pUZ8BlOAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3125a933e063ab22da800b151f09b486/93ed2/nimplant_logo.webp 941w\"],\n    \"sizes\": \"(max-width: 941px) 100vw, 941px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3125a933e063ab22da800b151f09b486/a048d/nimplant_logo.png 941w\"],\n    \"sizes\": \"(max-width: 941px) 100vw, 941px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/3125a933e063ab22da800b151f09b486/a048d/nimplant_logo.png\",\n    \"alt\": \"nimplant_logo\",\n    \"title\": \"nimplant_logo\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Nimplant is a cross-platform Linux and Windows implant for Mythic C2 that is fully asynchronous\\nwith the agent able to generate both C and C++. Currently it just has basic functionality; however, it will be updated\\nover time and become much more sophisticated. If you would like to read more about Nimplant\\nfeel free to read the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/MythicAgents/Nimplant/tree/master/documentation-payload/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"project\\u2019s documentation\"), \".\"), mdx(\"h3\", {\n    \"id\": \"obfuscation\"\n  }, \"Obfuscation\"), mdx(\"p\", null, \"With Nim there are ample opportunities throughout the development cycle to introduce obfuscation.\\nThree key areas that I will highlight are:\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Note: Of course these aren\\u2019t the only forms of obfuscation you can do just a small subset.\")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Code Obfuscation\")), mdx(\"p\", null, \"With Nim opportunities for code obfuscation are ripe, two quick and easy nimble packages you can utilize are:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Yardanico/nim-strenc\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nim-strenc\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Yardanico/nuglifier\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nuglifier\"), \".\\nLet\\u2019s just apply nim-strenc to the string literal and view the resulting C file in our Nimcache.\"), mdx(\"p\", null, \"Before:\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"./images/hello_world_basic.png\",\n    \"alt\": \"beforenimhello\"\n  }))), mdx(\"p\", null, \"After:\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"./images/strenc_hello_world.png\",\n    \"alt\": \"afternimhellostrenc\"\n  }))), mdx(\"p\", null, \"When compiling the creator of strenc recommends turning hints off and stripping the binary so we shall do that.\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nim c --run --hints:off --d:release --passL:-s\"), \"\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--passL\"), \" will pass an option to the linker and we are passing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-s\"), \" to the GCC linker to perform stripping.\\nWithin the Nimcache folder, go to hello_r and view the file \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@mhello.nim.c\"), \".\\nInside that file we can see both string literals after they have been xor encrypted:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-c\"\n  }), \"STRING_LITERAL(TM__xLHv575t3PG1lB5wK05Xqg_3, \\\"\\\\207\\\\251\\\\241\\\\236\\\\234\\\\320\\\\246\\\\231\\\\205\\\\230\\\\221\\\\333\\\", 12);\\nSTRING_LITERAL(TM__xLHv575t3PG1lB5wK05Xqg_4, \\\"\\\\360\\\\275\\\\246\\\", 3);\\n\")), mdx(\"p\", null, \"With nim-strenc if you look at the codebase it\\u2019s less than 30 lines.\\nIt\\u2019s applying a compile-time macro that affects every string and xor encrypts\\nevery string. For more information about compile-time macros\\nand how they can be leveraged for obfuscation read this \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://wasm.in/blogs/meta-programmirovanie-nim-i-obfuskacija.706\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"forum post\"), \" (you will most likely need Google Translate for it.)\"), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"LLVM Obfuscation\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"For more in-depth obfuscation LLVM obfuscation can be utilized.\\nThere are two routes you can down as\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The easier of the two routes is to use \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/arnetheduck/nlvm\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"nlvm\"), \"\\nto generate the intermediate representation (IR). Although, currently nlvm has some limitations so keep that in mind\\nwhen trying to convert your program to IR. With the IR, you can do in-tree or out-of-tree LLVM obfuscation\\nwith tools such as \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/emc2314/YANSOllvm\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"YANSOllvm\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/thebabush/dumb-obfuscator\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"dumb-obfuscator\"), \".\\nA note with YANSOllvm is that since it is in-tree obfuscation passes\\nand does deeper changes you will need to build the entire \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://llvm.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LLVM framework\"), \" which\\nmay take upwards of an hour.\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The other route is to take the generated C/C++ code transform to IR such as with clang\\nand perform the in-tree or out-of-tree obfuscation and then link it all back together.\\nDepending on the complexity of your program you may end up working with multiple files\\nand make sure it\\u2019s linked properly.\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"I will leave this to the reader to experiment with\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"IAT Manipulation\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"If we throw the executable into a PE analyzer such as pe-studio or pebear we can see some imports\\nthat could raise some flags for static analysis. Especially the following imports:\\n\\u201CLoadLibraryA and GetProcAddress\\u201D, to help bypass static analysis we can use tools\\nsuch as \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/d35ha/CallObfuscator\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"CallObfuscator\"), \". For example,\\nyou can manipulate the IAT so the thunk that points to LoadLibraryA will point to\\nNotLoadLibrarayA and the thunk for GetProcAddress to NotGetProcAddress.\"))), mdx(\"h3\", {\n    \"id\": \"looking-towards-the-future\"\n  }, \"Looking Towards the Future\"), mdx(\"p\", null, \"While I covered a fair amount of things you can do with Nim, this is not everything.\\nSome things down the road that I plan to investigate are:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Nim\\u2019s interoperability with Go such as with \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/stefantalpalaru/golib-nim\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"golib-nim\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Adding more features to Nimplant and making it fully cross-platform with an option to\\ncompile to Objective-C for a macOS agent\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Researching & Creating alternative methods for dynamic invocation of Windows APIs without using LoadLibrary and GetProcAddress\")), mdx(\"h3\", {\n    \"id\": \"conclusion\"\n  }, \"Conclusion\"), mdx(\"p\", null, \"Overall, Nim is an interesting language that can jumpstart development instead\\nof having to be bogged down by the intricacies of languages such as Rust and C++.\\nNim is a jumper cable that allows you to be versatile with the benefit of being cross-platform with a minimal\\nfinal binary size. Where obfuscation is ripe as well, Nim may slowly rise in popularity\\nover the next few years, some \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://securelist.com/zebrocys-multilanguage-malware-salad\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"APTs are already using it\"), \".\\nAll code snippets can be found \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/NimbleMusings\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"here\"), \".\"), mdx(\"h3\", {\n    \"id\": \"special-thanks\"\n  }, \"Special Thanks\"), mdx(\"p\", null, \"This post wouldn\\u2019t be possible without the help of a few amazing people.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.https://twitter.com/bohops\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@bohops\"), \".\\nThank you for the motivation and for providing interesting insights\\nto fuel implant development as well as Nim tradecraft.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/TheRealWover\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@theWover\"), \"\\nThank you for inspiring Nimplant and for some amazing talks\\nbouncing some really fun ideas to advance Nim tradecraft.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/its_a_feature_\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@its_a_feature\", \"_\"), \"\\nThank you for all the help with Nimplant\\u2019s development, answering\\nany question along the way and helping with late-night debugging sessions.\"))), mdx(\"h3\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/manual.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://nim-lang.org/docs/manual.html\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://nim-lang.org/docs/nims.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://nim-lang.org/docs/nims.html\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://peterme.net/using-nimscript-as-a-configuration-language-embedding-nimscript-pt-1.html\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://thewover.github.io/Dynamic-Invoke/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://thewover.github.io/Dynamic-Invoke/\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAMEBQEC/8QAFwEBAAMAAAAAAAAAAAAAAAAAAgABA//aAAwDAQACEAMQAAAB046HkXvoCnaA3rg5/wD/xAAbEAACAwEBAQAAAAAAAAAAAAABAgADEgQTIv/aAAgBAQABBQJ7Tr2YRToWfLK2Zzgiq5FZOapNT//EABoRAQACAwEAAAAAAAAAAAAAAAEAEQIDEDL/2gAIAQMBAT8B1CrcyKYeef/EABoRAAICAwAAAAAAAAAAAAAAAAABAzEQIUH/2gAIAQIBAT8BkidirZzH/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEhAhARMjFBkf/aAAgBAQAGPwKNbZKk3OSX4LPZK4Nbf//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQRBRYf/aAAgBAQABPyEXFTFj0dvPsERAtnq6SJbXmrTsrqMkl4MusZvj/9oADAMBAAIAAwAAABBU17z/xAAZEQEAAgMAAAAAAAAAAAAAAAABABBBgZH/2gAIAQMBAT8Qx47qAoRokr//xAAbEQABBAMAAAAAAAAAAAAAAAABABARoTFBwf/aAAgBAgEBPxCQANmuqcNkM2//xAAdEAEBAAICAwEAAAAAAAAAAAABEQAhMUEQUXGB/9oACAEBAAE/EIc1tW77+DhG3UhLHevuGVLyPT2YYCteCGjxvA6XKE79L1jBYzL0PGHPb0J+mVN+AbL88f/Z","aspectRatio":1.0776255707762556,"src":"/static/79190400539718d31b26ef176c333897/e436c/test.jpg","srcSet":"/static/79190400539718d31b26ef176c333897/e0f30/test.jpg 236w,\n/static/79190400539718d31b26ef176c333897/86afd/test.jpg 472w,\n/static/79190400539718d31b26ef176c333897/e436c/test.jpg 899w","srcWebp":"/static/79190400539718d31b26ef176c333897/f5dd8/test.webp","srcSetWebp":"/static/79190400539718d31b26ef176c333897/77392/test.webp 236w,\n/static/79190400539718d31b26ef176c333897/1f177/test.webp 472w,\n/static/79190400539718d31b26ef176c333897/f5dd8/test.webp 899w","sizes":"(max-width: 899px) 100vw, 899px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAMEBQEC/8QAFwEBAAMAAAAAAAAAAAAAAAAAAgABA//aAAwDAQACEAMQAAAB046HkXvoCnaA3rg5/wD/xAAbEAACAwEBAQAAAAAAAAAAAAABAgADEgQTIv/aAAgBAQABBQJ7Tr2YRToWfLK2Zzgiq5FZOapNT//EABoRAQACAwEAAAAAAAAAAAAAAAEAEQIDEDL/2gAIAQMBAT8B1CrcyKYeef/EABoRAAICAwAAAAAAAAAAAAAAAAABAzEQIUH/2gAIAQIBAT8BkidirZzH/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEhAhARMjFBkf/aAAgBAQAGPwKNbZKk3OSX4LPZK4Nbf//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQRBRYf/aAAgBAQABPyEXFTFj0dvPsERAtnq6SJbXmrTsrqMkl4MusZvj/9oADAMBAAIAAwAAABBU17z/xAAZEQEAAgMAAAAAAAAAAAAAAAABABBBgZH/2gAIAQMBAT8Qx47qAoRokr//xAAbEQABBAMAAAAAAAAAAAAAAAABABARoTFBwf/aAAgBAgEBPxCQANmuqcNkM2//xAAdEAEBAAICAwEAAAAAAAAAAAABEQAhMUEQUXGB/9oACAEBAAE/EIc1tW77+DhG3UhLHevuGVLyPT2YYCteCGjxvA6XKE79L1jBYzL0PGHPb0J+mVN+AbL88f/Z","aspectRatio":1.0794701986754967,"src":"/static/79190400539718d31b26ef176c333897/1dc0b/test.jpg","srcSet":"/static/79190400539718d31b26ef176c333897/3a5ce/test.jpg 163w,\n/static/79190400539718d31b26ef176c333897/05730/test.jpg 327w,\n/static/79190400539718d31b26ef176c333897/1dc0b/test.jpg 653w,\n/static/79190400539718d31b26ef176c333897/e436c/test.jpg 899w","srcWebp":"/static/79190400539718d31b26ef176c333897/0acdf/test.webp","srcSetWebp":"/static/79190400539718d31b26ef176c333897/ac59e/test.webp 163w,\n/static/79190400539718d31b26ef176c333897/7660b/test.webp 327w,\n/static/79190400539718d31b26ef176c333897/0acdf/test.webp 653w,\n/static/79190400539718d31b26ef176c333897/f5dd8/test.webp 899w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAMEBQEC/8QAFwEBAAMAAAAAAAAAAAAAAAAAAgABA//aAAwDAQACEAMQAAAB046HkXvoCnaA3rg5/wD/xAAbEAACAwEBAQAAAAAAAAAAAAABAgADEgQTIv/aAAgBAQABBQJ7Tr2YRToWfLK2Zzgiq5FZOapNT//EABoRAQACAwEAAAAAAAAAAAAAAAEAEQIDEDL/2gAIAQMBAT8B1CrcyKYeef/EABoRAAICAwAAAAAAAAAAAAAAAAABAzEQIUH/2gAIAQIBAT8BkidirZzH/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEhAhARMjFBkf/aAAgBAQAGPwKNbZKk3OSX4LPZK4Nbf//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQRBRYf/aAAgBAQABPyEXFTFj0dvPsERAtnq6SJbXmrTsrqMkl4MusZvj/9oADAMBAAIAAwAAABBU17z/xAAZEQEAAgMAAAAAAAAAAAAAAAABABBBgZH/2gAIAQMBAT8Qx47qAoRokr//xAAbEQABBAMAAAAAAAAAAAAAAAABABARoTFBwf/aAAgBAgEBPxCQANmuqcNkM2//xAAdEAEBAAICAwEAAAAAAAAAAAABEQAhMUEQUXGB/9oACAEBAAE/EIc1tW77+DhG3UhLHevuGVLyPT2YYCteCGjxvA6XKE79L1jBYzL0PGHPb0J+mVN+AbL88f/Z","aspectRatio":1.0754716981132075,"src":"/static/79190400539718d31b26ef176c333897/eaa58/test.jpg","srcSet":"/static/79190400539718d31b26ef176c333897/5a3ee/test.jpg 114w,\n/static/79190400539718d31b26ef176c333897/41f8f/test.jpg 229w,\n/static/79190400539718d31b26ef176c333897/eaa58/test.jpg 457w,\n/static/79190400539718d31b26ef176c333897/c309b/test.jpg 686w,\n/static/79190400539718d31b26ef176c333897/e436c/test.jpg 899w","srcWebp":"/static/79190400539718d31b26ef176c333897/15384/test.webp","srcSetWebp":"/static/79190400539718d31b26ef176c333897/31fce/test.webp 114w,\n/static/79190400539718d31b26ef176c333897/e3e25/test.webp 229w,\n/static/79190400539718d31b26ef176c333897/15384/test.webp 457w,\n/static/79190400539718d31b26ef176c333897/0258d/test.webp 686w,\n/static/79190400539718d31b26ef176c333897/f5dd8/test.webp 899w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/79190400539718d31b26ef176c333897/e436c/test.jpg"}}},"authors":[{"authorsPage":true,"bio":"Core developer for theHarvester \nand enjoys red teaming Windows.\n","id":"7971a4b2-8c15-5c5b-86fd-173de5dac0d9","name":"NotoriousRebel","featured":false,"social":[{"url":"https://github.com/NotoriousRebel"},{"url":"https://twitter.com/NotoriousRebel1"}],"slug":"/authors/NotoriousRebel","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/afb2b/rebel_avatar.jpg 13w,\n/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/03612/rebel_avatar.jpg 75w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/58718/rebel_avatar.webp 13w,\n/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/ed320/rebel_avatar.webp 75w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/59538/rebel_avatar.jpg 150w,\n/static/c908e3ef9d0ce562bad340430706f232/fd013/rebel_avatar.jpg 200w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/d9b14/rebel_avatar.webp 150w,\n/static/c908e3ef9d0ce562bad340430706f232/6b183/rebel_avatar.webp 200w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/a2637/rebel_avatar.jpg 82w,\n/static/c908e3ef9d0ce562bad340430706f232/15203/rebel_avatar.jpg 164w,\n/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg 328w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/2d087/rebel_avatar.webp 82w,\n/static/c908e3ef9d0ce562bad340430706f232/29d87/rebel_avatar.webp 164w,\n/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp 328w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 328px) 100vw, 328px"}}}],"basePath":"/","permalink":"https://secbytes.net//Implant-Roulette-Part-1:-Nimplant/","slug":"/Implant-Roulette-Part-1:-Nimplant","id":"c2062405-0fab-5377-bab2-3b1ad4ddf015","title":"Implant Roulette Part 1: Nimplant","canonicalUrl":null,"mailchimp":false,"next":[{"id":"e5e132e2-60a8-51f3-837e-608f4c23bc5a","slug":"/Hiding-Your-Tracks-Bash-History","secret":false,"title":"Hiding Your Tracks Bash History","author":"Bad3r","date":"January 20th, 2020","dateForSEO":"2020-01-20T00:00:00.000Z","timeToRead":2,"excerpt":"Tricks to hide bash history.","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hiding Your Tracks Bash History\",\n  \"author\": \"Bad3r\",\n  \"date\": \"2020-01-20T00:00:00.000Z\",\n  \"hero\": \"./images/Hiding-Your-Tracks-Bash-History.jpg\",\n  \"excerpt\": \"Tricks to hide bash history.\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Different techniques for preventing commands from being stored in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\")), mdx(\"h1\", {\n    \"id\": \"-bash-history\"\n  }, \"\\u276F Bash history\"), mdx(\"p\", null, \"Bash maintains the list of commands internally in memory while it\\u2019s running. They are written into \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\"), \" (i.e, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"~/.bash_history\"), \")  when a user logs off. \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE           \\n/home/bad3r/.bash_history\\n\")), mdx(\"p\", null, \"This post is a cheat sheet for common methods attackers use to hide commands from being saved in the history file or in memory\"), mdx(\"h2\", {\n    \"id\": \"-leading-space\"\n  }, \"\\u276F Leading Space\"), mdx(\"p\", null, \"Might not be enabled by default in some distros \"), mdx(\"p\", null, \"Starting each command with a leading space character\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo \\\"hello\\\"\\nhello\\n\\u276F  echo \\\"ritsec\\\"\\nritsec\\n\\u276F history \\n    1  ls\\n    2  echo \\\"hello\\\"\\n    3  history \\n\")), mdx(\"p\", null, \"Notice that the command \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$echo \\\"hello\\\"\"), \" was saved  history unlike the commas with a leading space \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$ echo \\\"ritsec\\\"\"), \". This is possible because of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTCONTROL\"), \" environment variable \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F head -2 /etc/os-release\\n NAME=\\\"Ubuntu\\\" \\n VERSION=\\\"18.04.3 LTS (Bionic Beaver)\\\" \\n\\u276F echo $HISTCONTROL\\n ignoredups:ignorespace\\n\")), mdx(\"h2\", {\n    \"id\": \"-histfile\"\n  }, \"\\u276F \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTFILE\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" environment variable specifies bash history file\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\nHISTFILE\\n  The  name  of the file in which command history is saved (see HISTORY be\\u2010\\n  low).  The default value is ~/.bash_history.  If unset, the command  his\\u2010\\n  tory is not saved when a shell exits.\\n  the  value of HISTIGNORE.  The pattern matching honors the setting of the\\n  extglob shell option.\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE\\n/home/bad3r/.bash_history\\n\")), mdx(\"p\", null, \"To avoid recording commands to the file in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\"), \" set \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" value to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/dev/null\"), \" \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F HISTFILE=/dev/null\\nOR\\n\\u276F export HISTFILE=/dev/null\\n\")), mdx(\"h3\", {\n    \"id\": \"-using-unset\"\n  }, \"\\u276F Using unset\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"man bash\\nunset\\n  Remove variable or function names\\n\")), mdx(\"p\", null, \"We can use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unset\"), \" to remove the variable \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" for the current session \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE\\n/root/.bash_history\\n\\u276F unset HISTFILE\\n\\u276F echo $HISTFILE\\n\\n\\u276F\\n\")), mdx(\"p\", null, \"Note that it will only effect the current session. If you start another session the variable \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" will still be set unlike changing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTILE\"), \" value to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/dev/null\")), mdx(\"h2\", {\n    \"id\": \"-histsize--histfilesize\"\n  }, \"\\u276F \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTSIZE\"), \" & \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTFILESIZE\")), mdx(\"p\", null, \"Notice the distinction between \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"file\"), \": on disk - and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"list\"), \": in memory.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTSIZE\"), \" is the number of lines or commands that are stored in memory in a history list while your bash session is ongoing.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\n\\nHISTSIZE\\n  The number of commands to remember in the command  history  (see  HISTORY\\n  below).   If  the value is 0, commands are not saved in the history list.\\n  Numeric values less than zero result in every command being saved on  the\\n  history  list  (there  is no limit).  The shell sets the default value to\\n  500 after reading any startup files.\\n\")), mdx(\"p\", null, \"In order to remove all commands from to the history list in memory change the size to 0\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTSIZE\\n1000\\n\\u276F HISTSIZE=0  # OR export HISTSIZE=0\\n\\u276F echo $HISTSIZE\\n0\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILESIZE\"), \" is the number of lines or commands that \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"are allowed in the history file at startup time of a session, and\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"are stored in the history file at the end of your bash session for use in future sessions.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\n\\nHISTFILESIZE\\n  The  maximum  number  of  lines contained in the history file.  When this\\n  variable is assigned a value, the history file is  truncated,  if  neces\\u2010\\n  sary, to contain no more than that number of lines by removing the oldest\\n  entries.  The history file is also truncated to this size  after  writing\\n  it  when a shell exits.  If the value is 0, the history file is truncated\\n  to zero size.  Non-numeric values and numeric values less than  zero  in\\u2010\\n  hibit truncation.  The shell sets the default value to the value of HIST\\u2010\\n  SIZE after reading any startup files.\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILESIZE\\n2000\\n\\u276F HISTFILESIZE=0  # OR export HISTFILESIZE=0\\n\")), mdx(\"h2\", {\n    \"id\": \"-the-set--shopt-builtin\"\n  }, \"\\u276F The Set & Shopt Builtin\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"set\"), \" builtin allows you to change the values of shell options and set the positional parameters, or to display the names and values of shell variables.\\nUsing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"set\"), \" we can avoid recording new commands to the history list in memory. And,  because it\\u2019s not being saved in memory, it can not be recorded to file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-o\"), \" option-name:    Set the option corresponding to option-name \")), mdx(\"p\", null, \"The option name here is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"history\"), \" and its enabled by default. Using \\u2018+\\u2019 rather than \\u2018-\\u2019 causes these options to be turned off\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F set +o history\\n\")), mdx(\"p\", null, \"Using \\u2018-\\u2019 we can enable it again;\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F set -o history\\n\")), mdx(\"p\", null, \"Alternatively the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shopt\"), \" builtin command can be used\\nshopt builtin command allows you to change additional shell optional behavior.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-u\"), \"    Disable (unset) each optname.\\n\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \" \"), \"-o`    Restricts the values of optname to be those defined for the -o option to the set builtin\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F shopt -ou history\\n\")), mdx(\"p\", null, \"Re-enable it using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-s\"), \" flag; \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-s\"), \"    Enable (set) each optname.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F shopt -os history\\n\")), mdx(\"h2\", {\n    \"id\": \"-clearing-the-history\"\n  }, \"\\u276F Clearing the History\"), mdx(\"p\", null, \"Rather than disabling command history, we can clear the history on the current bash shell by simply using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"history\"), \" command with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-c\"), \" (clear) flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F history -c\\n\")), mdx(\"p\", null, \"Then, to make certain the changes are written to disk, we need to tell the history command to write to disk with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-w\"), \" flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F history -w\\n\")), mdx(\"p\", null, \"This only clears the history of the current shell. Commands run in other shells will remain on disk.\"), mdx(\"h2\", {\n    \"id\": \"-shredding-the-history\"\n  }, \"\\u276F Shredding the History\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man shred\\n  shred - overwrite a file to hide its contents, and optionally delete it\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command shreds the target file making it unreadable\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F cat $HISTFILE\\nls\\nhistory -w\\n\\u276F shred $HISTFILE\\n\\u276F cat $HISTFILE\\n ,I\\xE7!h\\xF92g2V?\\u01A5f[\\xC6{L\\xB4w\\u0658\\xCC\\u02FFvC\\xD3/Zs\\nP\\xECP\\xF5\\xE4{K{\\xEB\\xFAJ :i6\\xAD\\xDA\\xFBR\\u0708?\\xC4\\xF1W?\\xE4\\xC6n6\\xBB\\xAC\\xCBo\\xFBD;NG\\xD6\\xCB\\xD3\\xE2\\xAFTR\\x7F\\xFA&\\xCD__t\\xC7\\xD9\\n?\\xCFG5\\xC3\\xF6-\\xF2y\\xDE\\xC8\\n           O\\xCB\\xE3\\n...\\n\")), mdx(\"p\", null, \"After using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command the history file contains bunch of binary data that is nonsense.\"), mdx(\"p\", null, \"The fact that the file is shredded may in itself be considered evidence of malicious activity. We can eliminate even that by combining the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-zu\"), \" flags\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-u\"), \" deallocate and remove file after overwriting\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-z\"), \" a final overwrite with zeros to hide shredding\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F cat $HISTFILE\\nls\\nhistory -w\\u276F docker exec -ti 6e0aec73e61c bash\\n\\n\\u276F shred -zu $HISTFILE\\n\\u276F cat $HISTFILE\\ncat: /root/.bash_history: No such file or directory\\n\")), mdx(\"h2\", {\n    \"id\": \"-killing-bash-process\"\n  }, \"\\u276F Killing Bash Process\"), mdx(\"p\", null, \"Using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kill\"), \" command we can exit the session without saving commands in memory to disk using;\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F kill -9 $$\\n\")), mdx(\"p\", null, \"thanks to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/ReigningShells\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@ReigningShells\")), mdx(\"h2\", {\n    \"id\": \"-using-more\"\n  }, \"\\u276F Using More\"), mdx(\"p\", null, \"We can hide a command from being saved in memory using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"more\"), \" ability to excute commands by prepending them with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"!\"), \" \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"!<cmd>\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \":!<cmd>\"), \" Execute \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"<cmd>\"), \" in a subshell\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F ps -aef | more                        \\nUID          PID    PPID  C STIME TTY          TIME CMD\\nroot           1       0  0 Jan20 ?        00:00:03 /sbin/init\\nroot           2       0  0 Jan20 ?        00:00:00 [kthreadd]\\nroot           3       2  0 Jan20 ?        00:00:00 [rcu_gp]\\n...\\n!echo \\\"thanks @13_0_0_0_0\\\"\\nthanks @13_0_0_0_0\\n------------------------\\n\")), mdx(\"p\", null, \"At the more prompt type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"!\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \":!\"), \" followed by your command.\"), mdx(\"p\", null, \"This same technique can be used with other \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gtfobins.github.io/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GTFOBIN\"), \" like \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vim\"), \" \"));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5031847133757963,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/e0f30/Hiding-Your-Tracks-Bash-History.jpg 236w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/86afd/Hiding-Your-Tracks-Bash-History.jpg 472w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg 944w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/02748/Hiding-Your-Tracks-Bash-History.jpg 1416w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5c241/Hiding-Your-Tracks-Bash-History.jpg 1888w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/77392/Hiding-Your-Tracks-Bash-History.webp 236w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/1f177/Hiding-Your-Tracks-Bash-History.webp 472w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp 944w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/4a492/Hiding-Your-Tracks-Bash-History.webp 1416w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/b0b8f/Hiding-Your-Tracks-Bash-History.webp 1888w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.4954128440366972,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/3a5ce/Hiding-Your-Tracks-Bash-History.jpg 163w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/05730/Hiding-Your-Tracks-Bash-History.jpg 327w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg 653w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/f72c7/Hiding-Your-Tracks-Bash-History.jpg 980w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/6e4a3/Hiding-Your-Tracks-Bash-History.jpg 1306w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/ac59e/Hiding-Your-Tracks-Bash-History.webp 163w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/7660b/Hiding-Your-Tracks-Bash-History.webp 327w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp 653w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/75470/Hiding-Your-Tracks-Bash-History.webp 980w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/68d47/Hiding-Your-Tracks-Bash-History.webp 1306w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/5a3ee/Hiding-Your-Tracks-Bash-History.jpg 114w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/41f8f/Hiding-Your-Tracks-Bash-History.jpg 229w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg 457w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/c309b/Hiding-Your-Tracks-Bash-History.jpg 686w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/e3008/Hiding-Your-Tracks-Bash-History.jpg 914w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/31fce/Hiding-Your-Tracks-Bash-History.webp 114w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/e3e25/Hiding-Your-Tracks-Bash-History.webp 229w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp 457w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/0258d/Hiding-Your-Tracks-Bash-History.webp 686w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/64ea2/Hiding-Your-Tracks-Bash-History.webp 914w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/0ff54/Hiding-Your-Tracks-Bash-History.jpg"}}},{"id":"31f00fd2-fe08-554a-8fb0-8e5e4bca4201","slug":"/Using-and-Abusing-Aliases-with-PowerShell","secret":false,"title":"Using and Abusing Aliases with PowerShell","author":"NotoriousRebel","date":"November 24th, 2019","dateForSEO":"2019-11-24T00:00:00.000Z","timeToRead":5,"excerpt":"Shimming Aliases with PowerShell","canonical_url":null,"subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Using and Abusing Aliases with PowerShell\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-11-24T00:00:00.000Z\",\n  \"hero\": \"./images/Treasure.jpg\",\n  \"excerpt\": \"Shimming Aliases with PowerShell\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \"\\nIn preparation for another \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://lockdown.ubnetdef.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"UB Lockdown\"), \", I had a goal in mind,\\nwork on a new tool for Windows Persistence. It\\u2019s good to thoroughly understand\\nother developers tools that have been made such as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/outflanknl/SharpHide/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharpHide\"), \"\\nor\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/fireeye/SharPersist\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharPerist\"), \". However, I wanted to create something\\nfrom scratch and do something different. The problem I faced was that it\\u2019s hard to be unique\\nand create something from scratch when a lot of tools already exist that accomplish your vision. Luckily, I had an idea because when red teaming for Linux one technique for persistence is shimming aliases through .bashrc\\nor .bash_aliases. However, I could not find any tools or much research in regards to using aliases for red teaming Windows. Thus began my journey!\"), mdx(\"h3\", {\n    \"id\": \"understanding-aliases\"\n  }, \"Understanding Aliases\"), mdx(\"p\", null, \"With Powershell becoming more and more prevalent for both red teamers\\nand blue teamers I focused my research into Powershell aliases instead of Command Prompt aliases. By simply doing\\nGet-Alias in Powershell you will see that a lot of things are aliased, some of the most useful and surprising ones are cat, clear, cp, iex, iwr, and ls. This is only a small snippet out of the 158 built-in aliases with Powershell version 5.\\nMicrosoft defines an alias as: \\u201Can alternate name or nickname for a cmdlet or for a command element, such as a function, script, file, or executable file. You can use the alias instead of the command name in any PowerShell commands.\\u201D\"), mdx(\"h3\", {\n    \"id\": \"basic-shimming-with-one-alias\"\n  }, \"Basic Shimming with one Alias\"), mdx(\"p\", null, \"Now that we understand what an Alias is and just how prevalent they are\\nin Powershell now it\\u2019s time to shim one. Let\\u2019s shim the alias ls as it is fairly common. First let\\u2019s see what the ls alias is defined as, to do that we simply type \", mdx(\"br\", null)), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"(Get-Alias -Name ls).Definition\\n\")), mdx(\"p\", null, \"This returns Get-ChildItem which is what ls is aliased to.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1234px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.42139384116695%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAAB/0lEQVQoz52R20/TUBzHf4Nt4NSgkQgbBEa77uYgxEuCE6U6oy+ohLCt7MK8zA224QV5MSb64rv6oA/qX2eiiY512MLatT2n/tot8WGAiSffnH5P+/v0dznw42f92/dGq/m7vSvJoiw3ZaVZV5o7hiqZ+j7V9lBdo+/Zx+5L0pZBa6uSRMSGLomaKOqNX3RX1HfqqrJPFdVoK1RVSaulo9EUU1WIphPTXpRSUFWFmiahFNXdqH0kVDeIYVCD4G6bjgjpBOuGAdTQzP9dsPX2a/nVp9qbz6WXH3Nb7wrb79deWCpsf0B/hCqvv8CpmRxMrcDEsoNNO4MCeO+C7x6MLcHZRRi5A6OHaGTRigwlaq6QcObCA//CxtS16smZ/InpfODGpneuOBBe7ecE/GOv+oPCYDQDk/NlYJJ+vsolnoxfWUfSFVoN3nwaufUMYWCTjkCqVxBIYUoYu1x0hgRPLD8YzR47l/XEcp5YdiCScYWFPi59IPkX9l8tD1965IuXhy8+xJqRxHqwqsNydmE25cK6xuNFfDiD6ePT+aHZAn5A0h3JONgkRvwDDlyvYM/eeIlLbDJ81U6ei95+zvK1o3ruwCy/gXl88dLE/Pro3GMkcQSTCxWGr1k3x6yAVUKPmCSGWfDp8/eHZtfc1sWkcQwd08el0BwoHKc7nME2/wBcPGjQqG8a3wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/020cda62d41a8bf50ea82c8709683492/c2bb4/basic.webp 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png\",\n    \"alt\": \"Automate\",\n    \"title\": \"Automate\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"As we can see here the alias for ls has been redefined to:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"{Get-ChildItem; hello_world}\\n\")), mdx(\"p\", null, \"hello_world being our function that simply prints Hello World!\"), mdx(\"p\", null, \"Let\\u2019s break down what we are actually doing:\"), mdx(\"p\", null, \"hello_world function simply prints Hello World!\\nshimmed_ls is the name of the function we are going to realias ls to\\nthis function simply does Get-ChildItem which is what ls was originally mapped to.\\nNow it is realiased to Get-ChildItem; hello_world\"), mdx(\"p\", null, \"Lastly, let\\u2019s break the command that sets the alias.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Set-Alias -Name ls -Value shimmed_ls -Option AllScope -Scope Global -ErrorAction SilentlyContinue -Force\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Name ls\"), \": Name of our alias we are realiasing\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Value shimmed_ls\"), \": What we are realiasing ls to\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Option AllScope\"), \": Alias is copied to any new scopes that are created\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Scope Global\"), \": Scope in which alias is valid. Global means scope is in effect when PowerShell starts.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ErrorAction\"), \": If an error should occur for whatever reason it will not error display an error message user as that may alert the user, rather just silently continue.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Force\"), \": This is required as the majority of built-in PowerShell aliases are ReadOnly which means they cannot be changed or deleted unless the Force parameter is used. To see which aliases are ReadOnly do: \"))), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Get-Alias | Where-Object {$_.Options -Match \\\"ReadOnly\\\"}\\n\")), mdx(\"h3\", {\n    \"id\": \"basic-removal-of-the-shim\"\n  }, \"Basic Removal of the Shim\"), mdx(\"p\", null, \"Now that we have remapped an alias, you\\u2019re probably\\nwondering how do I remove it?\"), mdx(\"p\", null, \"The answer is simple as we can just do:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Remove-Alias -Name ls -Force\\nOr\\nRemove-Item alias:ls -Force\\n\")), mdx(\"p\", null, \"That works just fine as ls is no longer aliased our shim no longer works.\"), mdx(\"br\", null), mdx(\"p\", null, \"However, we can fix that :)\"), mdx(\"br\", null), mdx(\"p\", null, \"Now when you do Set-Alias instead of  \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope\"), \" do\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope, Constant\")), mdx(\"p\", null, \"Let\\u2019s try deleting it now, we will even run PowerShell as an administrator\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1255px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.430278884462155%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABJ0AAASdAHeZh94AAABwElEQVQoz53Qy2sTQRwH8LEFEUqt0DwPBa2xqZtXKTSR3jwoVvFQSl7dKNjEm2Bt6d3/0YOnmuaxyXZ3Z5/ZzTx3nPUg4kn88mGY7wy/OQz4PprNdHMyhzdTfapD20fekrphwgmZs8B+xNyQuAviL/lvgYQ4uB6Ov11rs1sXWtataVuWDR3DNHXTgjp0TNNwHNuwZKAXLLwg8PyE6weW7QHH80xrCfUotBA0sG1Qz/BdI6CICMY4o5zQmFJGSCw3hHJKOSNC8CgMQBSFjAmMYoI5xpygGOMYyYpiSmJMOMExIfKKyUqJkI/IcSGEHyTDkfg7sfiH+L4PEFqK/wpCCAxHk/F0PtF0uY41SZ9oss5/jDVp+MvNH4ajqSZ/0/ZM6ILD46vyq/Pam8vSy/Pq0Zfa6wtZC88/5Rr93LNBvjHINvqbB/3UQT9dT2Tq8vxjpj548e4rUA7Pinu9wl4vX+qmle6D3c5Gsb2200o2u21pvdi+W2jdK7RWHzdXtpvg4cmdRydg67h69Blk6x9SFXVr//26cnpf6aYr6mbpNF1WMxU1VU5kq2q+2svVehtKd+1pZ+VJe3WnA7ab+28vfwJAlrjM0vN6CAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/00e58dcd33a1beaa463d48a8837577ee/aecae/removeme.webp 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png\",\n    \"alt\": \"RemoveMe\",\n    \"title\": \"RemoveMe\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"PowerShell now throws an error as the alias is a constant!\"), mdx(\"h3\", {\n    \"id\": \"taking-it-one-step-further\"\n  }, \"Taking it one Step Further\"), mdx(\"p\", null, \"Now that we have learned how to realias aliases to our shimmed version\\nwouldn\\u2019t it be nice to just cut out the middle man. Instead of relaliasing aliases\\nlet\\u2019s just redefine what the alias is defined as!\"), mdx(\"p\", null, \"Back to our favorite example with ls\\nwe saw that it was aliased to Get-ChildItem so lets try redefining\\nwhat Get-ChildItem is:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1077px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.93779015784587%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAABvElEQVQoz52RyU/CQBTGB3ENrgjiEhQCosiOqGhwuRmjhINiRSkiyGY8aCLhb/XgTYUKbay0FCy0vsrFQOjB5pf2vZl+830zg0pl6vml9PpG1T+rLPlJV5gq9cWRJY4ieParWa/yHMBAIXwzHSC+ydfrTZbhYZZjWjQt0LTIVJu1WqPBCY2ayLECw4o1ThBEsQMktFrifx9UJCrFD5KoUJD/nSCLBEmUpRp4LZYlSpU2b10gbyhvPXxwB/OO4yfb0eN6qOAJ5r2hguskbzy4n9/OzGze9gIZ9nILO5m57bTaewPMbqXU6zfTvoTGl1QuY8h4hgynPdEHMrqt1Kw/NemJD6xeIFO4bxnrM5+334p20QM04Y6pHDgw5sSnPPExB64whX81klIetLCTlv4zhQdXIxpfYsJ9DeawlmYj2b8iBZETq71x9Kscd8VGbFGVHYdRpQUbdUKW2JD1Epl6i+f8t/AZd10b9u/gkHSbUjtojegD2cVATmWPypgjrS8B06MuXL+bg9jajSSMDtuudP4U3MLI2pWcGGIrzJjScgEJAcjfPi2oVY4otHKxl3azYAKGsFsw+evT0XbzAzYNVl0qw/B6AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e549a724c271a943c658d842798ef103/e87cb/advanced.webp 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e549a724c271a943c658d842798ef103/6977f/advanced.png 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e549a724c271a943c658d842798ef103/6977f/advanced.png\",\n    \"alt\": \"Advanced\",\n    \"title\": \"Advanced\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Get-ChildItem has been redefined to spawn a powershell session that simply calls Get-ChildItem. PowerShell is called with the flag -nop short for NoProfile as to not load profiles.\"), mdx(\"h3\", {\n    \"id\": \"powershell-profiles-to-the-rescue\"\n  }, \"PowerShell Profiles to the Rescue\"), mdx(\"p\", null, \"There is one big problem with aliasing, our shimmed aliases\\nonly exist within the current PowerShell session.\\nThat means when a user opens up a new PowerShell session all our hard work\\nis lost. Luckily, PowerShell profiles exist, a profile is a PowerShell script that runs whenever the user opens up PowerShell. Profiles are documented in the MITRE attack\\nframework as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/%22\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"T1504\"), \"\\n. What this means for us is that we need to create that special profile called profile.ps1 that will load our malicious shims whenever a user opens up PowerShell.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The Four Different Locations of Powershell Profiles\"), \":\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"574px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"60.97560975609756%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABJ0AAASdAHeZh94AAABDklEQVQoz6VR2XLDMAjU/39kj9ROM9OJJSSh23ZWoumkbdqX7NgYgdjFoIzRz08vh9dDznnf923bYHNOb9Mk/j9QMUa9LEQUYqi1SgEcrXXsSCkmif+Gyrk4SxyYyOKqULbWQKeNFkhTd5RLKd77GAMeaymnXl9bJQvAOPZMBlQkZ+vsVyOq5MKM4hQGkBBlOYKXmVOM/RMCd8u3bWdjBqN3GF4S5VoNGW0WRKR/Mh1wluV8Pn+A/bNt55xnLzpQQmJdV+4ybij1OFRH0reebte2UWxHMQewoIV1bQjOx3masK8ZOA7//XTChf1mf+ruGMFaOipe/BdMyUnG8W3acrWvd7s6f+NHVu0P4KHiC9Z1vXZjtE7XAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b9b4cdd50d526ae8b131bc942f61d429/723c8/profile_locations_pshome.webp 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PSHOME = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\")), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$HOME = C:\\\\Users\", \"[\", \"User]\")), mdx(\"h4\", {\n    \"id\": \"you-can-also-do\"\n  }, \"You can also do\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"587px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"46.33730834752981%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAABCklEQVQoz31S7Y6EIAz0/V/yzn+uIAoFv7XXabbmzHrXZAIpZTpDqcaxcF3X/P1V8ziO/DvO89TVe8etc1fuP1TbtvEwDNz3gxLO88zTNDHyRphz5s77K3ccx4VHQlwwpESCxMuyXEpLKexE4bqu/BQfhCAAQEhEHGNSpaYQubZtxUUv9r3sX9x1Hb+aRu8gTG2177taBWAVakCGvBEiH2PUM8DcYG91N4WkNomzFKQUlcC6qmW5DGVwEeW9g6gLIXCi9GwZlqwzZfoklLMQOo7SbBDbeBIMkqTB41CI0tsGKbm9341QVJlCI0T+j2/TazG+TsnlZkOHImeNDAA28X288zJ1fzW0OsQP11u9bi/oc70AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f9304adc0e9e1ccc157471317e947f9c/d84e9/profile_locations_profile.webp 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"The two we are focusing on are:\"), mdx(\"h3\", {\n    \"id\": \"profilecurrentuserallhosts-and-profilealluserallhosts\"\n  }, \"$PROFILE.CurrentUserAllHosts\", mdx(\"strong\", {\n    parentName: \"h3\"\n  }, \" and \"), \"$PROFILE.AllUserAllHosts\"), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.CurrentUserAllHosts = C:\\\\Users\", \"\\\\\", \"[User]\", \"\\\\Documents\\\\WindowsPowerShell\\\\profile.ps1\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.AllUserAllHosts = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\profile.ps1\")), mdx(\"p\", null, \"To write to the latter of the two we need to have administrative permissions\\non the box. An interesting tidbit to note is that when PowerShell first runs it will check if the profile for all users has been created and if that doesn\\u2019t exist it will use the profile for the current user if it exists.\"), mdx(\"p\", null, \"Keep in mind PowerShell Profiles do not exist by default, you will have to create those files.\"), mdx(\"h3\", {\n    \"id\": \"putting-all-the-pieces-together\"\n  }, \"Putting All the Pieces Together\"), mdx(\"p\", null, \"With so many aliases in PowerShell and having to create the PowerShell Profiles, it could seem daunting to do this manually. Luckily you don\\u2019t have to as I created a simple PowerShell script called Remapper which does all of the hard work for you! The only thing you may wish to modify are the functions in the first lines of the script. These funcions are what will be called when an alias is run.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"What the script does:\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Get paths of profiles and create them if they don\\u2019t exist\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Create a dictionary mapping aliases to shimmed definitions for the majority of aliases.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Puts the code to rewrite every alias into both PowerShell profiles.\"))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Our shimmed function does four things\"), \":\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Do what the alias is originally meant for\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to restore firewall to default settings\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to turn off real-time monitoring\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check if google\", \".\", \"com is in the hosts file, if not will add it because during competitions we don\\u2019t blue teamers using Google ;).\"))), mdx(\"p\", null, \"Let\\u2019s run the script as an administrator and see what happens!\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/076d38417289bf32775eb32887a02362/demo.gif\",\n    \"alt\": \"Demo\"\n  }))), mdx(\"p\", null, \"As can be seen, both profiles have been modified and if we do Get-Alias everything has been shimmed. Now when we type an alias it will run our shimmed version of it :)\"), mdx(\"p\", null, \"The script can be found here:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/Remapper\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Remapper\")), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Monitoring of PowerShell Profile locations to look for either creation of the file or someone writing to it.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Checking what aliases are defined as\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding the use of aliases; although, if you dig into PowerShell\\u2019s\\nsource code you will see some commands use aliases!\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding Powershell Profiles all together using the flag -No Profile when using PowerShell.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Powershell Logging \"))), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into shimming aliases for Command Prompt sessions\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into CLR hooking instead of PowerShell profiles.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Researching the shimming of built-in PowerShell functions.\"))), mdx(\"h3\", {\n    \"id\": \"closing-thoughts\"\n  }, \"Closing Thoughts\"), mdx(\"p\", null, \"The concept of realiasing things in PowerShell is very fascinating, I have not seen too much research on it and would be curious to see just how far you can take it.\\nOverall, I hope this blog post gets people interested in the topic and can serve to be another neat trick for red teamers. While also giving blue teamers something else to watch out for.\"), mdx(\"h2\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://attack.mitre.org/techniques/T1504/\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\")))));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.4658385093167703,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e0f30/Treasure.jpg 236w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/86afd/Treasure.jpg 472w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg 944w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/02748/Treasure.jpg 1416w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5c241/Treasure.jpg 1888w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/77392/Treasure.webp 236w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1f177/Treasure.webp 472w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp 944w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/4a492/Treasure.webp 1416w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/b0b8f/Treasure.webp 1888w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.4684684684684686,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/3a5ce/Treasure.jpg 163w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/05730/Treasure.jpg 327w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg 653w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/f72c7/Treasure.jpg 980w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/6e4a3/Treasure.jpg 1306w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/ac59e/Treasure.webp 163w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/7660b/Treasure.webp 327w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp 653w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/75470/Treasure.webp 980w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/68d47/Treasure.webp 1306w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.4615384615384615,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5a3ee/Treasure.jpg 114w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/41f8f/Treasure.jpg 229w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg 457w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/c309b/Treasure.jpg 686w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3008/Treasure.jpg 914w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/31fce/Treasure.webp 114w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3e25/Treasure.webp 229w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp 457w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0258d/Treasure.webp 686w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/64ea2/Treasure.webp 914w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0ff54/Treasure.jpg"}}}]}}}