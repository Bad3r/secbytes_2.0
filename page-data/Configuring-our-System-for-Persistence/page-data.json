{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-article-template-tsx","path":"/Configuring-our-System-for-Persistence","result":{"data":{"allSite":{"edges":[{"node":{"siteMetadata":{"name":"SecBytes"}}}]}},"pageContext":{"article":{"id":"b53ebc3d-c52f-5220-abff-9d1dd43b47fd","slug":"/Configuring-our-System-for-Persistence","secret":false,"title":"Configuring our System for Persistence","author":"NotoriousRebel","date":"February 22nd, 2020","dateForSEO":"2020-02-22T00:00:00.000Z","timeToRead":4,"excerpt":"Utilizing the GAC and Machine Configuration Files for Persistence","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Configuring our System for Persistence\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2020-02-22T00:00:00.000Z\",\n  \"hero\": \"./images/binding.jpg\",\n  \"excerpt\": \"Utilizing the GAC and Machine Configuration Files for Persistence\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"Preparing for an upcoming red teaming competition and becoming one with the MSDN documents,\\nI stumbled across something very interesting. You may have noticed that when you create an .NET Framework application\\nwith Visual Studio an app.config is created.\\nA typical app.config looks like:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\" ?>\\n<configuration>\\n    <startup> \\n        <supportedRuntime version=\\\"v4.0\\\" sku=\\\".NETFramework,Version=v4.7.2\\\" />\\n    </startup>\\n</configuration>\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Configuration: Root element in every configuration file used by the common language runtime (CLR) and .NET Framework applications\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Startup: Element specifies Common Language Runtime (CLR) startup information\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Version: Specifies version of CLR this app \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Sku: Specifies which .NET Framework release this app supports\")), mdx(\"p\", null, \"That\\u2019s great but why should you care? Remember what was just said: \\u201CRoot element in every configuration file.\\u201D\\nThere are more configuration files besides app.config :)\\nThis is where our journey begins.\"), mdx(\"h3\", {\n    \"id\": \"note\"\n  }, \"Note:\"), mdx(\"p\", null, \"This post does not cover the internals of things such as GAC (Global Assembly Cache) CLR, or strong signed .NET assemblies. If you need a primer on those\\nI encourage you to check out \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/am0nsec\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"am0nsec\\u2019s\"), \"\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.contextis.com/en/blog/common-language-runtime-hook-for-persistence\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"post\"), \" covering\\na different technique for CLR hooking.\"), mdx(\"h3\", {\n    \"id\": \"digging-deeper\"\n  }, \"Digging Deeper\"), mdx(\"p\", null, \"Exactly what other config files exist?\\nBut before we get to that we must first understand how the runtime locates assemblies.\\nThere are four steps:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Examining the Configuration Files\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Checking for Previously Referenced Assemblies\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Checking the Global Assembly Cache\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Locating the Assembly through Codebases or Probing\")), mdx(\"p\", null, \"The first step is what we will be focusing on, there\\nare three configuration files.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"951px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"22.187171398527862%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAAjklEQVQY03WOWw6DIBBFXYSCgA0WCLAASsQaw/43dQWSJqaGj/Mxj3tmhhA+2LYNIQQcx4F931sdY0TOGed5IqVUZl9orcE5bxBCQCl9MEgp4ZyDrVjbUEo13oUqWde1UXvGGNRMVzjP803mikBBCIFxHDFN04Nfv4ar9F88MMbah957OO/wWpbu9Tu9nQs3p2zwDPMpsQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/e0b427c286ecbbbece32c98dd0fc019d/50566/config_files.webp 951w\"],\n    \"sizes\": \"(max-width: 951px) 100vw, 951px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/e0b427c286ecbbbece32c98dd0fc019d/ce125/config_files.png 951w\"],\n    \"sizes\": \"(max-width: 951px) 100vw, 951px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/secbytes_2.0/static/e0b427c286ecbbbece32c98dd0fc019d/ce125/config_files.png\",\n    \"alt\": \"Lists different config files\",\n    \"title\": \"Lists different config files\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"We already covered the application configuration file but what\\nabout the other two?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The publisher policy file\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Distributed by a component publisher as a fix or update to a shared component.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Affects all applications that use a shared component.\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"And finally:\")), mdx(\"p\", null, \"The machine configuration file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Takes precedence over all other configuration settings\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Applied to the entire machine.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"File resides on local computer in the config subdirectory\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Can be used by administrators to specify assembly binding restrictions that are local to that computer\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Requires administrative permissions to Modify\")), mdx(\"h3\", {\n    \"id\": \"understanding-machineconfig\"\n  }, \"Understanding machine.config\"), mdx(\"p\", null, \"Where is it located?\"), mdx(\"p\", null, \"Simply type this in PowerShell:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"[System.Runtime.InteropServices.RuntimeEnvironment]::SystemConfigurationFile\\n\")), mdx(\"p\", null, \"You will most likely get:\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\config\\\\machine.config\")), mdx(\"p\", null, \"There is also one here:\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v2.0.50727\\\\config\\\\machine.config\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"There are also config files in the 32-bit version of the .NET Framework as well\")), mdx(\"p\", null, \"According to Microsoft:\"), mdx(\"p\", null, \"When locating assemblies within machine.config the configuration system\\nwill first examine the appSettings element and other\\nsections that a developer has defined.\"), mdx(\"p\", null, \"It\\u2019s those other sections that allow us to get persistence.\\nOne section, in particular, stands out: the runtime section!\"), mdx(\"p\", null, \"In total, the runtime section and its parent and child elements\\ntotal to 55 items.\"), mdx(\"p\", null, \"However, we only care about two:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/appdomainmanagertype-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"appDomainManagerType\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/appdomainmanagerassembly-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"appDomainManagerAssembly\"))), mdx(\"h3\", {\n    \"id\": \"understanding-appdomainmanager--appdomainmanagerassembly\"\n  }, \"Understanding appDomainManager & appDomainManagerAssembly\"), mdx(\"p\", null, \"To understand why we care about those two elements we must understand\\nwhat an AppDomain is. AppDomains allow third-party untrusted\\ncode to run in an existing process. Essentially an AppDomain is a logical container for a set of assemblies.\\nThe appDomainManager class allows a host to override CLR default behavior by\\nusing managed code instead of using unmanaged code.\"), mdx(\"p\", null, \"We need to create a class that derives from AppDomainManager\\nwhich initializes a new domain. The appDomainManager can be set in a configuration file\\nby using the appDomainManagerAssembly and appDomainManagerType elements.\\nThe class needs to be installed into the GAC because the assembly needs to be granted full-trust,\\nall assemblies in the GAC are always granted full-trust.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TLDR:\"), \"\\nWe can create a class that derives from appDomainManager class\\nthat initializes a new domain to run our code.\\nThe InitializeNewDomain method is called on the new instance of AppDomainManager.\\nWe are hooking all calls to AppDomain.CreateDomain\\nto our AppDomainManager which in turn will run our code.\"), mdx(\"h3\", {\n    \"id\": \"putting-the-pieces-altogether\"\n  }, \"Putting the Pieces Altogether\"), mdx(\"p\", null, \"Now that we understand what machine.config and what appDomains are\\nand how we can leverage it. It\\u2019s time put all the pieces together\\nto accomplish persistence we have a few things we need to do:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Generate a keyfile simply do that with sn -k key.snk, \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/tools/sn-exe-strong-name-tool\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"sn\"), \" standing for strong name tool\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a strong signed .NET assembly using our newly created keyfile\\nthat assembly will be implementing an AppDomainManager\\nand overriding InitiliazeNewDomain\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Install that assembly onto the GAC using \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/tools/gacutil-exe-gac-tool\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"gacutil\"), \",\\nC# via \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.enterpriseservices.internal.publish.gacinstall\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Publish.GacInstall\"), \",\\nor PowerShell via this amazing \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://gitlab.com/snippets/1878274\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"script\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Modify machine.config\\u2019s runtime element attribute with the appDomainType and appDomainManagerAssembly elements:\")), mdx(\"p\", null, \"To get the appDomainManagerAssembly you can \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-xml\"\n  }), \"<runtime>  \\n    <appDomainManagerType value=\\\"Context Name\\\" />  \\n    <appDomainManagerAssembly   \\n        value=\\\"Signed, Version=1.0.0.0, Culture=neutral, PublicKeyToken=token\\\" />  \\n</runtime> \\n\")), mdx(\"p\", null, \"Luckily machine.config is simply an xml file so we can use so it was easy to modify\\nthere also exists the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.configuration\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"System.Configuration\"), \" namespace which I also could\\u2019ve utilized;\\nhowever, xml was personally much easier to use.\"), mdx(\"h3\", {\n    \"id\": \"demo-time\"\n  }, \"Demo Time\"), mdx(\"p\", null, \"Putting all those pieces together in a simple program\\nthat just requires you to put the keyfile in the correct spot automates\\nthe process :)\"), mdx(\"p\", null, \"Assemblies installed onto the GAC are located here:\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"C:\\\\Windows\\\\Microsoft.NET\\\\assembly\"), \"\\nYou will most likely see three folders:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"GAC_32\"), \" : For assemblies targeting 32-bit platforms\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"GAC_64\"), \" : For assemblies targeting 64-bit platforms\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"GAC_MSIL\"), \" : For assemblies targeting both 32-bit and 64-bit platforms\")), mdx(\"p\", null, \"You will notice our strong-named assembly called test is installed in GAC_MSIL\"), mdx(\"p\", null, \"One of the most important parts is where we create the class that\\ninherits from appDomainManager:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"using System;\\n    namespace Context {\\n        public sealed class ConfigHooking : AppDomainManager {\\n            public override void InitializeNewDomain(AppDomainSetup appDomainInfo) {\\n                System.Diagnostics.Process.Start(\\\"\\\"calc.exe\\\"\\\");\\n                return;\\n            }\\n        }\\n    }\\n\")), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/secbytes_2.0/22f560d519458db961352e625a13d66a/works.gif\",\n    \"alt\": \"Demo\"\n  }))), mdx(\"p\", null, \"The full code can be found here:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/ConfigPersist/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"ConfigPersist\")), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitoring of assemblies installed onto GAC\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Monitoring modifications to machine.config\")), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Look into automating the creation of configs for any arbitrary .NET assembly\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Dig deeper into just how powerful machine.config is\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Research .NET Core runtime persistence mechanisms\")), mdx(\"h3\", {\n    \"id\": \"closing-thoughts\"\n  }, \"Closing Thoughts\"), mdx(\"p\", null, \"The concept of leveraging built-in config files for persistence is quite fascinating\\nas with the shift from PowerShell to .NET tradecraft, .NET attacks will become\\nmuch more common and frequent.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Shout outs to:\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://twitter.com/am0nsec\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"am0nsec\"), \" for the amazing post\\non CLR hooking as well as insightful information on the .NET framework \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://twitter.com/subTee\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"subTee\"), \" for motivating me to work harder\\nand for his amazing research on the topic as well.\")), mdx(\"h2\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/runtime-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/runtime-element\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/startup/supportedruntime-element\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.appdomain\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/dotnet/api/system.appdomain\"))));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.708185053380783,"src":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/58fe7/binding.jpg","srcSet":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/e0f30/binding.jpg 236w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/86afd/binding.jpg 472w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/58fe7/binding.jpg 944w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/99fbb/binding.webp","srcSetWebp":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/77392/binding.webp 236w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/1f177/binding.webp 472w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/99fbb/binding.webp 944w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.708185053380783,"src":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/1dc0b/binding.jpg","srcSet":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/3a5ce/binding.jpg 163w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/05730/binding.jpg 327w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/1dc0b/binding.jpg 653w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/0acdf/binding.webp","srcSetWebp":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/ac59e/binding.webp 163w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/7660b/binding.webp 327w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/0acdf/binding.webp 653w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejhWwxGF//EABsQAAIBBQAAAAAAAAAAAAAAAAABAhAREjEy/9oACAEBAAEFAtHRihRvN0//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAAQAAECESEx/9oACAEBAAY/AlnBK9Y//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRAxUUH/2gAIAQEAAT8hrYvl0QVAhDwU8Hs//9oADAMBAAIAAwAAABAUP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEVFhMXH/2gAIAQEAAT8Qa8wzR2CVdzL+HZ4QetrEjbhjQdkTiNj/2Q==","aspectRatio":1.708185053380783,"src":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/eaa58/binding.jpg","srcSet":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/5a3ee/binding.jpg 114w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/41f8f/binding.jpg 229w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/eaa58/binding.jpg 457w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/c309b/binding.jpg 686w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/e3008/binding.jpg 914w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg 960w","srcWebp":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/15384/binding.webp","srcSetWebp":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/31fce/binding.webp 114w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/e3e25/binding.webp 229w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/15384/binding.webp 457w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/0258d/binding.webp 686w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/64ea2/binding.webp 914w,\n/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/fcc10/binding.webp 960w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/secbytes_2.0/static/fc0ea83a3d926ef2243c1e6ad37005c1/b1cc5/binding.jpg"}}},"authors":[{"authorsPage":true,"bio":"Core developer for theHarvester \nand enjoys red teaming Windows.\n","id":"7971a4b2-8c15-5c5b-86fd-173de5dac0d9","name":"NotoriousRebel","featured":true,"social":[{"url":"https://github.com/NotoriousRebel"},{"url":"https://twitter.com/NotoriousRebel1"}],"slug":"/authors/NotoriousRebel","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg","srcSet":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/afb2b/rebel_avatar.jpg 13w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/03612/rebel_avatar.jpg 75w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp","srcSetWebp":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/58718/rebel_avatar.webp 13w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/ed320/rebel_avatar.webp 75w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg","srcSet":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/7c20e/rebel_avatar.jpg 25w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/fa1ea/rebel_avatar.jpg 50w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/61cdf/rebel_avatar.jpg 100w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/59538/rebel_avatar.jpg 150w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/fd013/rebel_avatar.jpg 200w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp","srcSetWebp":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/74aad/rebel_avatar.webp 25w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/e7b2c/rebel_avatar.webp 50w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/66016/rebel_avatar.webp 100w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/d9b14/rebel_avatar.webp 150w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/6b183/rebel_avatar.webp 200w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABrjkos4bjyQbg/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEEP/aAAgBAQABBQIPpKdiMjE1tF6Bo9S+sgB//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHRAAAQIHAAAAAAAAAAAAAAAAIQABAhAREiAykf/aAAgBAQAGPwJyVFdXsyy1w//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQVFhgf/aAAgBAQABPyGgGxzD8Vto5aineSuMvMtY09sFBhzKSLP/2gAMAwEAAgADAAAAENsoff/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8QJhf/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QK//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVFxgfD/2gAIAQEAAT8Qx7JC2msS6kiAGs9l/ZgldMv9QZliIREN+PUDUxyJBIasmo7xG1SdpP/Z","aspectRatio":1,"src":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg","srcSet":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/a2637/rebel_avatar.jpg 82w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/15203/rebel_avatar.jpg 164w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/ec46e/rebel_avatar.jpg 328w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/836e2/rebel_avatar.jpg 480w","srcWebp":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp","srcSetWebp":"/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/2d087/rebel_avatar.webp 82w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/29d87/rebel_avatar.webp 164w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/5a48e/rebel_avatar.webp 328w,\n/secbytes_2.0/static/c908e3ef9d0ce562bad340430706f232/35871/rebel_avatar.webp 480w","sizes":"(max-width: 328px) 100vw, 328px"}}}],"basePath":"/","slug":"/Configuring-our-System-for-Persistence","id":"b53ebc3d-c52f-5220-abff-9d1dd43b47fd","title":"Configuring our System for Persistence","mailchimp":true,"next":[{"id":"e5e132e2-60a8-51f3-837e-608f4c23bc5a","slug":"/Hiding-Your-Tracks:-Bash-History","secret":false,"title":"Hiding Your Tracks: Bash History","author":"Bad3r","date":"February 21st, 2020","dateForSEO":"2020-02-21T00:00:00.000Z","timeToRead":1,"excerpt":"Utilizing the GAC and Configuration Files for Persistence","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hiding Your Tracks: Bash History\",\n  \"author\": \"Bad3r\",\n  \"date\": \"2020-02-21T00:00:00.000Z\",\n  \"hero\": \"./images/Hiding-Your-Tracks-Bash-History.jpg\",\n  \"excerpt\": \"Utilizing the GAC and Configuration Files for Persistence\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"hello-world\"\n  }, \"Hello World!\"));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5003663003663004,"src":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/e0f30/Hiding-Your-Tracks-Bash-History.jpg 236w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/86afd/Hiding-Your-Tracks-Bash-History.jpg 472w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg 944w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/02748/Hiding-Your-Tracks-Bash-History.jpg 1416w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/5c241/Hiding-Your-Tracks-Bash-History.jpg 1888w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/77392/Hiding-Your-Tracks-Bash-History.webp 236w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/1f177/Hiding-Your-Tracks-Bash-History.webp 472w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp 944w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/4a492/Hiding-Your-Tracks-Bash-History.webp 1416w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/b0b8f/Hiding-Your-Tracks-Bash-History.webp 1888w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5003663003663004,"src":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/3a5ce/Hiding-Your-Tracks-Bash-History.jpg 163w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/05730/Hiding-Your-Tracks-Bash-History.jpg 327w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg 653w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/f72c7/Hiding-Your-Tracks-Bash-History.jpg 980w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/6e4a3/Hiding-Your-Tracks-Bash-History.jpg 1306w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/ac59e/Hiding-Your-Tracks-Bash-History.webp 163w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/7660b/Hiding-Your-Tracks-Bash-History.webp 327w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp 653w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/75470/Hiding-Your-Tracks-Bash-History.webp 980w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/68d47/Hiding-Your-Tracks-Bash-History.webp 1306w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5003663003663004,"src":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/5a3ee/Hiding-Your-Tracks-Bash-History.jpg 114w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/41f8f/Hiding-Your-Tracks-Bash-History.jpg 229w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg 457w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/c309b/Hiding-Your-Tracks-Bash-History.jpg 686w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/e3008/Hiding-Your-Tracks-Bash-History.jpg 914w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/31fce/Hiding-Your-Tracks-Bash-History.webp 114w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/e3e25/Hiding-Your-Tracks-Bash-History.webp 229w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp 457w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/0258d/Hiding-Your-Tracks-Bash-History.webp 686w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/64ea2/Hiding-Your-Tracks-Bash-History.webp 914w,\n/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/secbytes_2.0/static/c039ecc8b1902ba211f89fb93fee93f6/0ff54/Hiding-Your-Tracks-Bash-History.jpg"}}},{"id":"31f00fd2-fe08-554a-8fb0-8e5e4bca4201","slug":"/Using-and-Abusing-Aliases-with-PowerShell","secret":false,"title":"Using and Abusing Aliases with PowerShell","author":"NotoriousRebel","date":"November 24th, 2019","dateForSEO":"2019-11-24T00:00:00.000Z","timeToRead":5,"excerpt":"Shimming Aliases with PowerShell","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Using and Abusing Aliases with PowerShell\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-11-24T00:00:00.000Z\",\n  \"hero\": \"./images/Treasure.jpg\",\n  \"excerpt\": \"Shimming Aliases with PowerShell\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \"\\nIn preparation for another \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://lockdown.ubnetdef.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"UB Lockdown\"), \", I had a goal in mind,\\nwork on a new tool for Windows Persistence. It\\u2019s good to thoroughly understand\\nother developers tools that have been made such as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/outflanknl/SharpHide/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharpHide\"), \"\\nor\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/fireeye/SharPersist\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"SharPerist\"), \". However, I wanted to create something\\nfrom scratch and do something different. The problem I faced was that it\\u2019s hard to be unique\\nand create something from scratch when a lot of tools already exist that accomplish your vision. Luckily, I had an idea because when red teaming for Linux one technique for persistence is shimming aliases through .bashrc\\nor .bash_aliases. However, I could not find any tools or much research in regards to using aliases for red teaming Windows. Thus began my journey!\"), mdx(\"h3\", {\n    \"id\": \"understanding-aliases\"\n  }, \"Understanding Aliases\"), mdx(\"p\", null, \"With Powershell becoming more and more prevalent for both red teamers\\nand blue teamers I focused my research into Powershell aliases instead of Command Prompt aliases. By simply doing\\nGet-Alias in Powershell you will see that a lot of things are aliased, some of the most useful and surprising ones are cat, clear, cp, iex, iwr, and ls. This is only a small snippet out of the 158 built-in aliases with Powershell version 5.\\nMicrosoft defines an alias as: \\u201Can alternate name or nickname for a cmdlet or for a command element, such as a function, script, file, or executable file. You can use the alias instead of the command name in any PowerShell commands.\\u201D\"), mdx(\"h3\", {\n    \"id\": \"basic-shimming-with-one-alias\"\n  }, \"Basic Shimming with one Alias\"), mdx(\"p\", null, \"Now that we understand what an Alias is and just how prevalent they are\\nin Powershell now it\\u2019s time to shim one. Let\\u2019s shim the alias ls as it is fairly common. First let\\u2019s see what the ls alias is defined as, to do that we simply type \", mdx(\"br\", null)), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"(Get-Alias -Name ls).Definition\\n\")), mdx(\"p\", null, \"This returns Get-ChildItem which is what ls is aliased to.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1234px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.42139384116695%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAAB/0lEQVQoz52R20/TUBzHf4Nt4NSgkQgbBEa77uYgxEuCE6U6oy+ohLCt7MK8zA224QV5MSb64rv6oA/qX2eiiY512MLatT2n/tot8WGAiSffnH5P+/v0dznw42f92/dGq/m7vSvJoiw3ZaVZV5o7hiqZ+j7V9lBdo+/Zx+5L0pZBa6uSRMSGLomaKOqNX3RX1HfqqrJPFdVoK1RVSaulo9EUU1WIphPTXpRSUFWFmiahFNXdqH0kVDeIYVCD4G6bjgjpBOuGAdTQzP9dsPX2a/nVp9qbz6WXH3Nb7wrb79deWCpsf0B/hCqvv8CpmRxMrcDEsoNNO4MCeO+C7x6MLcHZRRi5A6OHaGTRigwlaq6QcObCA//CxtS16smZ/InpfODGpneuOBBe7ecE/GOv+oPCYDQDk/NlYJJ+vsolnoxfWUfSFVoN3nwaufUMYWCTjkCqVxBIYUoYu1x0hgRPLD8YzR47l/XEcp5YdiCScYWFPi59IPkX9l8tD1965IuXhy8+xJqRxHqwqsNydmE25cK6xuNFfDiD6ePT+aHZAn5A0h3JONgkRvwDDlyvYM/eeIlLbDJ81U6ei95+zvK1o3ruwCy/gXl88dLE/Pro3GMkcQSTCxWGr1k3x6yAVUKPmCSGWfDp8/eHZtfc1sWkcQwd08el0BwoHKc7nME2/wBcPGjQqG8a3wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/020cda62d41a8bf50ea82c8709683492/c2bb4/basic.webp 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png 1234w\"],\n    \"sizes\": \"(max-width: 1234px) 100vw, 1234px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/secbytes_2.0/static/020cda62d41a8bf50ea82c8709683492/597b7/basic.png\",\n    \"alt\": \"Automate\",\n    \"title\": \"Automate\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"As we can see here the alias for ls has been redefined to:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"{Get-ChildItem; hello_world}\\n\")), mdx(\"p\", null, \"hello_world being our function that simply prints Hello World!\"), mdx(\"p\", null, \"Let\\u2019s break down what we are actually doing:\"), mdx(\"p\", null, \"hello_world function simply prints Hello World!\\nshimmed_ls is the name of the function we are going to realias ls to\\nthis function simply does Get-ChildItem which is what ls was originally mapped to.\\nNow it is realiased to Get-ChildItem; hello_world\"), mdx(\"p\", null, \"Lastly, let\\u2019s break the command that sets the alias.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Set-Alias -Name ls -Value shimmed_ls -Option AllScope -Scope Global -ErrorAction SilentlyContinue -Force\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Name ls\"), \": Name of our alias we are realiasing\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Value shimmed_ls\"), \": What we are realiasing ls to\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Option AllScope\"), \": Alias is copied to any new scopes that are created\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Scope Global\"), \": Scope in which alias is valid. Global means scope is in effect when PowerShell starts.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ErrorAction\"), \": If an error should occur for whatever reason it will not error display an error message user as that may alert the user, rather just silently continue.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Force\"), \": This is required as the majority of built-in PowerShell aliases are ReadOnly which means they cannot be changed or deleted unless the Force parameter is used. To see which aliases are ReadOnly do: \"))), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Get-Alias | Where-Object {$_.Options -Match \\\"ReadOnly\\\"}\\n\")), mdx(\"h3\", {\n    \"id\": \"basic-removal-of-the-shim\"\n  }, \"Basic Removal of the Shim\"), mdx(\"p\", null, \"Now that we have remapped an alias, you\\u2019re probably\\nwondering how do I remove it?\"), mdx(\"p\", null, \"The answer is simple as we can just do:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Remove-Alias -Name ls -Force\\nOr\\nRemove-Item alias:ls -Force\\n\")), mdx(\"p\", null, \"That works just fine as ls is no longer aliased our shim no longer works.\"), mdx(\"br\", null), mdx(\"p\", null, \"However, we can fix that :)\"), mdx(\"br\", null), mdx(\"p\", null, \"Now when you do Set-Alias instead of  \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope\"), \" do\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"-Option AllScope, Constant\")), mdx(\"p\", null, \"Let\\u2019s try deleting it now, we will even run PowerShell as an administrator\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1255px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.430278884462155%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABJ0AAASdAHeZh94AAABwElEQVQoz53Qy2sTQRwH8LEFEUqt0DwPBa2xqZtXKTSR3jwoVvFQSl7dKNjEm2Bt6d3/0YOnmuaxyXZ3Z5/ZzTx3nPUg4kn88mGY7wy/OQz4PprNdHMyhzdTfapD20fekrphwgmZs8B+xNyQuAviL/lvgYQ4uB6Ov11rs1sXWtataVuWDR3DNHXTgjp0TNNwHNuwZKAXLLwg8PyE6weW7QHH80xrCfUotBA0sG1Qz/BdI6CICMY4o5zQmFJGSCw3hHJKOSNC8CgMQBSFjAmMYoI5xpygGOMYyYpiSmJMOMExIfKKyUqJkI/IcSGEHyTDkfg7sfiH+L4PEFqK/wpCCAxHk/F0PtF0uY41SZ9oss5/jDVp+MvNH4ajqSZ/0/ZM6ILD46vyq/Pam8vSy/Pq0Zfa6wtZC88/5Rr93LNBvjHINvqbB/3UQT9dT2Tq8vxjpj548e4rUA7Pinu9wl4vX+qmle6D3c5Gsb2200o2u21pvdi+W2jdK7RWHzdXtpvg4cmdRydg67h69Blk6x9SFXVr//26cnpf6aYr6mbpNF1WMxU1VU5kq2q+2svVehtKd+1pZ+VJe3WnA7ab+28vfwJAlrjM0vN6CAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/00e58dcd33a1beaa463d48a8837577ee/aecae/removeme.webp 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png 1255w\"],\n    \"sizes\": \"(max-width: 1255px) 100vw, 1255px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/secbytes_2.0/static/00e58dcd33a1beaa463d48a8837577ee/d90ba/removeme.png\",\n    \"alt\": \"RemoveMe\",\n    \"title\": \"RemoveMe\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"PowerShell now throws an error as the alias is a constant!\"), mdx(\"h3\", {\n    \"id\": \"taking-it-one-step-further\"\n  }, \"Taking it one Step Further\"), mdx(\"p\", null, \"Now that we have learned how to realias aliases to our shimmed version\\nwouldn\\u2019t it be nice to just cut out the middle man. Instead of relaliasing aliases\\nlet\\u2019s just redefine what the alias is defined as!\"), mdx(\"p\", null, \"Back to our favorite example with ls\\nwe saw that it was aliased to Get-ChildItem so lets try redefining\\nwhat Get-ChildItem is:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1077px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.93779015784587%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAABJ0AAASdAHeZh94AAABvElEQVQoz52RyU/CQBTGB3ENrgjiEhQCosiOqGhwuRmjhINiRSkiyGY8aCLhb/XgTYUKbay0FCy0vsrFQOjB5pf2vZl+830zg0pl6vml9PpG1T+rLPlJV5gq9cWRJY4ieParWa/yHMBAIXwzHSC+ydfrTZbhYZZjWjQt0LTIVJu1WqPBCY2ayLECw4o1ThBEsQMktFrifx9UJCrFD5KoUJD/nSCLBEmUpRp4LZYlSpU2b10gbyhvPXxwB/OO4yfb0eN6qOAJ5r2hguskbzy4n9/OzGze9gIZ9nILO5m57bTaewPMbqXU6zfTvoTGl1QuY8h4hgynPdEHMrqt1Kw/NemJD6xeIFO4bxnrM5+334p20QM04Y6pHDgw5sSnPPExB64whX81klIetLCTlv4zhQdXIxpfYsJ9DeawlmYj2b8iBZETq71x9Kscd8VGbFGVHYdRpQUbdUKW2JD1Epl6i+f8t/AZd10b9u/gkHSbUjtojegD2cVATmWPypgjrS8B06MuXL+bg9jajSSMDtuudP4U3MLI2pWcGGIrzJjScgEJAcjfPi2oVY4otHKxl3azYAKGsFsw+evT0XbzAzYNVl0qw/B6AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/e549a724c271a943c658d842798ef103/e87cb/advanced.webp 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/e549a724c271a943c658d842798ef103/6977f/advanced.png 1077w\"],\n    \"sizes\": \"(max-width: 1077px) 100vw, 1077px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/secbytes_2.0/static/e549a724c271a943c658d842798ef103/6977f/advanced.png\",\n    \"alt\": \"Advanced\",\n    \"title\": \"Advanced\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Get-ChildItem has been redefined to spawn a powershell session that simply calls Get-ChildItem. PowerShell is called with the flag -nop short for NoProfile as to not load profiles.\"), mdx(\"h3\", {\n    \"id\": \"powershell-profiles-to-the-rescue\"\n  }, \"PowerShell Profiles to the Rescue\"), mdx(\"p\", null, \"There is one big problem with aliasing, our shimmed aliases\\nonly exist within the current PowerShell session.\\nThat means when a user opens up a new PowerShell session all our hard work\\nis lost. Luckily, PowerShell profiles exist, a profile is a PowerShell script that runs whenever the user opens up PowerShell. Profiles are documented in the MITRE attack\\nframework as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/%22\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"T1504\"), \"\\n. What this means for us is that we need to create that special profile called profile.ps1 that will load our malicious shims whenever a user opens up PowerShell.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"The Four Different Locations of Powershell Profiles\"), \":\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"574px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"60.97560975609756%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABJ0AAASdAHeZh94AAABDklEQVQoz6VR2XLDMAjU/39kj9ROM9OJJSSh23ZWoumkbdqX7NgYgdjFoIzRz08vh9dDznnf923bYHNOb9Mk/j9QMUa9LEQUYqi1SgEcrXXsSCkmif+Gyrk4SxyYyOKqULbWQKeNFkhTd5RLKd77GAMeaymnXl9bJQvAOPZMBlQkZ+vsVyOq5MKM4hQGkBBlOYKXmVOM/RMCd8u3bWdjBqN3GF4S5VoNGW0WRKR/Mh1wluV8Pn+A/bNt55xnLzpQQmJdV+4ybij1OFRH0reebte2UWxHMQewoIV1bQjOx3masK8ZOA7//XTChf1mf+ruGMFaOipe/BdMyUnG8W3acrWvd7s6f+NHVu0P4KHiC9Z1vXZjtE7XAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/b9b4cdd50d526ae8b131bc942f61d429/723c8/profile_locations_pshome.webp 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png 574w\"],\n    \"sizes\": \"(max-width: 574px) 100vw, 574px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/secbytes_2.0/static/b9b4cdd50d526ae8b131bc942f61d429/bf737/profile_locations_pshome.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PSHOME = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\")), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$HOME = C:\\\\Users\", \"[\", \"User]\")), mdx(\"h4\", {\n    \"id\": \"you-can-also-do\"\n  }, \"You can also do\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"587px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"46.33730834752981%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAABCklEQVQoz31S7Y6EIAz0/V/yzn+uIAoFv7XXabbmzHrXZAIpZTpDqcaxcF3X/P1V8ziO/DvO89TVe8etc1fuP1TbtvEwDNz3gxLO88zTNDHyRphz5s77K3ccx4VHQlwwpESCxMuyXEpLKexE4bqu/BQfhCAAQEhEHGNSpaYQubZtxUUv9r3sX9x1Hb+aRu8gTG2177taBWAVakCGvBEiH2PUM8DcYG91N4WkNomzFKQUlcC6qmW5DGVwEeW9g6gLIXCi9GwZlqwzZfoklLMQOo7SbBDbeBIMkqTB41CI0tsGKbm9341QVJlCI0T+j2/TazG+TsnlZkOHImeNDAA28X288zJ1fzW0OsQP11u9bi/oc70AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/f9304adc0e9e1ccc157471317e947f9c/d84e9/profile_locations_profile.webp 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/secbytes_2.0/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png 587w\"],\n    \"sizes\": \"(max-width: 587px) 100vw, 587px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/secbytes_2.0/static/f9304adc0e9e1ccc157471317e947f9c/3a024/profile_locations_profile.png\",\n    \"alt\": \"Profile_Locations\",\n    \"title\": \"Profile_Locations\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"The two we are focusing on are:\"), mdx(\"h3\", {\n    \"id\": \"profilecurrentuserallhosts-and-profilealluserallhosts\"\n  }, \"$PROFILE.CurrentUserAllHosts\", mdx(\"strong\", {\n    parentName: \"h3\"\n  }, \" and \"), \"$PROFILE.AllUserAllHosts\"), mdx(\"br\", null), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.CurrentUserAllHosts = C:\\\\Users\", \"\\\\\", \"[User]\", \"\\\\Documents\\\\WindowsPowerShell\\\\profile.ps1\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"$PROFILE.AllUserAllHosts = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\profile.ps1\")), mdx(\"p\", null, \"To write to the latter of the two we need to have administrative permissions\\non the box. An interesting tidbit to note is that when PowerShell first runs it will check if the profile for all users has been created and if that doesn\\u2019t exist it will use the profile for the current user if it exists.\"), mdx(\"p\", null, \"Keep in mind PowerShell Profiles do not exist by default, you will have to create those files.\"), mdx(\"h3\", {\n    \"id\": \"putting-all-the-pieces-together\"\n  }, \"Putting All the Pieces Together\"), mdx(\"p\", null, \"With so many aliases in PowerShell and having to create the PowerShell Profiles, it could seem daunting to do this manually. Luckily you don\\u2019t have to as I created a simple PowerShell script called Remapper which does all of the hard work for you! The only thing you may wish to modify are the functions in the first lines of the script. These funcions are what will be called when an alias is run.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"What the script does:\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Get paths of profiles and create them if they don\\u2019t exist\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Create a dictionary mapping aliases to shimmed definitions for the majority of aliases.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Puts the code to rewrite every alias into both PowerShell profiles.\"))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Our shimmed function does four things\"), \":\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Do what the alias is originally meant for\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to restore firewall to default settings\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start a job to turn off real-time monitoring\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check if google\", \".\", \"com is in the hosts file, if not will add it because during competitions we don\\u2019t blue teamers using Google ;).\"))), mdx(\"p\", null, \"Let\\u2019s run the script as an administrator and see what happens!\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/secbytes_2.0/076d38417289bf32775eb32887a02362/demo.gif\",\n    \"alt\": \"Demo\"\n  }))), mdx(\"p\", null, \"As can be seen, both profiles have been modified and if we do Get-Alias everything has been shimmed. Now when we type an alias it will run our shimmed version of it :)\"), mdx(\"p\", null, \"The script can be found here:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/Remapper\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Remapper\")), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Monitoring of PowerShell Profile locations to look for either creation of the file or someone writing to it.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Checking what aliases are defined as\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding the use of aliases; although, if you dig into PowerShell\\u2019s\\nsource code you will see some commands use aliases!\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Avoiding Powershell Profiles all together using the flag -No Profile when using PowerShell.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Powershell Logging \"))), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into shimming aliases for Command Prompt sessions\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Looking into CLR hooking instead of PowerShell profiles.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Researching the shimming of built-in PowerShell functions.\"))), mdx(\"h3\", {\n    \"id\": \"closing-thoughts\"\n  }, \"Closing Thoughts\"), mdx(\"p\", null, \"The concept of realiasing things in PowerShell is very fascinating, I have not seen too much research on it and would be curious to see just how far you can take it.\\nOverall, I hope this blog post gets people interested in the topic and can serve to be another neat trick for red teamers. While also giving blue teamers something else to watch out for.\"), mdx(\"h2\", {\n    \"id\": \"references\"\n  }, \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://attack.mitre.org/techniques/T1504/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://attack.mitre.org/techniques/T1504/\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_aliases?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-alias?view=powershell-6\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/remove-alias?view=powershell-6\")))));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.462885738115096,"src":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg","srcSet":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e0f30/Treasure.jpg 236w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/86afd/Treasure.jpg 472w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/58fe7/Treasure.jpg 944w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/02748/Treasure.jpg 1416w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5c241/Treasure.jpg 1888w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp","srcSetWebp":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/77392/Treasure.webp 236w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1f177/Treasure.webp 472w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/99fbb/Treasure.webp 944w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/4a492/Treasure.webp 1416w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/b0b8f/Treasure.webp 1888w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.462885738115096,"src":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg","srcSet":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/3a5ce/Treasure.jpg 163w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/05730/Treasure.jpg 327w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1dc0b/Treasure.jpg 653w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/f72c7/Treasure.jpg 980w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/6e4a3/Treasure.jpg 1306w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp","srcSetWebp":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/ac59e/Treasure.webp 163w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/7660b/Treasure.webp 327w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0acdf/Treasure.webp 653w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/75470/Treasure.webp 980w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/68d47/Treasure.webp 1306w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAABbfO2eoxw/wD/xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIRAyH/2gAIAQEAAQUC54ipHJFeO8HTZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAABAAETH/2gAIAQEABj8CluH/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEBAAE/IZBDYS3mEIhFgaU//9oADAMBAAIAAwAAABC0L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EBAn/8QAGhABAQEBAQEBAAAAAAAAAAAAAREAMSFBcf/aAAgBAQABPxA8jZVW6Jp70c5V+MNlJA1hLw+7iG//2Q==","aspectRatio":1.462885738115096,"src":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg","srcSet":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/5a3ee/Treasure.jpg 114w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/41f8f/Treasure.jpg 229w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/eaa58/Treasure.jpg 457w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/c309b/Treasure.jpg 686w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3008/Treasure.jpg 914w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/1fd0c/Treasure.jpg 3508w","srcWebp":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp","srcSetWebp":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/31fce/Treasure.webp 114w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e3e25/Treasure.webp 229w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/15384/Treasure.webp 457w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0258d/Treasure.webp 686w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/64ea2/Treasure.webp 914w,\n/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/e7d05/Treasure.webp 3508w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/secbytes_2.0/static/f01c2cbdd0b1401f5d81812b37c6fdf2/0ff54/Treasure.jpg"}}}]}}}